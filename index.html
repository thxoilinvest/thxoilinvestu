<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Thx Oil And Gas Investment</title>
    <!-- Tailwind CSS CDN -->
    <script src="https://cdn.tailwindcss.com"></script>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700;800;900&display=swap" rel="stylesheet">
    <!-- html2canvas CDN for receipt generation -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/html2canvas/1.4.1/html2canvas.min.js"></script>
    <!-- Font Awesome for WhatsApp icon and menu icon -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0-beta3/css/all.min.css">
    <style>
        body {
            font-family: 'Inter', sans-serif;
            background: radial-gradient(at top left, #f1f5f9, #e2e8f0); /* Softer radial gradient background */
            color: #2d3748; /* Darker text for contrast */
            min-height: 100vh; /* Ensure body takes full height */
        }
        .status-message {
            transition: all 0.3s ease-in-out;
        }
        .animate-pulse-slow {
            animation: pulse 4s cubic-bezier(0.4, 0, 0.6, 1) infinite;
        }
        @keyframes pulse {
            0%, 100% { opacity: 1; }
            50% { opacity: .5; }
        }
        /* Custom scrollbar for history panel */
        .overflow-y-scroll::-webkit-scrollbar {
            width: 8px;
        }
        .overflow-y-scroll::-webkit-scrollbar-track {
            background: #f1f1f1;
            border-radius: 10px;
        }
        .overflow-y-scroll::-webkit-scrollbar-thumb {
            background: #888;
            border-radius: 10px;
        }
        .overflow-y-scroll::-webkit-scrollbar-thumb:hover {
            background: #555;
        }
        /* Hidden by default, shown by JS */
        .page-section {
            display: none;
        }
        .hero-title {
            animation: fadeInScale 1s ease-out forwards;
        }
        .hero-subtitle {
            animation: fadeIn 1.5s ease-out forwards;
            animation-delay: 0.3s;
            opacity: 0;
        }
        .hero-button {
            animation: fadeInTranslateY 1.5s ease-out forwards;
            animation-delay: 0.6s;
            opacity: 0;
            transform: translateY(20px);
        }

        @keyframes fadeInScale {
            from { opacity: 0; transform: scale(0.95); }
            to { opacity: 1; transform: scale(1); }
        }
        @keyframes fadeIn {
            from { opacity: 0; }
            to { opacity: 1; }
        }
        @keyframes fadeInTranslateY {
            from { opacity: 0; transform: translateY(20px); }
            to { opacity: 1; transform: translateY(0); }
        }
        .card-hover {
            transition: transform 0.3s ease-in-out, box-shadow 0.3s ease-in-out;
        }
        .card-hover:hover {
            transform: translateY(-5px) scale(1.02);
            box-shadow: 0 15px 25px -5px rgba(0, 0, 0, 0.15), 0 5px 10px -2px rgba(0, 0, 0, 0.08); /* Stronger hover shadow */
        }
        .button-hover {
            transition: transform 0.3s ease-in-out, box-shadow 0.3s ease-in-out;
        }
        .button-hover:hover {
            transform: scale(1.05);
            box-shadow: 0 8px 15px -3px rgba(0, 0, 0, 0.2), 0 3px 6px -2px rgba(0, 0, 0, 0.1); /* Stronger hover shadow for buttons */
        }
        .button-hover:active {
            transform: scale(0.95);
        }

        /* Mobile navigation overlay styles */
        .mobile-nav-overlay {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0, 0, 0, 0.9);
            z-index: 1000; /* Lower than panels now */
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            opacity: 0;
            visibility: hidden;
            transition: opacity 0.3s ease-in-out, visibility 0.3s ease-in-out;
        }
        .mobile-nav-overlay.open {
            opacity: 1;
            visibility: visible;
        }
        .mobile-nav-overlay .close-btn {
            position: absolute;
            top: 1rem;
            right: 1rem;
            background: none;
            border: none;
            color: white;
            font-size: 2rem;
            cursor: pointer;
        }
        .mobile-nav-overlay ul {
            list-style: none;
            padding: 0;
            text-align: center;
        }
        .mobile-nav-overlay ul li {
            margin: 1.5rem 0;
        }
        .mobile-nav-overlay ul li a, .mobile-nav-overlay .mobile-auth-buttons a {
            color: white;
            font-size: 1.8rem;
            font-weight: 600;
            text-decoration: none;
            transition: color 0.2s ease-in-out;
        }
        .mobile-nav-overlay ul li a:hover, .mobile-nav-overlay .mobile-auth-buttons a:hover {
            color: #fbbf24; /* Amber-400 */
        }
        .mobile-nav-overlay .mobile-auth-buttons {
            display: flex;
            flex-direction: column;
            gap: 1rem;
            margin-top: 2rem;
        }
        .mobile-nav-overlay .mobile-auth-buttons a {
            padding: 0.75rem 1.5rem;
            border-radius: 0.5rem;
            font-size: 1.5rem;
            font-weight: 700;
            display: block;
            width: 100%;
            max-width: 200px;
            margin: 0 auto;
        }

        @media (max-width: 767px) {
            .mobile-header-logo {
                font-size: 1.5rem;
            }
            .hero-title {
                font-size: 2.5rem;
            }
            .hero-subtitle {
                font-size: 1.25rem;
            }
            .hero-button {
                font-size: 1.25rem;
                padding: 0.8rem 2.5rem;
            }
        }

        /* New Scroll Animation Styles */
        .animate-on-scroll {
            opacity: 0;
            transform: translateY(30px);
            transition: opacity 0.8s ease-out, transform 0.8s ease-out;
        }

        .animate-on-scroll.is-visible {
            opacity: 1;
            transform: translateY(0);
        }

        /* Optional: Staggered animation for grid items */
        .grid .animate-on-scroll {
            transition-delay: 0.1s; /* Default delay for grid items */
        }
        .grid .animate-on-scroll:nth-child(2) { transition-delay: 0.2s; }
        .grid .animate-on-scroll:nth-child(3) { transition-delay: 0.3s; }
        .grid .animate-on-scroll:nth-child(4) { transition-delay: 0.4s; }
        .grid .animate-on-scroll:nth-child(5) { transition-delay: 0.5s; }
        .grid .animate-on-scroll:nth-child(6) { transition-delay: 0.6s; }

        /* Styles for the receipt structure when rendered for download */
        /* These styles are applied to a temporary element for html2canvas */
        .receipt-container-temp {
            background-color: #2563eb; /* Blue-600 for background */
            border-radius: 1rem; /* Rounded-2xl */
            overflow: hidden; /* Ensures content stays within bounds */
            box-shadow: 0 10px 20px rgba(0, 0, 0, 0.2); /* Shadow effect */
            width: 350px; /* Fixed width for consistent receipt size */
            font-family: 'Inter', sans-serif; /* Ensure Inter font for the receipt */
            color: #2d3748; /* Default text color */
            position: absolute; /* Keep it off-screen */
            left: -9999px;
            top: -9999px;
            z-index: -1; /* Ensure it's not visible */
        }

        .receipt-header-logo-temp {
            background-color: #ffffff; /* White background */
            padding: 1rem 1.5rem; /* px-6 py-4 */
            display: flex;
            justify-content: center;
            align-items: center;
            border-top-left-radius: 1rem; /* Only top for inner container */
            border-top-right-radius: 1rem;
        }

        .receipt-amount-section-temp {
            background-color: #1e3a8a; /* Blue-800 */
            padding: 2rem 1.5rem; /* px-6 py-8 */
            display: flex;
            justify-content: space-between;
            align-items: center;
            color: #ffffff;
        }

        .receipt-amount-text-temp {
            font-weight: 800; /* font-extrabold */
            font-size: 2.25rem; /* text-4xl */
            line-height: 1;
            margin-top: 0.5rem;
        }

        .receipt-details-section-temp {
            background-color: #ffffff; /* White background */
            padding: 1.5rem 1.5rem; /* p-6 sm:p-8 */
            border-bottom-left-radius: 1rem; /* Only bottom for inner container */
            border-bottom-right-radius: 1rem;
            color: #2d3748; /* Gray-800 */
            font-size: 0.875rem; /* text-sm */
        }

        .receipt-detail-item-temp {
            margin-bottom: 1rem;
        }

        .receipt-detail-item-temp:last-child {
            margin-bottom: 0;
        }

        .receipt-detail-label-temp {
            font-weight: 500; /* font-medium */
            color: #6b7280; /* gray-500 */
            text-transform: uppercase;
            font-size: 0.75rem; /* text-xs */
        }

        .receipt-detail-value-temp {
            font-weight: 600; /* font-semibold */
            margin-top: 0.25rem;
            font-size: 0.875rem; /* text-sm */
        }

        /* SVG Chart Styles */
        .chart-container {
            width: 100%;
            max-width: 600px; /* Limit chart width */
            margin: 0 auto;
            padding: 1rem;
            background-color: #f8fafc; /* bg-gray-50 */
            border-radius: 0.75rem; /* rounded-xl */
            box-shadow: 0 4px 6px rgba(0, 0, 0, 0.1); /* shadow-md */
            overflow: hidden; /* Hide overflowing parts of the animated line */
        }

        .chart-container svg {
            width: 100%;
            height: 200px;
        }

        .chart-line {
            stroke: #2563eb; /* blue-600 */
            stroke-width: 3;
            fill: none;
            stroke-linecap: round;
            stroke-linejoin: round;
        }

        .chart-fill {
            fill: url(#gradient);
            opacity: 0.7;
        }

        .chart-axis-line {
            stroke: #cbd5e1; /* gray-300 */
            stroke-width: 1;
        }

        .chart-grid-line {
            stroke: #e2e8f0; /* gray-200 */
            stroke-width: 1;
            stroke-dasharray: 2 2;
        }

        .chart-label {
            font-family: 'Inter', sans-serif;
            font-size: 10px;
            fill: #64748b; /* gray-500 */
        }

        /* Modal Styles */
        .modal-overlay {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background-color: rgba(0, 0, 0, 0.7);
            display: flex;
            justify-content: center;
            align-items: center;
            z-index: 2000; /* Ensure it's above other elements */
            opacity: 0;
            visibility: hidden;
            transition: opacity 0.3s ease-in-out, visibility 0.3s ease-in-out;
        }

        .modal-overlay.open {
            opacity: 1;
            visibility: visible;
        }

        .modal-content {
            background-color: white;
            padding: 2rem;
            border-radius: 1rem;
            box-shadow: 0 10px 25px rgba(0, 0, 0, 0.3);
            max-width: 450px;
            width: 90%;
            text-align: center;
            transform: translateY(-20px);
            opacity: 0;
            transition: transform 0.3s ease-in-out, opacity 0.3s ease-in-out;
        }

        .modal-overlay.open .modal-content {
            transform: translateY(0);
            opacity: 1;
        }
    </style>
</head>
<body class="antialiased text-gray-800">

    <!-- Mobile Navigation Overlay (Initially Hidden) -->
    <div id="mobileNavOverlay" class="mobile-nav-overlay">
        <button class="close-btn" id="closeMobileNav">&times;</button>
        <ul>
            <li><a href="#" onclick="closeMobileNavAndGoTo('#home')">Home</a></li>
            <li><a href="#our-mission" onclick="closeMobileNavAndGoTo('#our-mission')">Our Mission</a></li>
            <li><a href="#how-we-make-money" onclick="closeMobileNavAndGoTo('#how-we-make-money')">How We Make Money</a></li>
            <li><a href="#about-us" onclick="closeMobileNavAndGoTo('#about-us')">Why Invest</a></li>
            <li><a href="#how-it-works" onclick="closeMobileNavAndGoTo('#how-it-works')">How It Works</a></li>
            <li><a href="#our-leadership" onclick="closeMobileNavAndGoTo('#our-leadership')">Our Leadership</a></li>
            <li><a href="#contact-us" onclick="closeMobileNavAndGoTo('#contact-us')">Contact Us</a></li>
            <li><a href="#download-app" onclick="closeMobileNavAndGoTo('#download-app')">Download App</a></li> <!-- NEW -->
        </ul>
        <div class="mobile-auth-buttons">
            <a href="#" class="bg-blue-600 text-white" onclick="closeMobileNavAndGoTo('#login')">Login</a>
            <a href="#" class="bg-green-600 text-white" onclick="closeMobileNavAndGoTo('#signup')">Sign Up</a>
        </div>
    </div>

    <!-- Custom Confirmation Modal (Hidden by Default) -->
    <div id="confirmationModal" class="modal-overlay">
        <div class="modal-content">
            <h3 class="text-xl font-bold text-gray-900 mb-4">Confirm Investment Withdrawal</h3>
            <p class="text-gray-700 mb-6">Are you sure you want to withdraw your capital from this investment?</p>
            <p class="text-red-600 font-semibold mb-6">
                WARNING: This action will CANCEL your investment, and you will FORFEIT any potential profits. Only your initial capital will be returned to your liquid balance.
            </p>
            <div class="flex justify-center space-x-4">
                <button id="cancelWithdrawalConfirm" class="bg-gray-400 hover:bg-gray-500 text-white font-bold py-2 px-5 rounded-lg transition-colors button-hover">
                    Cancel
                </button>
                <button id="confirmWithdrawalAction" class="bg-red-600 hover:bg-red-700 text-white font-bold py-2 px-5 rounded-lg transition-colors button-hover">
                    Confirm Withdrawal
                </button>
            </div>
        </div>
    </div>


    <!-- Home Page Section -->
    <div id="homePage" class="page-section">
        <!-- Header -->
        <header class="bg-gray-900 text-white py-4 shadow-xl">
            <div class="container mx-auto px-4 flex justify-between items-center">
                <a href="#" class="text-2xl md:text-3xl font-extrabold rounded-lg p-2 hover:bg-gray-700 transition-colors duration-300 mobile-header-logo" onclick="showHomePage()">
                    Thx Oil And Gas Investment
                </a>
                <!-- Hamburger menu for mobile -->
                <button id="openMobileNav" class="md:hidden text-white focus:outline-none p-2">
                    <i class="fas fa-bars text-2xl"></i>
                </button>

                <!-- Desktop Navigation -->
                <nav class="hidden md:block">
                    <!-- Adjusted space-x to prevent wrapping on desktop -->
                    <ul class="flex items-center space-x-4">
                        <li><a href="#" class="hover:text-amber-400 transition-colors duration-300 text-lg font-medium" onclick="showHomePage()">Home</a></li>
                        <li><a href="#our-mission" class="hover:text-amber-400 transition-colors duration-300 text-lg font-medium">Our Mission</a></li>
                        <li><a href="#how-we-make-money" class="hover:text-amber-400 transition-colors duration-300 text-lg font-medium">How We Make Money</a></li>
                        <li><a href="#about-us" class="hover:text-amber-400 transition-colors duration-300 text-lg font-medium">Why Invest</a></li>
                        <li><a href="#how-it-works" class="hover:text-amber-400 transition-colors duration-300 text-lg font-medium">How It Works</a></li>
                        <li><a href="#our-leadership" class="hover:text-amber-400 transition-colors duration-300 text-lg font-medium">Our Leadership</a></li>
                        <li><a href="#contact-us" class="hover:text-amber-400 transition-colors duration-300 text-lg font-medium">Contact Us</a></li>
                        <li><a href="#download-app" class="hover:text-amber-400 transition-colors duration-300 text-lg font-medium">Download App</a></li> <!-- NEW -->
                        <li><a href="#" class="bg-blue-600 hover:bg-blue-700 text-white font-bold py-2 px-4 rounded-lg shadow-md transition-all duration-300 transform hover:scale-105 active:scale-95 button-hover" onclick="showLoginPage()">Login</a></li>
                        <li><a href="#" class="bg-green-600 hover:bg-green-700 text-white font-bold py-2 px-4 rounded-lg shadow-md transition-all duration-300 transform hover:scale-105 active:scale-95 button-hover" onclick="showSignupPage()">Sign Up</a></li>
                    </ul>
                </nav>
            </div>
        </header>

        <!-- Hero Section -->
        <section class="bg-gradient-to-r from-gray-800 to-gray-900 text-white py-20 md:py-32 overflow-hidden">
            <div class="container mx-auto px-4 text-center">
                <h1 class="text-4xl md:text-6xl font-extrabold mb-6 leading-tight rounded-lg px-2 py-2 hero-title">
                    Unlock Your Wealth with Strategic Oil & Gas Investments
                </h1>
                <p class="text-lg md:text-2xl mb-10 max-w-3xl mx-auto opacity-90 hero-subtitle px-2">
                    Tap into a time-tested, resilient asset class. Your gateway to energy prosperity.
                </p>
                <a href="#" class="bg-amber-500 hover:bg-amber-600 text-gray-900 font-bold py-4 px-10 rounded-full text-xl md:text-2xl shadow-lg transform transition-all duration-300 hover:scale-105 active:scale-95 hero-button button-hover" onclick="showSignupPage()">
                    Start Investing Today!
                </a>
            </div>
        </section>

        <!-- NEW: Download App Section -->
        <section id="download-app" class="py-16 md:py-24 bg-blue-800 text-white">
            <div class="container mx-auto px-4 text-center">
                <h2 class="text-3xl md:text-4xl font-bold mb-8 animate-on-scroll">Get the Thx Oil And Gas App!</h2>
                <p class="text-xl md:text-2xl mb-12 max-w-3xl mx-auto opacity-90 animate-on-scroll">
                    Enhance your investment experience with our dedicated mobile application. Download it now for seamless management on the go!
                </p>
                <a href="https://github.com/your-username/your-repo/raw/main/ThxOilAndGas.apk" download="ThxOilAndGas.apk" class="bg-green-500 hover:bg-green-600 text-white font-bold py-5 px-12 rounded-full text-2xl md:text-3xl shadow-xl transform transition-all duration-300 hover:scale-105 active:scale-95 button-hover animate-on-scroll">
                    <i class="fas fa-download mr-3"></i> Download APK
                </a>
                <p class="mt-8 text-gray-300 animate-on-scroll">
                    (Note: This is an Android Package Kit file. You may need to enable installation from unknown sources in your device settings.)
                </p>
            </div>
        </section>

        <!-- Our Mission Section -->
        <section id="our-mission" class="py-16 md:py-24 bg-teal-700 text-white">
            <div class="container mx-auto px-4 text-center">
                <h2 class="text-3xl md:text-4xl font-bold mb-8 animate-on-scroll">Our Mission: Fueling Growth Together</h2>
                <div class="max-w-4xl mx-auto space-y-6 text-lg md:text-xl leading-relaxed">
                    <p class="animate-on-scroll">
                        At Thx Oil And Gas Investment, we are committed to sustainable wealth creation through strategic energy ventures.
                        We utilize your investments primarily for the **drilling and development of new oil wells**.
                        These are high-potential projects carefully selected by our expert team, ensuring a foundation for robust returns.
                    </p>
                    <p class="animate-on-scroll">
                        Our operational excellence in the energy sector allows us to generate significant profits.
                        A substantial portion, specifically **30% of the profits** generated from these successful ventures,
                        is directly distributed back to our valued investors. This creates a mutually prosperous partnership,
                        allowing you to benefit from the thriving global energy market.
                    </p>
                    <p class="animate-on-scroll font-semibold">
                        Invest with confidence, knowing your capital is fueling tangible, income-generating assets in the heart of the oil and gas industry.
                    </p>
                </div>
            </div>
        </section>

        <!-- How We Make Money Section -->
        <section id="how-we-make-money" class="py-16 md:py-24 bg-blue-900 text-white">
            <div class="container mx-auto px-4 text-center">
                <h2 class="text-3xl md:text-4xl font-bold mb-12 animate-on-scroll">How Thx Generates Profit</h2>
                <div class="grid grid-cols-1 md:grid-cols-2 gap-10 max-w-5xl mx-auto">
                    <div class="bg-blue-800 p-8 rounded-xl shadow-lg transition-transform duration-300 card-hover animate-on-scroll">
                        <div class="text-5xl mb-4 text-amber-400">📈</div>
                        <h3 class="text-2xl font-semibold mb-4">Leveraging Digital Reach (Google Ads)</h3>
                        <p class="text-blue-200 leading-relaxed text-base md:text-lg">
                            A significant portion of our revenue is generated through strategic Google Ads campaigns. We excel at identifying high-value keywords and optimizing ad placements to drive traffic and engagement, monetizing clicks and impressions. This diversified income stream supports our operational costs and contributes to investor returns.
                        </p>
                    </div>
                    <div class="bg-blue-800 p-8 rounded-xl shadow-lg transition-transform duration-300 card-hover animate-on-scroll">
                        <div class="text-5xl mb-4 text-amber-400">🛢️</div>
                        <h3 class="text-2xl font-semibold mb-4">Profits from Oil Refinery Operations</h3>
                        <p class="text-blue-200 leading-relaxed text-base md:text-lg">
                            Our core business involves direct investment and participation in profitable oil refinery operations. By optimizing refining processes and efficiently bringing petroleum products to market, we generate substantial profits from the energy sector. We are committed to sharing these successes, ensuring **35% of investment profits** are distributed back to our valued investors.
                        </p>
                    </div>
                </div>
                <p class="text-xl md:text-2xl mt-12 max-w-3xl mx-auto text-blue-200 animate-on-scroll">
                    At Thx Oil And Gas Investment, transparency and mutual growth are paramount. Our dual-income strategy ensures stability and high returns for our community.
                </p>
            </div>
        </section>

        <!-- Why Invest in Oil Section -->
        <section id="about-us" class="py-16 md:py-24 bg-white">
            <div class="container mx-auto px-4">
                <h2 class="text-3xl md:text-4xl font-bold text-center mb-12 animate-on-scroll">Why Oil & Gas Investment?</h2>
                <div class="grid grid-cols-1 md:grid-cols-3 gap-8 text-center">
                    <!-- Benefit 1 -->
                    <div class="bg-gray-100 p-8 rounded-xl shadow-md transition-transform duration-300 card-hover animate-on-scroll">
                        <div class="text-5xl mb-4 text-amber-500">💰</div>
                        <h3 class="text-2xl font-semibold mb-4">High Growth Potential</h3>
                        <p class="text-gray-700 text-base md:text-lg">The global demand for energy continues to grow, ensuring a robust market for oil and gas. Position your portfolio for significant returns.</p>
                    </div>
                    <!-- Benefit 2 -->
                    <div class="bg-gray-100 p-8 rounded-xl shadow-md transition-transform duration-300 card-hover animate-on-scroll">
                        <div class="text-5xl mb-4 text-amber-500">🛡️</div>
                        <h3 class="text-2xl font-semibold mb-4">Hedge Against Inflation</h3>
                        <p class="text-gray-700 text-base md:text-lg">Historically, oil and gas have served as effective hedges against inflation, preserving your purchasing power during economic shifts.</p>
                    </div>
                    <!-- Benefit 3 -->
                    <div class="bg-gray-100 p-8 rounded-xl shadow-md transition-transform duration-300 card-hover animate-on-scroll">
                        <div class="text-5xl mb-4 text-amber-500">🌍</div>
                        <h3 class="text-2xl font-semibold mb-4">Essential Global Commodity</h3>
                        <p class="text-gray-700 text-base md:text-lg">Oil remains fundamental to global industry, transportation, and daily life, making it a perpetually valuable commodity.</p>
                    </div>
                </div>
            </div>
        </section>

        <!-- Investment Details Section -->
        <section id="how-it-works" class="py-16 md:py-24 bg-gray-900 text-white">
            <div class="container mx-auto px-4 text-center">
                <h2 class="text-3xl md:text-4xl font-bold mb-8 animate-on-scroll">Accessible Investment for Everyone</h2>
                <p class="text-xl md:text-2xl mb-10 max-w-4xl mx-auto opacity-90 animate-on-scroll">
                    We believe in making high-potential investments accessible. With our platform, you can begin your journey into the lucrative oil and gas sector with a minimal initial commitment.
                </p>
                <div class="bg-amber-500 text-gray-900 inline-block p-6 md:p-8 rounded-2xl shadow-xl animate-on-scroll">
                    <p class="text-3xl md:text-5xl font-extrabold">
                        Minimum Investment: <span class="text-white bg-gray-900 rounded-lg px-3 py-1 ml-2"> ₦1,000</span>
                    </p>
                    <p class="mt-4 text-lg md:text-xl">
                        (Illustrative example. Actual minimums may vary based on specific offerings.)
                    </p>
                </div>
                <p class="mt-12 text-lg max-w-3xl mx-auto opacity-80 animate-on-scroll">
                    Our expert team guides you through the process, ensuring a seamless and transparent investment experience. We provide detailed insights and support every step of the way.
                </p>
                <p class="mt-8 text-lg max-w-3xl mx-auto opacity-80 animate-on-scroll font-semibold">
                    Enjoy the flexibility of your investments! You can withdraw your initial capital from steady and long-term plans at any time, though early withdrawal means foregoing potential profits. For your liquid balance, withdrawals to your bank as small as ₦500 are supported.
                </p>
            </div>
        </section>

        <!-- Our Leadership Section -->
        <section id="our-leadership" class="py-16 md:py-24 bg-white">
            <div class="container mx-auto px-4 text-center">
                <h2 class="text-3xl md:text-4xl font-bold mb-12 animate-on-scroll">Our Leadership</h2>
                <div class="max-w-xl mx-auto bg-gray-100 p-8 rounded-xl shadow-lg transition-transform duration-300 card-hover animate-on-scroll">
                    <img src="https://placehold.co/150x150/e2e8f0/64748b?text=CEO" alt="Engr. Onuzurike Emmanuel Onuzurike" class="rounded-full mx-auto mb-6 shadow-md border-4 border-amber-500">
                    <h3 class="text-2xl font-bold text-gray-900 mb-2">Engr. Onuzurike Emmanuel Onuzurike</h3>
                    <p class="text-amber-600 text-xl font-semibold mb-4">Chief Executive Officer</p>
                    <p class="text-gray-700 leading-relaxed">
                        Engr. Onuzurike Emmanuel Onuzurike is the visionary leader at the helm of Thx Oil And Gas Investment.
                        With extensive experience and a deep understanding of the energy sector, Engr. Onuzurike is committed
                        to driving innovation, ensuring sustainable growth, and fostering a transparent and profitable environment
                        for all our investors.
                    </p>
                </div>
            </div>
        </section>

        <!-- Call to Action / Sign Up Section -->
        <section id="signup-home" class="py-16 md:py-24 bg-gray-800 text-white">
            <div class="container mx-auto px-4 text-center">
                <h2 class="text-3xl md:text-4xl font-bold mb-8 animate-on-scroll">Ready to Grow Your Portfolio?</h2>
                <p class="text-xl md:text-2xl mb-12 max-w-3xl mx-auto opacity-90 animate-on-scroll">
                    Join thousands of savvy investors who are leveraging the power of oil and gas. Sign up today and take the first step towards a prosperous future!
                </p>
                <a href="#" class="bg-blue-600 hover:bg-blue-700 text-white font-bold py-5 px-12 rounded-full text-2xl md:text-3xl shadow-xl transform transition-all duration-300 hover:scale-105 active:scale-95 button-hover animate-on-scroll" onclick="showSignupPage()">
                    Sign Up Now
                </a>
                <p class="mt-8 text-gray-400 animate-on-scroll">Secure, transparent, and built for your success.</p>
            </div>
        </section>

        <!-- Contact Us Section -->
        <section id="contact-us" class="py-16 md:py-24 bg-gray-900 text-white">
            <div class="container mx-auto px-4 text-center">
                <h2 class="text-3xl md:text-4xl font-bold mb-8 animate-on-scroll">Get In Touch With Us</h2>
                <p class="text-xl md:text-2xl mb-8 max-w-3xl mx-auto opacity-90 animate-on-scroll">
                    Have questions or need assistance? Our support team is here to help you every step of the way.
                </p>
                <div class="flex flex-col items-center justify-center space-y-4 md:space-y-0 md:flex-row md:space-x-8 animate-on-scroll">
                    <p class="text-2xl md:text-3xl font-bold flex items-center">
                        <i class="fas fa-phone-alt text-amber-400 mr-3"></i> 08037676772
                    </p>
                    <p class="text-2xl md:text-3xl font-bold flex items-center">
                        <i class="fab fa-whatsapp text-green-500 mr-3"></i> Available on WhatsApp
                    </p>
                </div>
                <a href="https://wa.me/2348037676772" target="_blank" class="mt-8 inline-flex items-center bg-green-500 hover:bg-green-600 text-white font-bold py-3 px-8 rounded-full shadow-lg transition-all duration-300 transform hover:scale-105 active:scale-95 button-hover animate-on-scroll">
                    <i class="fab fa-whatsapp text-2xl mr-3"></i> Chat on WhatsApp
                </a>
            </div>
        </section>


        <!-- Footer -->
        <footer class="bg-gray-900 text-gray-400 py-8">
            <div class="container mx-auto px-4 text-center md:flex md:justify-between md:items-center">
                <p class="text-sm md:text-base">&copy; 2025 Thx Oil And Gas Investment. All rights reserved.</p>
                <div class="flex justify-center mt-4 md:mt-0 space-x-4 md:space-x-6">
                    <a href="#" class="hover:text-white transition-colors text-sm md:text-base">Privacy Policy</a>
                    <a href="#" class="hover:text-white transition-colors text-sm md:text-base">Terms of Service</a>
                </div>
            </div>
        </footer>
    </div>

    <!-- Login Page Section -->
    <div id="loginPage" class="page-section antialiased text-gray-800 flex items-center justify-center min-h-screen">
        <!-- Main Login Container -->
        <div class="bg-white p-8 md:p-12 rounded-2xl shadow-2xl w-full max-w-md animate-on-scroll">
            <h2 class="text-3xl font-bold text-center mb-8 text-gray-900">Log In to Your Account</h2>
            <form id="loginForm" class="space-y-6">
                <!-- Email or Phone Number Input -->
                <div>
                    <label for="loginUsername" class="block text-gray-700 text-sm font-semibold mb-2">Email or Phone Number</label>
                    <input type="text" id="loginUsername" name="username" placeholder="Enter your email or phone number"
                           class="w-full px-4 py-3 rounded-lg border-2 border-gray-300 focus:border-amber-500 focus:ring-2 focus:ring-amber-500 transition-colors duration-200"
                           required>
                    <p id="loginUsernameError" class="text-red-500 text-xs mt-1 hidden">Please enter your email or phone number.</p>
                </div>

                <!-- Password Input -->
                <div>
                    <label for="loginPassword" class="block text-gray-700 text-sm font-semibold mb-2">Password</label>
                    <input type="password" id="loginPassword" name="password" placeholder="Enter your password"
                           class="w-full px-4 py-3 rounded-lg border-2 border-gray-300 focus:border-amber-500 focus:ring-2 focus:ring-amber-500 transition-colors duration-200"
                           required>
                    <p id="loginPasswordError" class="text-red-500 text-xs mt-1 hidden">Please enter your password.</p>
                </div>

                <!-- Login Button -->
                <button type="submit" id="loginSubmitButton"
                        class="w-full bg-gradient-to-r from-blue-600 to-blue-700 hover:from-blue-700 hover:to-blue-800 text-white font-bold py-3 rounded-xl shadow-md transition-transform duration-300 transform hover:scale-105 active:scale-95 button-hover hover:shadow-lg">
                    Log In
                </button>
            </form>

            <!-- Status/Error Message (initially hidden) -->
            <div id="loginStatusMessage" class="hidden mt-6 px-4 py-3 rounded-lg relative" role="alert">
                <span class="block sm:inline" id="loginStatusText"></span>
                <span class="absolute top-0 bottom-0 right-0 px-4 py-3 cursor-pointer" onclick="this.parentNode.classList.add('hidden')">
                    <svg class="fill-current h-6 w-6" role="button" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 20 20"><title>Close</title><path d="M14.348 14.849a1.2 1.2 0 0 1-1.697 0L10 11.819l-2.651 3.029a1.2 1.2 0 1 1-1.697-1.697l2.758-3.15-2.759-3.15a1.2 1.2 0 1 1 1.697-1.697L10 8.183l2.651-3.031a1.2 1.2 0 1 1 1.697 1.697l-2.758 3.152 2.758 3.15a1.2 1.2 0 0 1 0 1.698z"/></svg>
                </span>
            </div>


            <p class="text-center text-gray-600 text-sm mt-8">
                Don't have an account? <a href="#" class="text-blue-600 hover:underline font-semibold" onclick="showSignupPage()">Sign up</a>
            </p>
            <p class="text-center text-gray-600 text-sm mt-4">
                <a href="#" class="text-gray-500 hover:underline" onclick="showHomePage()">Back to Home</a>
            </p>
        </div>
    </div>

    <!-- Sign Up Page Section -->
    <div id="signupPage" class="page-section antialiased text-gray-800 flex items-center justify-center min-h-screen">
        <!-- Main Sign Up Container -->
        <div class="bg-white p-8 md:p-12 rounded-2xl shadow-2xl w-full max-w-md animate-on-scroll">
            <h2 class="text-3xl font-bold text-center mb-8 text-gray-900">Create Your Account</h2>
            <form id="signupForm" class="space-y-6">
                <!-- Username Input -->
                <div>
                    <label for="signupUsername" class="block text-gray-700 text-sm font-semibold mb-2">Username</label>
                    <input type="text" id="signupUsername" name="username" placeholder="Choose a unique username"
                           class="w-full px-4 py-3 rounded-lg border-2 border-gray-300 focus:border-amber-500 focus:ring-2 focus:ring-amber-500 transition-colors duration-200"
                           required>
                    <p id="signupUsernameError" class="text-red-500 text-xs mt-1 hidden">Please enter a username.</p>
                </div>

                <!-- Phone Number Input -->
                <div>
                    <label for="signupPhone" class="block text-gray-700 text-sm font-semibold mb-2">Nigerian Phone Number</label>
                    <input type="tel" id="signupPhone" name="phone" placeholder="e.g., 08012345678"
                           class="w-full px-4 py-3 rounded-lg border-2 border-gray-300 focus:border-amber-500 focus:ring-2 focus:ring-amber-500 transition-colors duration-200"
                           pattern="^(070|080|081|090|091)\d{8}$"
                           title="Please enter a valid 11-digit Nigerian phone number (e.g., 08012345678)"
                           required>
                    <p id="signupPhoneError" class="text-red-500 text-xs mt-1 hidden">Please enter a valid 11-digit Nigerian phone number.</p>
                </div>

                <!-- Email Address Input -->
                <div>
                    <label for="signupEmail" class="block text-gray-700 text-sm font-semibold mb-2">Email Address</label>
                    <input type="email" id="signupEmail" name="email" placeholder="you@example.com"
                           class="w-full px-4 py-3 rounded-lg border-2 border-gray-300 focus:border-amber-500 focus:ring-2 focus:ring-amber-500 transition-colors duration-200"
                           required>
                    <p id="signupEmailError" class="text-red-500 text-xs mt-1 hidden">Please enter a valid email address.</p>
                </div>

                <!-- Password Input -->
                <div>
                    <label for="signupPassword" class="block text-gray-700 text-sm font-semibold mb-2">Password</label>
                    <input type="password" id="signupPassword" name="password" placeholder="Minimum 8 characters"
                           class="w-full px-4 py-3 rounded-lg border-2 border-gray-300 focus:border-amber-500 focus:ring-2 focus:ring-amber-500 transition-colors duration-200"
                           minlength="8"
                           required>
                    <p id="signupPasswordError" class="text-red-500 text-xs mt-1 hidden">Password must be at least 8 characters long.</p>
                </div>

                <!-- Sign Up Button -->
                <button type="submit" id="signupSubmitButton"
                        class="w-full bg-gradient-to-r from-green-600 to-green-700 hover:from-green-700 hover:to-green-800 text-white font-bold py-3 rounded-xl shadow-md transition-transform duration-300 transform hover:scale-105 active:scale-95 button-hover hover:shadow-lg">
                    Sign Up
                </button>
            </form>

            <!-- Success/Error Message (initially hidden) -->
            <div id="signupStatusMessage" class="hidden mt-6 px-4 py-3 rounded-lg relative" role="alert">
                <span class="block sm:inline" id="signupStatusText"></span>
                <span class="absolute top-0 bottom-0 right-0 px-4 py-3 cursor-pointer" onclick="this.parentNode.classList.add('hidden')">
                    <svg class="fill-current h-6 w-6" role="button" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 20 20"><title>Close</title><path d="M14.348 14.849a1.2 1.2 0 0 1-1.697 0L10 11.819l-2.651 3.029a1.2 1.2 0 1 1-1.697-1.697l2.758-3.15-2.759-3.15a1.2 1.2 0 1 1 1.697-1.697L10 8.183l2.651-3.031a1.2 1.2 0 1 1 1.697 1.697l-2.758 3.152 2.758 3.15a1.2 1.2 0 0 1 0 1.698z"/></svg>
                </span>
            </div>

            <p class="text-center text-gray-600 text-sm mt-8">
                Already have an account? <a href="#" class="text-blue-600 hover:underline font-semibold" onclick="showLoginPage()">Log in</a>
            </p>
            <p class="text-center text-gray-600 text-sm mt-4">
                <a href="#" class="text-gray-500 hover:underline" onclick="showHomePage()">Back to Home</a>
            </p>
        </div>
    </div>

    <!-- Dashboard Page Section -->
    <div id="dashboardPage" class="page-section">
        <!-- Header (Duplicated for Dashboard, but Logout button is unique here) -->
        <header class="bg-gray-900 text-white py-4 shadow-lg">
            <div class="container mx-auto px-4 flex justify-between items-center">
                <a href="#" class="text-2xl md:text-3xl font-bold rounded-lg p-2 hover:bg-gray-700 transition-colors" onclick="showDashboardPage()">
                    Thx Oil And Gas Investment
                </a>
                <!-- Dashboard specific navigation for desktop. Simplified as logout is the primary action -->
                <nav class="flex items-center space-x-4 md:space-x-6">
                    <span id="accountName" class="text-base md:text-lg font-semibold text-white">Welcome, Investor!</span>
                    <button id="logoutButton" class="bg-red-600 hover:bg-red-700 text-white font-semibold py-2 px-4 rounded-lg shadow-md transition-colors duration-200 button-hover">
                        Logout
                    </button>
                </nav>
            </div>
        </header>

        <!-- Dashboard Content -->
        <main class="container mx-auto px-4 py-8 md:py-12">
            <!-- Account Summary Section -->
            <section class="bg-white p-6 md:p-8 rounded-xl shadow-xl mb-8 animate-on-scroll">
                <h2 class="text-2xl md:text-3xl font-bold mb-4 text-gray-900 text-center md:text-left">Your Account Summary</h2>
                <div class="flex flex-col md:flex-row md:items-center md:justify-between space-y-4 md:space-y-0">
                    <div class="text-center md:text-left">
                        <p class="text-gray-600 text-base md:text-lg">Current Liquid Balance:</p>
                        <p id="currentBalance" class="text-4xl md:text-5xl font-extrabold text-green-600">₦0.00</p>
                        <!-- Relocated Total Investment Value here -->
                        <p class="text-gray-600 text-base md:text-lg mt-2">Total Investment Value:</p>
                        <p id="totalInvestmentValue" class="text-xl md:text-2xl font-extrabold text-purple-600 animate-pulse-slow">₦0.00</p>
                    </div>
                    <!-- Buttons for deposit, withdrawal, history - stacked on mobile, row on desktop -->
                    <div class="flex flex-col md:flex-row space-y-3 md:space-y-0 md:space-x-4 w-full md:w-auto">
                        <button id="depositButton" class="w-full bg-gradient-to-r from-blue-600 to-blue-700 hover:from-blue-700 hover:to-blue-800 text-white font-bold py-3 px-6 rounded-full shadow-md transition-transform duration-300 transform hover:scale-105 active:scale-95 button-hover hover:shadow-lg">
                            Deposit Money
                        </button>
                        <button id="withdrawToBankButton" class="w-full bg-gradient-to-r from-purple-600 to-purple-700 hover:from-purple-700 hover:to-purple-800 text-white font-bold py-3 px-6 rounded-full shadow-md transition-transform duration-300 transform hover:scale-105 active:scale-95 button-hover hover:shadow-lg">
                            Withdraw to Bank
                        </button>
                         <!-- New Withdraw Investment Button -->
                        <button id="withdrawInvestmentButton" class="w-full bg-gradient-to-r from-red-600 to-red-700 hover:from-red-700 hover:to-red-800 text-white font-bold py-3 px-6 rounded-full shadow-md transition-transform duration-300 transform hover:scale-105 active:scale-95 button-hover hover:shadow-lg">
                            Withdraw Investment
                        </button>
                        <button id="historyButton" class="w-full bg-gradient-to-r from-gray-700 to-gray-800 hover:from-gray-800 hover:to-gray-900 text-white font-bold py-3 px-6 rounded-full shadow-md transition-transform duration-300 transform hover:scale-105 active:scale-95 button-hover hover:shadow-lg">
                            History
                        </button>
                    </div>
                </div>
            </section>

            <!-- Statistics Panel -->
            <section id="statisticsPanel" class="bg-white p-6 md:p-8 rounded-xl shadow-xl mt-8 animate-on-scroll">
                <h2 class="text-2xl md:text-3xl font-bold mb-6 text-gray-900 text-center">Oil & Gas Market Trends (Simulated)</h2>
                <div class="chart-container">
                    <svg id="oilGasChart" viewBox="0 0 400 200">
                        <defs>
                            <linearGradient id="gradient" x1="0%" y1="0%" x2="0%" y2="100%">
                                <stop offset="0%" stop-color="#2563eb" stop-opacity="0.8"/>
                                <stop offset="100%" stop-color="#2563eb" stop-opacity="0.1"/>
                            </linearGradient>
                        </defs>

                        <!-- Grid lines (horizontal) -->
                        <line x1="40" y1="50" x2="380" y2="50" class="chart-grid-line" />
                        <line x1="40" y1="100" x2="380" y2="100" class="chart-grid-line" />
                        <line x1="40" y1="150" x2="380" y2="150" class="chart-grid-line" />

                        <!-- Axis lines -->
                        <line x1="40" y1="20" x2="40" y2="180" class="chart-axis-line" />
                        <line x1="40" y1="180" x2="380" y2="180" class="chart-axis-line" />

                        <!-- Labels Y-axis -->
                        <text x="30" y="155" text-anchor="end" class="chart-label">Low</text>
                        <text x="30" y="105" text-anchor="end" class="chart-label">Medium</text>
                        <text x="30" y="55" text-anchor="end" class="chart-label">High</text>

                        <!-- Labels X-axis (will be dynamic or fixed time points) -->
                        <text x="40" y="195" text-anchor="middle" class="chart-label">Past</text>
                        <text x="210" y="195" text-anchor="middle" class="chart-label">Current</text>
                        <text x="380" y="195" text-anchor="middle" class="chart-label">Future</text>

                        <polyline id="chartLine" points="" class="chart-line" />
                        <polygon id="chartFill" points="" class="chart-fill" />
                    </svg>
                    <p class="text-center text-gray-600 text-sm mt-2">
                        Simulated real-time price fluctuations for Oil, Gas, and Fuel in Nigeria.
                    </p>
                </div>
            </section>

            <!-- Deposit Panel -->
            <section id="depositPanel" class="bg-white p-6 md:p-8 rounded-xl shadow-xl mt-8 hidden animate-on-scroll">
                <h2 class="text-2xl md:text-3xl font-bold mb-4 text-gray-900 text-center">Deposit Funds</h2>
                <p class="text-gray-700 text-sm sm:text-base mb-6 text-center">Transfer money to the account details below:</p>

                <div class="space-y-2 sm:space-y-3 mb-6 p-3 sm:p-4 bg-gray-100 rounded-xl text-center border border-gray-200">
                    <p class="text-base sm:text-lg font-semibold">Account Number: <span id="depositAccountNumberDisplay" class="font-bold text-blue-600 text-xl sm:text-2xl"></span></p>
                    <p class="text-sm sm:text-lg font-semibold">Bank: <span id="depositBankNameDisplay" class="font-bold text-gray-800 text-base sm:text-xl"></span></p>
                </div>

                <p class="text-gray-700 text-sm sm:text-base mb-4 text-center">After transferring, please provide details below:</p>

                <!-- Deposit Amount Input -->
                <div class="mb-4">
                    <label for="depositAmount" class="block text-gray-700 text-sm font-semibold mb-2">Amount Deposited (₦)</label>
                    <input type="number" id="depositAmount" placeholder="e.g., 5000"
                           class="w-full px-4 py-2 sm:py-3 rounded-lg border-2 border-gray-300 focus:border-amber-500 focus:ring-2 focus:ring-amber-500 transition-colors duration-200 text-base"
                           min="1" required>
                    <p id="depositAmountError" class="text-red-500 text-xs mt-1 hidden">Please enter a valid amount (minimum ₦1).</p>
                </div>

                <!-- Your Account Name (NEW) -->
                <div class="mb-4">
                    <label for="senderAccountName" class="block text-gray-700 text-sm font-semibold mb-2">Your Account Name (used for transfer)</label>
                    <input type="text" id="senderAccountName" placeholder="e.g., John Doe"
                           class="w-full px-4 py-2 sm:py-3 rounded-lg border-2 border-gray-300 focus:border-amber-500 focus:ring-2 focus:ring-amber-500 transition-colors duration-200 text-base"
                           required>
                    <p id="senderAccountNameError" class="text-red-500 text-xs mt-1 hidden">Please enter your account name.</p>
                </div>

                <!-- Your Bank Name (NEW) -->
                <div class="mb-4">
                    <label for="senderBankName" class="block text-gray-700 text-sm font-semibold mb-2">Your Bank Name (used for transfer)</label>
                    <input type="text" id="senderBankName" placeholder="e.g., Zenith Bank"
                           class="w-full px-4 py-2 sm:py-3 rounded-lg border-2 border-gray-300 focus:border-amber-500 focus:ring-2 focus:ring-amber-500 transition-colors duration-200 text-base"
                           required>
                    <p id="senderBankNameError" class="text-red-500 text-xs mt-1 hidden">Please enter your bank name.</p>
                </div>

                <!-- Account Number Used for Transfer Input (Existing) -->
                <div class="mb-6">
                    <label for="transferAccountNumber" class="block text-gray-700 text-sm font-semibold mb-2">Your Account Number (used for transfer)</label>
                    <input type="tel" id="transferAccountNumber" placeholder="10-digit account number"
                           class="w-full px-4 py-2 sm:py-3 rounded-lg border-2 border-gray-300 focus:border-amber-500 focus:ring-2 focus:ring-amber-500 transition-colors duration-200 text-base"
                           pattern="\d{10}"
                           title="Please enter a 10-digit account number."
                           required>
                    <p id="transferAccountNumberError" class="text-red-500 text-xs mt-1 hidden">Please enter a valid 10-digit account number.</p>
                </div>

                <!-- Receipt Upload (NEW) -->
                <div class="mb-6">
                    <label for="depositReceipt" class="block text-gray-700 text-sm font-semibold mb-2">Upload Proof of Payment (PNG File)</label>
                    <input type="file" id="depositReceipt" accept="image/png"
                           class="w-full text-gray-700 border-2 border-gray-300 rounded-lg p-2 file:mr-4 file:py-2 file:px-4 file:rounded-full file:border-0 file:text-sm file:font-semibold file:bg-blue-50 file:text-blue-700 hover:file:bg-blue-100 cursor-pointer transition-colors duration-200">
                    <p id="depositReceiptError" class="text-red-500 text-xs mt-1 hidden">Please upload a PNG file.</p>
                </div>

                <div class="flex flex-col sm:flex-row justify-end space-y-3 sm:space-y-0 sm:space-x-4 mt-6">
                    <button id="cancelDepositPanel" class="w-full sm:w-auto bg-gradient-to-r from-gray-400 to-gray-500 hover:from-gray-500 hover:to-gray-600 text-white font-bold py-3 px-6 rounded-full shadow-md transition-transform duration-300 transform hover:scale-105 active:scale-95 button-hover hover:shadow-lg">
                        Cancel
                    </button>
                    <button id="confirmDeposit" class="w-full sm:w-auto bg-gradient-to-r from-green-600 to-green-700 hover:from-green-700 hover:to-green-800 text-white font-bold py-3 px-6 rounded-full shadow-md transition-transform duration-300 transform hover:scale-105 active:scale-95 button-hover hover:shadow-lg">
                        Confirm Deposit
                    </button>
                </div>
                <p class="text-center text-xs sm:text-sm text-gray-600 mt-4">
                    Having trouble? Contact us: <a href="https://wa.me/2348037676772" target="_blank" class="text-blue-500 hover:underline">08037676772 <i class="fab fa-whatsapp text-green-500"></i></a> (available on WhatsApp)
                </p>
            </section>

            <!-- Withdraw Panel -->
            <section id="withdrawPanel" class="bg-white p-6 md:p-8 rounded-xl shadow-xl mt-8 hidden animate-on-scroll">
                <h2 class="text-2xl md:text-3xl font-bold mb-4 text-gray-900 text-center">Withdraw Funds to Bank</h2>
                <p class="text-gray-700 text-sm sm:text-base mb-6 text-center">Enter the amount you wish to withdraw and your bank details.</p>

                <!-- Withdraw Amount Input -->
                <div class="mb-4">
                    <label for="withdrawAmount" class="block text-gray-700 text-sm font-semibold mb-2">Amount to Withdraw (₦)</label>
                    <input type="number" id="withdrawAmount" placeholder="e.g., 5000"
                           class="w-full px-4 py-2 sm:py-3 rounded-lg border-2 border-gray-300 focus:border-purple-500 focus:ring-2 focus:ring-purple-500 transition-colors duration-200 text-base"
                           min="500" required>
                    <p id="withdrawAmountError" class="text-red-500 text-xs mt-1 hidden">Please enter a valid amount (minimum ₦500).</p>
                </div>

                <!-- Bank Account Name Input -->
                <div class="mb-4">
                    <label for="bankAccountName" class="block text-gray-700 text-sm font-semibold mb-2">Bank Account Name</label>
                    <input type="text" id="bankAccountName" placeholder="e.g., Your Full Name"
                           class="w-full px-4 py-2 sm:py-3 rounded-lg border-2 border-gray-300 focus:border-purple-500 focus:ring-2 focus:ring-purple-500 transition-colors duration-200 text-base"
                           required>
                    <p id="bankAccountNameError" class="text-red-500 text-xs mt-1 hidden">Please enter the bank account name.</p>
                </div>

                <!-- Bank Account Number Input -->
                <div class="mb-6">
                    <label for="bankAccountNumber" class="block text-gray-700 text-sm font-semibold mb-2">Bank Account Number</label>
                    <input type="tel" id="bankAccountNumber" placeholder="Enter your 10-digit account number"
                           class="w-full px-4 py-2 sm:py-3 rounded-lg border-2 border-gray-300 focus:border-purple-500 focus:ring-2 focus:ring-purple-500 transition-colors duration-200 text-base"
                           pattern="\d{10}"
                           title="Please enter a 10-digit bank account number."
                           required>
                    <p id="bankAccountNumberError" class="text-red-500 text-xs mt-1 hidden">Please enter a valid 10-digit account number.</p>
                </div>
                <div class="mb-6">
                    <label for="bankName" class="block text-gray-700 text-sm font-semibold mb-2">Bank Name</label>
                    <input type="text" id="bankName" placeholder="e.g., Access Bank"
                           class="w-full px-4 py-2 sm:py-3 rounded-lg border-2 border-gray-300 focus:border-purple-500 focus:ring-2 focus:ring-purple-500 transition-colors duration-200 text-base"
                           required>
                    <p id="bankNameError" class="text-red-500 text-xs mt-1 hidden">Please enter the bank name.</p>
                </div>

                <div class="flex flex-col sm:flex-row justify-end space-y-3 sm:space-y-0 sm:space-x-4 mt-6">
                    <button id="cancelWithdrawalPanel" class="w-full sm:w-auto bg-gradient-to-r from-gray-400 to-gray-500 hover:from-gray-500 hover:to-gray-600 text-white font-bold py-3 px-6 rounded-full shadow-md transition-transform duration-300 transform hover:scale-105 active:scale-95 button-hover hover:shadow-lg">
                        Cancel
                    </button>
                    <button id="confirmWithdrawal" class="w-full sm:w-auto bg-gradient-to-r from-purple-600 to-purple-700 hover:from-purple-700 hover:to-purple-800 text-white font-bold py-3 px-6 rounded-full shadow-md transition-transform duration-300 transform hover:scale-105 active:scale-95 button-hover hover:shadow-lg">
                        Confirm Withdrawal
                    </button>
                </div>
                <p class="text-center text-xs sm:text-sm text-gray-600 mt-4">
                    Having trouble? Contact us: <a href="https://wa.me/2348037676772" target="_blank" class="text-blue-500 hover:underline">08037676772 <i class="fab fa-whatsapp text-green-500"></i></a> (available on WhatsApp)
                </p>
            </section>

             <!-- Withdraw Investment Panel (NEW) -->
            <section id="withdrawInvestmentPanel" class="bg-white p-6 md:p-8 rounded-xl shadow-xl mt-8 hidden animate-on-scroll">
                <h2 class="text-2xl md:text-3xl font-bold mb-4 text-gray-900 text-center">Withdraw Investment Capital</h2>
                <p class="text-gray-700 text-sm sm:text-base mb-6 text-center">Select an investment below to withdraw its initial capital. This will cancel the investment and forfeit any profits.</p>
                <div id="investmentsToWithdrawList" class="grid grid-cols-1 md:grid-cols-2 gap-4 max-h-80 sm:max-h-96 overflow-y-scroll border border-gray-200 p-3 sm:p-4 rounded-xl bg-gray-50">
                    <!-- Investment cards for withdrawal will be rendered here -->
                    <p class="text-center text-gray-500 col-span-full" id="noInvestmentsToWithdrawMessage">You have no active investments to withdraw.</p>
                </div>
                <div class="flex justify-end mt-6">
                    <button id="closeWithdrawInvestmentPanel" class="bg-gray-700 hover:bg-gray-800 text-white font-bold py-2 px-5 rounded-lg transition-colors button-hover">
                        Close
                    </button>
                </div>
            </section>


            <!-- Transaction History Panel -->
            <section id="historyPanel" class="bg-white p-6 md:p-8 rounded-xl shadow-xl mt-8 hidden animate-on-scroll">
                <h2 class="text-2xl md:text-3xl font-bold mb-4 text-gray-900 text-center">Transaction History</h2>
                <div id="historyList" class="max-h-80 sm:max-h-96 overflow-y-scroll border border-gray-200 p-3 sm:p-4 rounded-xl bg-gray-50">
                    <!-- Transaction items will be rendered here -->
                </div>
                <div class="flex justify-end mt-6">
                    <button id="closeHistoryPanel" class="bg-gray-700 hover:bg-gray-800 text-white font-bold py-2 px-5 rounded-lg transition-colors button-hover">
                        Close History
                    </button>
                </div>
            </section>
            
            <!-- Status Message (for all operations: deposit, withdraw, invest, redeem) -->
            <div id="dashboardStatusMessage" class="hidden mt-6 px-4 py-3 rounded-lg relative" role="alert">
                <span class="block sm:inline text-sm sm:text-base" id="dashboardStatusText"></span>
                <span class="absolute top-0 bottom-0 right-0 px-4 py-3 cursor-pointer" onclick="this.parentNode.classList.add('hidden')">
                        <svg class="fill-current h-6 w-6" role="button" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 20 20"><title>Close</title><path d="M14.348 14.849a1.2 1.2 0 0 1-1.697 0L10 11.819l-2.651 3.029a1.2 1.2 0 1 1-1.697-1.697l2.758-3.15-2.759-3.15a1.2 1.2 0 1 1 1.697-1.697L10 8.183l2.651-3.031a1.2 1.2 0 1 1 1.697 1.697l-2.758 3.152 2.758 3.15a1.2 1.2 0 0 1 0 1.698z"/></svg>
                </span>
                </div>
            </section>

            <!-- My Investments Section -->
            <section class="bg-white p-6 md:p-8 rounded-xl shadow-xl mt-8 animate-on-scroll">
                <h2 class="text-2xl md:text-3xl font-bold mb-6 text-center text-gray-900">My Investments</h2>
                <div id="investmentsList" class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6">
                    <!-- Investment items will be rendered here by JavaScript -->
                    <p class="text-center text-gray-500 col-span-full" id="noInvestmentsMessage">You have no active investments yet.</p>
                </div>
            </section>

            <!-- Investment Plans Section -->
            <section class="bg-white p-6 md:p-8 rounded-xl shadow-xl mt-8 animate-on-scroll">
                <h2 class="text-2xl md:text-3xl font-bold mb-6 text-center text-gray-900">Our Investment Plans</h2>
                <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-8">
                    <!-- Plan 1: Rapid Growth Plan -->
                    <div class="bg-gray-100 p-5 sm:p-6 rounded-xl shadow-md border-t-4 border-amber-500 transition-transform duration-300 card-hover">
                        <h3 class="text-lg sm:text-xl md:text-2xl font-bold mb-3 text-amber-600">Rapid Growth Plan</h3>
                        <p class="text-gray-700 text-sm sm:text-base mb-2">
                            Invest <span class="font-bold text-base sm:text-lg">₦1,000</span>
                        </p>
                        <p class="text-gray-700 text-sm sm:text-base mb-4">
                            Target Return: <span class="font-bold text-base sm:text-lg text-green-700">₦365,000</span> by Year End
                        </p>
                        <p class="text-gray-600 text-xs sm:text-sm mb-6">
                            An aggressive, short-term plan designed for significant daily growth, aiming for ₦365,000 in one year.
                        </p>
                        <button class="invest-button w-full bg-gradient-to-r from-amber-500 to-amber-600 hover:from-amber-600 hover:to-amber-700 text-gray-900 font-bold py-3 px-6 rounded-full shadow-md transition-transform duration-300 transform hover:scale-105 active:scale-95 button-hover hover:shadow-lg"
                                data-plan-name="Rapid Growth Plan" data-min-investment="1000">
                            Invest Now
                        </button>
                    </div>

                    <!-- Plan 4: Quick Return Plan -->
                    <div class="bg-gray-100 p-5 sm:p-6 rounded-xl shadow-md border-t-4 border-purple-500 transition-transform duration-300 card-hover">
                        <h3 class="text-lg sm:text-xl md:text-2xl font-bold mb-3 text-purple-600">Quick Return Plan</h3>
                        <p class="text-gray-700 text-sm sm:text-base mb-2">
                            Invest <span class="font-bold text-base sm:text-lg">₦2,000</span>
                        </p>
                        <p class="text-gray-700 text-sm sm:text-base mb-4">
                            Target Return: <span class="font-bold text-base sm:text-lg text-green-700">₦15,000</span> in 30 Days
                        </p>
                        <p class="text-gray-600 text-xs sm:text-sm mb-6">
                            A fast-paced plan returning ₦500 daily for 30 days, perfect for quick capital turnover.
                        </p>
                        <button class="invest-button w-full bg-gradient-to-r from-purple-500 to-purple-600 hover:from-purple-600 hover:to-purple-700 text-white font-bold py-3 px-6 rounded-full shadow-md transition-transform duration-300 transform hover:scale-105 active:scale-95 button-hover hover:shadow-lg"
                                data-plan-name="Quick Return Plan" data-min-investment="2000">
                            Invest Now
                        </button>
                    </div>


                    <!-- Plan 2: Steady Income Plan -->
                    <div class="bg-gray-100 p-5 sm:p-6 rounded-xl shadow-md border-t-4 border-blue-500 transition-transform duration-300 card-hover">
                        <h3 class="text-lg sm:text-xl md:text-2xl font-bold mb-3 text-blue-600">Steady Income Plan</h3>
                        <p class="text-gray-700 text-sm sm:text-base mb-2">
                            Minimum Investment: <span class="font-bold text-base sm:text-lg">₦50,000</span>
                        </p>
                        <p class="text-gray-700 text-sm sm:text-base mb-4">
                            Expected Annual Return: <span class="font-bold text-base sm:text-lg text-green-700">15-20%</span>
                        </p>
                        <p class="text-gray-600 text-xs sm:text-sm mb-6">
                            A balanced medium-term plan focusing on consistent returns from stable, established oil and gas operations over 2-3 years.
                        </p>
                        <button class="invest-button w-full bg-gradient-to-r from-blue-500 to-blue-600 hover:from-blue-600 hover:to-blue-700 text-white font-bold py-3 px-6 rounded-full shadow-md transition-transform duration-300 transform hover:scale-105 active:scale-95 button-hover hover:shadow-lg"
                                data-plan-name="Steady Income Plan" data-min-investment="50000">
                            Invest Now
                        </button>
                    </div>

                    <!-- Plan 3: Long-Term Growth Plan -->
                    <div class="bg-gray-100 p-5 sm:p-6 rounded-xl shadow-md border-t-4 border-green-500 transition-transform duration-300 card-hover">
                        <h3 class="text-lg sm:text-xl md:text-2xl font-bold mb-3 text-green-600">Long-Term Growth Plan</h3>
                        <p class="text-gray-700 text-sm sm:text-base mb-2">
                            Minimum Investment: <span class="font-bold text-base sm:text-lg">₦250,000</span>
                        </p>
                        <p class="text-gray-700 text-sm sm:text-base mb-4">
                            Expected Annual Return: <span class="font-bold text-base sm:text-lg text-green-700">20-30%</span>+
                        </p>
                        <p class="text-gray-600 text-xs sm:text-sm mb-6">
                            For strategic investors, this plan targets significant capital appreciation over 5+ years in major energy infrastructure projects.
                        </p>
                        <button class="invest-button w-full bg-gradient-to-r from-green-500 to-green-600 hover:from-green-600 hover:to-green-700 text-white font-bold py-3 px-6 rounded-full shadow-md transition-transform duration-300 transform hover:scale-105 active:scale-95 button-hover hover:shadow-lg"
                                data-plan-name="Long-Term Growth Plan" data-min-investment="250000">
                            Invest Now
                        </button>
                    </div>

                    <!-- Plan 5: Mega Oil Prospector Plan (NEW) -->
                    <div class="bg-gray-100 p-5 sm:p-6 rounded-xl shadow-md border-t-4 border-indigo-500 transition-transform duration-300 card-hover">
                        <h3 class="text-lg sm:text-xl md:text-2xl font-bold mb-3 text-indigo-600">Mega Oil Prospector Plan</h3>
                        <p class="text-gray-700 text-sm sm:text-base mb-2">
                            Minimum Investment: <span class="font-bold text-base sm:text-lg">₦5,000,000</span>
                        </p>
                        <p class="text-gray-700 text-sm sm:text-base mb-4">
                            Target Return: <span class="font-bold text-base sm:text-lg text-green-700">₦7,500,000</span> in 180 Days
                        </p>
                        <p class="text-gray-600 text-xs sm:text-sm mb-6">
                            A premier plan for serious investors seeking substantial returns from large-scale oil well drilling projects over 6 months.
                        </p>
                        <button class="invest-button w-full bg-gradient-to-r from-indigo-500 to-indigo-600 hover:from-indigo-600 hover:to-indigo-700 text-white font-bold py-3 px-6 rounded-full shadow-md transition-transform duration-300 transform hover:scale-105 active:scale-95 button-hover hover:shadow-lg"
                                data-plan-name="Mega Oil Prospector Plan" data-min-investment="5000000" data-term-days="180" data-profit-amount="2500000">
                            Invest Now
                        </button>
                    </div>

                </div>
            </section>
        </main>

        <!-- Footer -->
        <footer class="bg-gray-900 text-gray-400 py-8 mt-12">
            <div class="container mx-auto px-4 text-center md:flex md:justify-between md:items-center">
                <p class="text-sm md:text-base">&copy; 2025 Thx Oil And Gas Investment. All rights reserved.</p>
                <div class="flex justify-center mt-4 md:mt-0 space-x-4 md:space-x-6">
                    <a href="#" class="hover:text-white transition-colors text-sm md:text-base">Privacy Policy</a>
                    <a href="#" class="hover:text-white transition-colors text-sm md:text-base">Terms of Service</a>
                </div>
            </div>
        </footer>
    </div>

    <script>
        // --- Global User Management Variables ---
        let allUsers = JSON.parse(localStorage.getItem('allUsers')) || {};
        let loggedInUsername = localStorage.getItem('loggedInUser') || null;
        let currentUserData = {};

        // Rapid Growth Plan constants
        const RAPID_GROWTH_DAILY_ADDITION = 1000;
        const RAPID_GROWTH_TARGET_AMOUNT = 365000;

        // Quick Return Plan constants
        const QUICK_RETURN_DAILY_ADDITION = 500;
        const QUICK_RETURN_DURATION_DAYS = 30;
        const QUICK_RETURN_TARGET_AMOUNT = QUICK_RETURN_DAILY_ADDITION * QUICK_RETURN_DURATION_DAYS; // Recalculated for 15,000

        // Simulated delay constants (in milliseconds)
        const DEPOSIT_DELAY_MS = 30 * 60 * 1000; // 30 minutes
        const WITHDRAWAL_DELAY_MS = 15 * 60 * 1000; // 15 minutes
        const PROCESS_DELAY_MS = 2 * 1000; // Small delay for UI feedback (2 seconds)

        // Dynamic Deposit Account Details
        const depositAccounts = [
            { account: '9063804954', bank: 'Moremonee' },
            { account: '6111385794', bank: 'Moniepoint' }
        ];

        // --- Chart Animation Variables ---
        const CHART_WIDTH = 400;
        const CHART_HEIGHT = 200;
        const PADDING_LEFT = 40;
        const PADDING_BOTTOM = 20;
        const NUM_POINTS = 60; // More points for smoother animation
        const ANIMATION_SPEED = 1000 / 30; // ~30 frames per second
        let chartData = [];
        let animationFrameId; // To store requestAnimationFrame ID

        // Initialize chart data with some plausible-ish values
        function initializeChartData() {
            chartData = [];
            let lastValue = 100; // Starting around medium Y value (100 is center of 0-200)
            for (let i = 0; i < NUM_POINTS; i++) {
                // Simulate price fluctuations: small random step, tending slightly up or down
                const change = (Math.random() - 0.5) * 20; // -10 to +10
                lastValue = Math.max(20, Math.min(170, lastValue + change)); // Keep values within bounds
                chartData.push(lastValue);
            }
        }

        function updateChartData() {
            // Shift data left, add new point on the right
            chartData.shift();
            let lastValue = chartData[chartData.length - 1];
            // Introduce more varied changes for "spiking up and down"
            const randomFactor = Math.random();
            let change;
            if (randomFactor < 0.2) { // 20% chance for a larger spike/dip
                change = (Math.random() - 0.5) * 40; // -20 to +20
            } else { // 80% chance for smaller fluctuation
                change = (Math.random() - 0.5) * 15; // -7.5 to +7.5
            }
            lastValue = Math.max(20, Math.min(170, lastValue + change)); // Keep values within bounds (SVG Y-coordinates)
            chartData.push(lastValue);
        }

        function drawChart() {
            const chartLine = document.getElementById('chartLine');
            const chartFill = document.getElementById('chartFill');
            if (!chartLine || !chartFill) return; // Exit if elements not found (e.g., not on dashboard page)

            let pointsString = "";
            for (let i = 0; i < NUM_POINTS; i++) {
                const x = PADDING_LEFT + (i / (NUM_POINTS - 1)) * (CHART_WIDTH - PADDING_LEFT - 20); // x-coordinate, scale to width
                const y = chartData[i]; // y-coordinate (already scaled to SVG height)
                pointsString += `${x},${y} `;
            }

            chartLine.setAttribute('points', pointsString.trim());
            chartFill.setAttribute('points', `${PADDING_LEFT},${CHART_HEIGHT - PADDING_BOTTOM} ${pointsString.trim()} ${CHART_WIDTH - 20},${CHART_HEIGHT - PADDING_BOTTOM}`);
        }

        let lastFrameTime = 0;
        function animateChart(currentTime) {
            if (currentTime - lastFrameTime > ANIMATION_SPEED) {
                updateChartData();
                drawChart();
                lastFrameTime = currentTime;
            }
            animationFrameId = requestAnimationFrame(animateChart);
        }

        // --- Helper function for button state during processing ---
        function setButtonProcessingState(button, isProcessing, originalText) {
            if (!button) return;

            if (isProcessing) {
                button.dataset.originalText = button.textContent;
                button.textContent = 'Processing...';
                button.disabled = true;
                button.classList.add('opacity-70', 'cursor-not-allowed');
                button.classList.remove('hover:scale-105', 'active:scale-95', 'hover:shadow-lg'); 
            } else {
                button.textContent = originalText || button.dataset.originalText;
                button.disabled = false;
                button.classList.remove('opacity-70', 'cursor-not-allowed');
                button.classList.add('hover:scale-105', 'active:scale-95', 'hover:shadow-lg'); 
            }
        }

        // --- Page Navigation Functions ---
        function hideAllPages() {
            document.querySelectorAll('.page-section').forEach(page => {
                page.style.display = 'none';
            });
             // Stop chart animation when leaving dashboard
            if (animationFrameId) {
                cancelAnimationFrame(animationFrameId);
                animationFrameId = null;
            }
        }

        function closeMobileNavAndGoTo(hash) {
            document.getElementById('mobileNavOverlay').classList.remove('open'); // Start transition
            // Use setTimeout to add 'hidden' class after transition completes
            setTimeout(() => {
                document.getElementById('mobileNavOverlay').classList.add('hidden'); // Ensure it hides
                if (hash === '#home') showHomePage();
                else if (hash === '#login') showLoginPage();
                else if (hash === '#signup') showSignupPage();
                else {
                    showHomePage();
                    setTimeout(() => {
                        window.location.hash = hash;
                    }, 100);
                }
            }, 300); // Match this duration with the CSS transition duration for opacity/visibility
        }


        function showHomePage() {
            hideAllPages();
            document.getElementById('homePage').style.display = 'block';
            history.pushState(null, '', '#home');
        }

        function showLoginPage() {
            hideAllPages();
            document.getElementById('loginPage').style.display = 'flex';
            history.pushState(null, '', '#login');
            document.getElementById('loginForm').reset();
            document.getElementById('loginUsername').classList.remove('border-red-500');
            document.getElementById('loginPassword').classList.remove('border-red-500');
            document.getElementById('loginUsernameError').classList.add('hidden');
            document.getElementById('loginPasswordError').classList.add('hidden');
            showLoginStatusMessage('', 'hidden');
            setButtonProcessingState(document.getElementById('loginSubmitButton'), false, 'Log In');
        }

        function showSignupPage() {
            hideAllPages();
            document.getElementById('signupPage').style.display = 'flex';
            history.pushState(null, '', '#signup');
            document.getElementById('signupForm').reset();
            document.getElementById('signupUsername').classList.remove('border-red-500'); // New: clear username error
            document.getElementById('signupPhone').classList.remove('border-red-500');
            document.getElementById('signupEmail').classList.remove('border-red-500');
            document.getElementById('signupPassword').classList.remove('border-red-500');
            document.getElementById('signupUsernameError').classList.add('hidden'); // New: hide username error
            document.getElementById('signupPhoneError').classList.add('hidden');
            document.getElementById('signupEmailError').classList.add('hidden');
            document.getElementById('signupPasswordError').classList.add('hidden');
            showSignupStatusMessage('', 'hidden');
            setButtonProcessingState(document.getElementById('signupSubmitButton'), false, 'Sign Up');
        }

        function showDashboardPage() {
            hideAllPages();
            document.getElementById('dashboardPage').style.display = 'block';
            history.pushState(null, '', '#dashboard');

            if (loggedInUsername && allUsers[loggedInUsername]) {
                loadCurrentUserData();
                checkAndProcessPendingTransactionsOnLoad();
                // Ensure userName is correctly displayed on dashboard
                document.getElementById('accountName').textContent = `Welcome, ${currentUserData.username || 'Investor'}!`; // Use 'username' property
                updateBalanceDisplay();
                updateTotalInvestmentValueDisplay(); 
                applyDailyGrowth();
                renderInvestments();

                // Start chart animation when showing dashboard
                initializeChartData();
                animateChart();
            } else {
                showLoginPage();
            }
        }

        // --- Local Storage User Management ---
        function loadAllUsers() {
            const savedUsers = localStorage.getItem('allUsers');
            if (savedUsers) {
                allUsers = JSON.parse(savedUsers);
            } else {
                allUsers = {};
            }
        }

        function saveAllUsers() {
            localStorage.setItem('allUsers', JSON.stringify(allUsers));
        }

        function loadCurrentUserData() {
            if (loggedInUsername && allUsers[loggedInUsername]) {
                currentUserData = allUsers[loggedInUsername];
                if (!currentUserData.pendingDeposits) currentUserData.pendingDeposits = [];
                if (!currentUserData.pendingWithdrawals) currentUserData.pendingWithdrawals = [];
                // Ensure 'username' property exists, default if not
                if (!currentUserData.username) currentUserData.username = loggedInUsername.includes('@') ? loggedInUsername.split('@')[0] : loggedInUsername;
            } else {
                currentUserData = {
                    username: "Investor", // Default if not found or new
                    userBalance: 0.00,
                    investments: [],
                    transactions: [],
                    pendingDeposits: [],
                    pendingWithdrawals: []
                };
            }
        }

        function saveCurrentUserData() {
            if (loggedInUsername) {
                allUsers[loggedInUsername] = currentUserData;
                saveAllUsers();
            }
        }

        // --- Common Dashboard Helper Functions (Adapted to use currentUserData) ---
        function recordTransaction(type, amount, description, details = {}) {
            const balanceBefore = currentUserData.userBalance;
            const newTx = {
                id: 'tx_' + Date.now() + Math.random().toString(36).substring(2, 9),
                type: type,
                amount: amount,
                date: new Date().toISOString(),
                description: description,
                balanceBefore: balanceBefore,
                balanceAfter: 0,
                ...details // Add any extra details like bank info for withdrawals/deposits
            };
            
            // For investment withdrawals, the balanceAfter should reflect the new liquid balance
            if (type === 'investmentWithdraw') {
                newTx.balanceAfter = balanceBefore + amount;
            } else {
                 newTx.balanceAfter = currentUserData.userBalance;
            }

            currentUserData.transactions.unshift(newTx);
        }

        function updateBalanceDisplay() {
            const currentBalanceP = document.getElementById('currentBalance');
            if (currentBalanceP) {
                currentBalanceP.textContent = `₦${currentUserData.userBalance.toLocaleString('en-NG', { minimumFractionDigits: 2, maximumFractionDigits: 2 })}`;
            }
        }

        function updateTotalInvestmentValueDisplay() {
            const totalInvestmentValueP = document.getElementById('totalInvestmentValue');
            if (!totalInvestmentValueP) return;

            let totalValue = 0;
            // Only count active or matured investments for total value display
            currentUserData.investments.forEach(inv => {
                if (inv.status === 'active' || inv.status === 'matured') {
                    totalValue += inv.currentValue; // Sum current value for all
                }
            });
            totalInvestmentValueP.textContent = `₦${totalValue.toLocaleString('en-NG', { minimumFractionDigits: 2, maximumFractionDigits: 2 })}`;
        }


        function showLoginStatusMessage(message, type = 'success') {
            const statusMessage = document.getElementById('loginStatusMessage');
            const statusText = document.getElementById('loginStatusText');
            statusText.textContent = message;
            statusMessage.className = `mt-6 px-4 py-3 rounded-lg relative ${type === 'success' ? 'bg-green-100 border-green-400 text-green-700' : 'bg-red-100 border-red-400 text-red-700'}`;
            if (type === 'hidden') statusMessage.classList.add('hidden');
        }

        function showSignupStatusMessage(message, type = 'success') {
            const statusMessage = document.getElementById('signupStatusMessage');
            const statusText = document.getElementById('signupStatusText');
            statusText.textContent = message;
            statusMessage.className = `mt-6 px-4 py-3 rounded-lg relative ${type === 'success' ? 'bg-green-100 border-green-400 text-green-700' : 'bg-red-100 border-red-400 text-red-700'}`;
            if (type === 'hidden') statusMessage.classList.add('hidden');
        }

        function showDashboardStatusMessage(message, type = 'success') {
            const statusMessage = document.getElementById('dashboardStatusMessage');
            const statusText = document.getElementById('dashboardStatusText');
            if (!statusMessage || !statusText) return;

            statusText.innerHTML = message;
            statusMessage.className = 'hidden mt-6 px-4 py-3 rounded-lg relative status-message';
            if (type === 'success') {
                statusMessage.classList.add('bg-green-100', 'border-green-400', 'text-green-700');
            } else if (type === 'error') {
                statusMessage.classList.add('bg-red-100', 'border-red-400', 'text-red-700');
            } else if (type === 'info') {
                statusMessage.classList.add('bg-blue-100', 'border-blue-400', 'text-blue-700');
            }
            statusMessage.classList.remove('hidden');

            setTimeout(() => {
                statusMessage.classList.add('hidden');
            }, 8000);
        }

        function hideAllDepositErrors() {
            document.getElementById('depositAmountError').classList.add('hidden');
            document.getElementById('senderAccountNameError').classList.add('hidden');
            document.getElementById('senderBankNameError').classList.add('hidden');
            document.getElementById('transferAccountNumberError').classList.add('hidden');
            document.getElementById('depositReceiptError').classList.add('hidden');
            
            document.getElementById('depositAmount').classList.remove('border-red-500');
            document.getElementById('senderAccountName').classList.remove('border-red-500');
            document.getElementById('senderBankName').classList.remove('border-red-500');
            document.getElementById('transferAccountNumber').classList.remove('border-red-500');
            document.getElementById('depositReceipt').classList.remove('border-red-500');
        }

        function hideAllWithdrawalErrors() {
            document.getElementById('withdrawAmountError').classList.add('hidden');
            document.getElementById('bankAccountNameError').classList.add('hidden');
            document.getElementById('bankAccountNumberError').classList.add('hidden');
            document.getElementById('bankNameError').classList.add('hidden');
            document.getElementById('withdrawAmount').classList.remove('border-red-500');
            document.getElementById('bankAccountName').classList.remove('border-red-500');
            document.getElementById('bankAccountNumber').classList.remove('border-red-500');
            document.getElementById('bankName').classList.remove('border-red-500');
        }

        function renderInvestments() {
            const investmentsList = document.getElementById('investmentsList');
            const noInvestmentsMessage = document.getElementById('noInvestmentsMessage');
            if (!investmentsList || !noInvestmentsMessage) return;

            investmentsList.innerHTML = '';

            // Filter out 'redeemed' and 'withdrawn' investments for the main display
            const investmentsToDisplay = currentUserData.investments.filter(inv => inv.status !== 'redeemed' && inv.status !== 'withdrawn');

            if (investmentsToDisplay.length === 0) {
                noInvestmentsMessage.classList.remove('hidden');
            } else {
                noInvestmentsMessage.classList.add('hidden');
                
                for (const investment of investmentsToDisplay) {
                    const investmentDiv = document.createElement('div');
                    let buttonHtml = '';
                    let statusText = '';
                    let borderColorClass = '';

                    if (investment.planType === 'Rapid Growth Plan' || investment.planType === 'Quick Return Plan') {
                        borderColorClass = investment.status === 'matured' ? 'border-green-500' : 'border-amber-500';
                        
                        if (investment.status === 'active') {
                            const dailyAddition = investment.planType === 'Rapid Growth Plan' ? RAPID_GROWTH_DAILY_ADDITION : QUICK_RETURN_DAILY_ADDITION;
                            statusText = `Growing: ₦${investment.currentValue.toLocaleString('en-NG', { minimumFractionDigits: 2, maximumFractionDigits: 2 })} / ₦${investment.targetAmount.toLocaleString('en-NG', { minimumFractionDigits: 2, maximumFractionDigits: 2 })} (₦${dailyAddition} added daily)`;
                        } else if (investment.status === 'matured') {
                            statusText = `Matured! Value: ₦${investment.currentValue.toLocaleString('en-NG', { minimumFractionDigits: 2, maximumFractionDigits: 2 })}`;
                            buttonHtml = `<button data-id="${investment.id}" class="redeem-investment-button w-full mt-4 bg-gradient-to-r from-green-600 to-green-700 hover:from-green-700 hover:to-green-800 text-white font-bold py-3 px-6 rounded-full shadow-md transition-transform duration-300 transform hover:scale-105 active:scale-95 button-hover hover:shadow-lg">Redeem ₦${investment.targetAmount.toLocaleString('en-NG', { minimumFractionDigits: 2, maximumFractionDigits: 2 })}</button>`;
                        }
                    } else { 
                        // For Steady Income, Long-Term Growth, and Mega Oil Prospector plans
                        if (investment.planType === 'Mega Oil Prospector Plan') {
                             borderColorClass = investment.status === 'matured' ? 'border-green-500' : 'border-indigo-500';
                        } else {
                             borderColorClass = 'border-blue-500';
                        }
                       
                        const startDate = new Date(investment.startDate);
                        const today = new Date();

                        if (investment.status === 'active') {
                             if (investment.maturityDate) {
                                const maturityDate = new Date(investment.maturityDate);
                                const remainingDays = Math.ceil((maturityDate.getTime() - today.getTime()) / (1000 * 60 * 60 * 24));
                                statusText = `Active (Matures in ${Math.max(0, remainingDays)} days). Target: ₦${investment.targetAmount.toLocaleString('en-NG')}`;
                             } else {
                                statusText = `Active (Initial Value): ₦${investment.initialAmount.toLocaleString('en-NG', { minimumFractionDigits: 2, maximumFractionDigits: 2 })}`;
                             }
                        } else if (investment.status === 'matured') {
                            statusText = `Matured! Value: ₦${investment.targetAmount.toLocaleString('en-NG')}`;
                            buttonHtml = `<button data-id="${investment.id}" class="redeem-investment-button w-full mt-4 bg-gradient-to-r from-green-600 to-green-700 hover:from-green-700 hover:to-green-800 text-white font-bold py-3 px-6 rounded-full shadow-md transition-transform duration-300 transform hover:scale-105 active:scale-95 button-hover hover:shadow-lg">Redeem ₦${investment.targetAmount.toLocaleString('en-NG', { minimumFractionDigits: 2, maximumFractionDigits: 2 })}</button>`;
                        }
                    }

                    investmentDiv.className = `bg-gray-50 p-4 rounded-xl shadow-md border-t-4 ${borderColorClass} transition-transform duration-300 card-hover animate-on-scroll`;
                    investmentDiv.innerHTML = `
                        <h4 class="font-bold text-lg sm:text-xl mb-2">${investment.name}</h4>
                        <p class="text-sm sm:text-base text-gray-700">Initial Investment: ₦${investment.initialAmount.toLocaleString('en-NG', { minimumFractionDigits: 2, maximumFractionDigits: 2 })}</p>
                        <p class="text-sm sm:text-base text-gray-700">${statusText}</p>
                        <p class="text-xs text-gray-500 mt-2">Started: ${new Date(investment.startDate).toLocaleDateString()}</p>
                        ${buttonHtml}
                    `;
                    investmentsList.appendChild(investmentDiv);
                }

                document.querySelectorAll('.redeem-investment-button').forEach(button => {
                    button.onclick = handleRedeemInvestment;
                });
            }
        }

        // NEW: Function to render investments specifically for withdrawal panel
        function renderInvestmentsForWithdrawal() {
            const investmentsToWithdrawList = document.getElementById('investmentsToWithdrawList');
            const noInvestmentsToWithdrawMessage = document.getElementById('noInvestmentsToWithdrawMessage');
            investmentsToWithdrawList.innerHTML = ''; // Clear previous list

            // Only show investments that are active or matured and NOT yet redeemed/withdrawn
            const withdrawableInvestments = currentUserData.investments.filter(inv => 
                (inv.status === 'active' || inv.status === 'matured') && inv.status !== 'redeemed' && inv.status !== 'withdrawn'
            );

            if (withdrawableInvestments.length === 0) {
                noInvestmentsToWithdrawMessage.classList.remove('hidden');
            } else {
                noInvestmentsToWithdrawMessage.classList.add('hidden');
                withdrawableInvestments.forEach(investment => {
                    const investmentDiv = document.createElement('div');
                    let statusText = '';
                    let borderColorClass = '';

                    if (investment.planType === 'Rapid Growth Plan' || investment.planType === 'Quick Return Plan') {
                        borderColorClass = investment.status === 'matured' ? 'border-green-500' : 'border-amber-500';
                        statusText = investment.status === 'active' ? `Current Value: ₦${investment.currentValue.toLocaleString('en-NG', { minimumFractionDigits: 2, maximumFractionDigits: 2 })}` : `Matured Value: ₦${investment.currentValue.toLocaleString('en-NG', { minimumFractionDigits: 2, maximumFractionDigits: 2 })}`;
                    } else {
                        borderColorClass = investment.planType === 'Mega Oil Prospector Plan' ? (investment.status === 'matured' ? 'border-green-500' : 'border-indigo-500') : 'border-blue-500';
                        statusText = investment.status === 'active' ? `Initial Value: ₦${investment.initialAmount.toLocaleString('en-NG', { minimumFractionDigits: 2, maximumFractionDigits: 2 })}` : `Matured Value: ₦${investment.targetAmount.toLocaleString('en-NG', { minimumFractionDigits: 2, maximumFractionDigits: 2 })}`;
                    }

                    investmentDiv.className = `bg-gray-100 p-4 rounded-xl shadow-md border-t-4 ${borderColorClass} transition-transform duration-300 card-hover`;
                    investmentDiv.innerHTML = `
                        <h4 class="font-bold text-lg sm:text-xl mb-2">${investment.name}</h4>
                        <p class="text-sm sm:text-base text-gray-700">Initial Capital: ₦${investment.initialAmount.toLocaleString('en-NG', { minimumFractionDigits: 2, maximumFractionDigits: 2 })}</p>
                        <p class="text-sm sm:text-base text-gray-700">${statusText}</p>
                        <p class="text-xs text-gray-500 mt-2">Started: ${new Date(investment.startDate).toLocaleDateString()}</p>
                        <button data-id="${investment.id}" class="withdraw-investment-button w-full mt-4 bg-gradient-to-r from-red-600 to-red-700 hover:from-red-700 hover:to-red-800 text-white font-semibold py-3 px-6 rounded-full shadow-md transition-transform duration-300 transform hover:scale-105 active:scale-95 button-hover hover:shadow-lg">
                            Withdraw Capital (Cancel)
                        </button>
                    `;
                    investmentsToWithdrawList.appendChild(investmentDiv);
                });

                document.querySelectorAll('#investmentsToWithdrawList .withdraw-investment-button').forEach(button => {
                    button.onclick = (event) => showWithdrawConfirmation(event.target.dataset.id);
                });
            }
        }


        // --- Custom Modal Logic for Withdraw Investment ---
        let currentInvestmentIdToWithdraw = null; // Store ID for modal confirmation

        function showWithdrawConfirmation(investmentId) {
            currentInvestmentIdToWithdraw = investmentId;
            const modal = document.getElementById('confirmationModal');
            modal.classList.add('open');
            // Attach listeners for modal buttons
            document.getElementById('cancelWithdrawalConfirm').onclick = hideWithdrawConfirmation;
            document.getElementById('confirmWithdrawalAction').onclick = () => {
                // Set the processing state for the specific investment's withdraw button
                // Find the button within the withdrawInvestmentPanel
                const withdrawButton = document.querySelector(`#withdrawInvestmentPanel .withdraw-investment-button[data-id="${currentInvestmentIdToWithdraw}"]`);
                if (withdrawButton) {
                    setButtonProcessingState(withdrawButton, true);
                }
                
                handleWithdrawInvestment(currentInvestmentIdToWithdraw);
                hideWithdrawConfirmation();
            };
        }

        function hideWithdrawConfirmation() {
            const modal = document.getElementById('confirmationModal');
            modal.classList.remove('open');
            currentInvestmentIdToWithdraw = null; // Clear stored ID
        }

        function handleRedeemInvestment(event) {
            const button = event.target;
            setButtonProcessingState(button, true);

            setTimeout(() => {
                const investmentId = button.dataset.id;
                const investmentIndex = currentUserData.investments.findIndex(inv => inv.id === investmentId);

                if (investmentIndex > -1) {
                    const investment = currentUserData.investments[investmentIndex];
                    if (investment.status === 'matured') {
                        const redemptionAmount = investment.targetAmount; // Use targetAmount for redemption
                        currentUserData.userBalance += redemptionAmount;
                        investment.status = 'redeemed';

                        recordTransaction('investmentRedeem', redemptionAmount, `Redeemed ${investment.name}`);
                        saveCurrentUserData();
                        updateBalanceDisplay();
                        updateTotalInvestmentValueDisplay(); 
                        renderInvestments(); // Re-render main investments list
                        showDashboardStatusMessage(`Successfully redeemed ₦${redemptionAmount.toLocaleString('en-NG')} from your investment! Your liquid balance has been updated.`, 'success');
                    } else {
                        showDashboardStatusMessage("Investment is not matured for redemption.", "error");
                    }
                } else {
                    showDashboardStatusMessage("Investment not found.", "error");
                }
                setButtonProcessingState(button, false);
            }, PROCESS_DELAY_MS);
        }

        // Modified handleWithdrawInvestment to accept ID directly
        function handleWithdrawInvestment(investmentId) {
            // Find the button associated with this investment to update its state
            const withdrawButton = document.querySelector(`#withdrawInvestmentPanel .withdraw-investment-button[data-id="${investmentId}"]`);

            setTimeout(() => {
                const investmentIndex = currentUserData.investments.findIndex(inv => inv.id === investmentId);

                if (investmentIndex > -1) {
                    const investment = currentUserData.investments[investmentIndex];
                    // Allow withdrawal for any 'active' or 'matured' plan (that hasn't been redeemed yet)
                    if (investment.status === 'active' || investment.status === 'matured') {
                        const withdrawalAmount = investment.initialAmount;
                        
                        currentUserData.userBalance += withdrawalAmount;
                        investment.status = 'withdrawn'; // Mark as withdrawn/cancelled

                        recordTransaction('investmentWithdraw', withdrawalAmount, `Withdrew capital from ${investment.name}. No profits earned on early withdrawal.`);
                        saveCurrentUserData();
                        updateBalanceDisplay();
                        updateTotalInvestmentValueDisplay(); 
                        renderInvestments(); // Re-render main investments list
                        renderInvestmentsForWithdrawal(); // Re-render withdrawal list to remove the item
                        showDashboardStatusMessage(`Successfully withdrew ₦${withdrawalAmount.toLocaleString('en-NG')} capital from "${investment.name}". Note: Any potential profits were forfeited.`, 'info');
                    } else {
                        showDashboardStatusMessage("This investment cannot be withdrawn at this time.", "error");
                    }
                } else {
                    showDashboardStatusMessage("Investment not found.", "error");
                }
                // Ensure the button state is reset after action
                if (withdrawButton) {
                    setButtonProcessingState(withdrawButton, false);
                }
            }, PROCESS_DELAY_MS);
        }

        function applyDailyGrowth() {
            const today = new Date();
            today.setHours(0, 0, 0, 0);

            let updatesMade = false;

            for (let i = 0; i < currentUserData.investments.length; i++) {
                const investment = currentUserData.investments[i];
                // Apply daily growth for Rapid Growth and Quick Return Plans
                if ((investment.planType === 'Rapid Growth Plan' || investment.planType === 'Quick Return Plan') && investment.status === 'active') {
                    const lastAppliedDate = new Date(investment.lastGrowthAppliedDate);
                    lastAppliedDate.setHours(0, 0, 0, 0);

                    const daysPassed = Math.floor((today.getTime() - lastAppliedDate.getTime()) / (1000 * 60 * 60 * 24));

                    if (daysPassed > 0) {
                        let newCurrentValue = investment.currentValue;
                        const dailyAdditionAmount = (investment.planType === 'Rapid Growth Plan') ? RAPID_GROWTH_DAILY_ADDITION : QUICK_RETURN_DAILY_ADDITION;
                        
                        for (let j = 0; j < daysPassed; j++) {
                            newCurrentValue += dailyAdditionAmount;
                        }

                        if (newCurrentValue >= investment.targetAmount) {
                            newCurrentValue = investment.targetAmount;
                            investment.status = 'matured';
                            console.log(`Investment ${investment.id} matured!`);
                        }
                        investment.currentValue = newCurrentValue;
                        investment.lastGrowthAppliedDate = today.toISOString();
                        updatesMade = true;
                    }
                }
                // Check for maturity for Mega Oil Prospector Plan
                else if (investment.planType === 'Mega Oil Prospector Plan' && investment.status === 'active') {
                    const maturityDate = new Date(investment.maturityDate);
                    maturityDate.setHours(0, 0, 0, 0); // Normalize to start of day

                    if (today.getTime() >= maturityDate.getTime()) {
                        investment.currentValue = investment.targetAmount; // Set current value to target upon maturity
                        investment.status = 'matured';
                        updatesMade = true;
                        console.log(`Mega Oil Prospector Investment ${investment.id} matured!`);
                    }
                }
            }

            if (updatesMade) {
                saveCurrentUserData();
                updateTotalInvestmentValueDisplay(); 
                renderInvestments();
                console.log("Daily growth/maturity applied to investments.");
            }
        }

        function renderTransactionHistory() {
            const historyList = document.getElementById('historyList');
            historyList.innerHTML = '';

            if (currentUserData.transactions.length === 0) {
                historyList.innerHTML = '<p class="text-center text-gray-500 py-4">No transactions yet.</p>';
                return;
            }

            const sortedTransactions = [...currentUserData.transactions].sort((a, b) => new Date(b.date) - new Date(a.date));

            sortedTransactions.forEach(tx => {
                const txDiv = document.createElement('div');
                let typeColorClass = 'text-gray-800';
                let amountSign = '';
                let amountColorClass = 'text-gray-800';
                let formattedAmount = tx.amount.toLocaleString('en-NG', { minimumFractionDigits: 2, maximumFractionDigits: 2 });
                let receiptButtonHtml = '';

                if (tx.type === 'deposit' || tx.type === 'withdrawalToBank') {
                    typeColorClass = (tx.type === 'deposit') ? 'text-blue-600' : 'text-purple-600';
                    amountSign = (tx.type === 'deposit') ? '+' : '-';
                    amountColorClass = (tx.type === 'deposit') ? 'text-green-600' : 'text-red-600';
                    receiptButtonHtml = `<button class="download-receipt-history-button bg-blue-500 hover:bg-blue-600 text-white font-bold py-1 px-3 rounded-full text-xs transition-colors mt-2" data-tx-id="${tx.id}">Download Receipt</button>`;
                } else if (tx.type === 'investmentBuy') {
                    typeColorClass = 'text-amber-600';
                    amountSign = '-';
                    amountColorClass = 'text-red-600';
                } else if (tx.type === 'investmentRedeem') {
                    typeColorClass = 'text-green-600';
                    amountSign = '+';
                    amountColorClass = 'text-green-600';
                } else if (tx.type === 'investmentWithdraw') { // Early withdrawal of capital
                    typeColorClass = 'text-red-600 font-semibold'; // Make it stand out
                    amountSign = '+'; // It's a credit to liquid balance
                    amountColorClass = 'text-green-600'; // The cash comes back to liquid balance
                } else {
                    // Default for other transaction types without special handling
                    typeColorClass = 'text-gray-800';
                    amountSign = '';
                    amountColorClass = 'text-gray-800';
                }
                
                let balanceAfterFormatted = (tx.balanceAfter !== undefined) ? tx.balanceAfter.toLocaleString('en-NG', { minimumFractionDigits: 2, maximumFractionDigits: 2 }) : 'N/A';

                txDiv.className = 'bg-gray-100 p-3 sm:p-4 rounded-lg shadow-sm mb-3 flex flex-col md:flex-row md:justify-between md:items-center';
                txDiv.innerHTML = `
                    <div class="mb-1 md:mb-0">
                        <p class="font-semibold text-sm sm:text-base ${typeColorClass}">${tx.description}</p>
                        <p class="text-xs text-gray-500">${new Date(tx.date).toLocaleString()}</p>
                    </div>
                    <div class="text-right flex flex-col items-end">
                        <p class="font-bold text-sm sm:text-base ${amountColorClass}">${amountSign}₦${formattedAmount}</p>
                        <p class="text-xs text-gray-600">Balance: ₦${balanceAfterFormatted}</p>
                        ${receiptButtonHtml}
                    </div>
                `;
                historyList.appendChild(txDiv);
            });

            // Re-attach event listeners for new download receipt buttons after rendering history
            document.querySelectorAll('.download-receipt-history-button').forEach(button => {
                button.addEventListener('click', (event) => {
                    const txId = event.target.dataset.txId;
                    const transaction = currentUserData.transactions.find(t => t.id === txId);
                    if (transaction) {
                        downloadReceiptAsPNG(transaction);
                    } else {
                        showDashboardStatusMessage("Transaction details not found for receipt.", "error");
                    }
                });
            });
        }

        function processDepositApproval(depositId) {
            const pendingIndex = currentUserData.pendingDeposits.findIndex(req => req.id === depositId);
            if (pendingIndex > -1) {
                const depositRequest = currentUserData.pendingDeposits[pendingIndex];
                
                recordTransaction('deposit', depositRequest.amount, `Deposit confirmed: ₦${depositRequest.amount.toLocaleString('en-NG')}`, {
                    depositorName: currentUserData.username,
                    sourceAccountName: depositRequest.senderAccountName,
                    sourceAccountNumber: depositRequest.accountNumber,
                    sourceBankName: depositRequest.senderBankName,
                    destinationAccountNumber: depositRequest.depositAccountNumber,
                    destinationBankName: depositRequest.depositBankName,
                    receiptProvided: depositRequest.receiptProvided
                });

                currentUserData.userBalance += depositRequest.amount;
                
                currentUserData.pendingDeposits.splice(pendingIndex, 1);
                saveCurrentUserData();
                updateBalanceDisplay();
                renderTransactionHistory();
                showDashboardStatusMessage(`Deposit of ₦${depositRequest.amount.toLocaleString('en-NG')} is now available! ${depositRequest.receiptProvided ? 'Receipt verified.' : ''}`, 'success');
            }
        }

        function processWithdrawalApproval(withdrawalId) {
            const pendingIndex = currentUserData.pendingWithdrawals.findIndex(req => req.id === withdrawalId);
            if (pendingIndex > -1) {
                const withdrawalRequest = currentUserData.pendingWithdrawals[pendingIndex];

                recordTransaction('withdrawalToBank', withdrawalRequest.amount, `Withdrawal confirmed: ₦${withdrawalRequest.amount.toLocaleString('en-NG')} to ${withdrawalRequest.bankAccountName} (${withdrawalRequest.bankAccountNumber}) - ${withdrawalRequest.bankName}`, withdrawalRequest);

                currentUserData.userBalance -= withdrawalRequest.amount;
                
                currentUserData.pendingWithdrawals.splice(pendingIndex, 1);
                saveCurrentUserData();
                updateBalanceDisplay();
                renderTransactionHistory();
                showDashboardStatusMessage(`Withdrawal of ₦${withdrawalRequest.amount.toLocaleString('en-NG')} processed. Funds sent to your bank account.`, 'success');
            }
        }
        
        function checkAndProcessPendingTransactionsOnLoad() {
            const now = Date.now();

            for (let i = currentUserData.pendingDeposits.length - 1; i >= 0; i--) {
                const deposit = currentUserData.pendingDeposits[i];
                const timeRemaining = new Date(deposit.expectedApprovalTime).getTime() - now;

                if (timeRemaining <= 0) {
                    processDepositApproval(deposit.id);
                } else {
                    setTimeout(() => {
                        processDepositApproval(deposit.id);
                    }, timeRemaining);
                    console.log(`Scheduled deposit approval for ${currentUserData.username} in ${timeRemaining / 1000} seconds.`);
                }
            }

            for (let i = currentUserData.pendingWithdrawals.length - 1; i >= 0; i--) {
                const withdrawal = currentUserData.pendingWithdrawals[i];
                const timeRemaining = new Date(withdrawal.expectedApprovalTime).getTime() - now;

                if (timeRemaining <= 0) {
                    processWithdrawalApproval(withdrawal.id);
                } else {
                    setTimeout(() => {
                        processWithdrawalApproval(withdrawal.id);
                    }, timeRemaining);
                    console.log(`Scheduled withdrawal approval for ${currentUserData.username} in ${timeRemaining / 1000} seconds.`);
                }
            }
        }

        function downloadReceiptAsPNG(tx) {
            const tempContainer = document.createElement('div');
            tempContainer.className = 'receipt-container-temp'; // Apply defined styles

            const txDate = new Date(tx.date);
            const formattedDate = txDate.toLocaleDateString('en-NG', { weekday: 'long', year: 'numeric', month: 'long', day: 'numeric' });
            const formattedTime = txDate.toLocaleTimeString('en-NG', { hour: '2-digit', minute: '2-digit' });

            let amountLabel = '';
            let detailsHtml = '';
            let debitCreditClass = ''; // For amount color on receipt

            if (tx.type === 'withdrawalToBank') {
                amountLabel = 'DEBIT';
                debitCreditClass = 'text-red-600'; // Red for debits on our side, like in Moniepoint example
                const randomAdminId = Math.random().toString(36).substring(2, 8).toUpperCase(); // Generate random ID for admin
                detailsHtml = `
                    <div class="receipt-detail-item-temp">
                        <p class="receipt-detail-label-temp">Transaction Type</p>
                        <p class="receipt-detail-value-temp text-blue-600">TRANSFER</p>
                    </div>
                    <div class="receipt-detail-item-temp">
                        <p class="receipt-detail-label-temp">Beneficiary</p>
                        <p class="receipt-detail-value-temp">${tx.bankAccountName} | ${tx.bankAccountNumber}</p>
                    </div>
                    <div class="receipt-detail-item-temp">
                        <p class="receipt-detail-label-temp">Beneficiary Institution</p>
                        <p class="receipt-detail-value-temp">${tx.bankName}</p>
                    </div>
                    <div class="receipt-detail-item-temp">
                        <p class="receipt-detail-label-temp">Sender Name</p>
                        <p class="receipt-detail-value-temp">Thx Admin-${randomAdminId}</p>
                    </div>
                    <div class="receipt-detail-item-temp">
                        <p class="receipt-detail-label-temp">Source Institution</p>
                        <p class="receipt-detail-value-temp">Thx Oil And Gas Investment</p>
                    </div>
                    <div class="receipt-detail-item-temp">
                        <p class="receipt-detail-label-temp">Transaction Date</p>
                        <p class="receipt-detail-value-temp">${formattedDate} | ${formattedTime}</p>
                    </div>
                    <div class="receipt-detail-item-temp">
                        <p class="receipt-detail-label-temp">Provider Reference</p>
                        <p class="receipt-detail-value-temp text-gray-700">TXN-${tx.id.substring(tx.id.length - 8).toUpperCase()}</p>
                    </div>
                `;
            } else if (tx.type === 'deposit') {
                amountLabel = 'CREDIT';
                debitCreditClass = 'text-green-600'; // Green for credits on our side
                detailsHtml = `
                    <div class="receipt-detail-item-temp">
                        <p class="receipt-detail-label-temp">Transaction Type</p>
                        <p class="receipt-detail-value-temp text-green-600">DEPOSIT</p>
                    </div>
                    <div class="receipt-detail-item-temp">
                        <p class="receipt-detail-label-temp">Depositor Name</p>
                        <p class="receipt-detail-value-temp">${tx.depositorName || currentUserData.username}</p>
                    </div>
                    <div class="receipt-detail-item-temp">
                        <p class="receipt-detail-label-temp">Depositor Account Name</p>
                        <p class="receipt-detail-value-temp">${tx.sourceAccountName || 'N/A'}</p>
                    </div>
                     <div class="receipt-detail-item-temp">
                        <p class="receipt-detail-label-temp">Depositor Account Number</p>
                        <p class="receipt-detail-value-temp">${tx.sourceAccountNumber || 'N/A'}</p>
                    </div>
                    <div class="receipt-detail-item-temp">
                        <p class="receipt-detail-label-temp">Depositor Bank</p>
                        <p class="receipt-detail-value-temp">${tx.sourceBankName || 'N/A'}</p>
                    </div>
                    <div class="receipt-detail-item-temp">
                        <p class="receipt-detail-label-temp">Recipient Account</p>
                        <p class="receipt-detail-value-temp">${tx.destinationAccountNumber || 'N/A'}</p>
                    </div>
                    <div class="receipt-detail-item-temp">
                        <p class="receipt-detail-label-temp">Recipient Bank</p>
                        <p class="receipt-detail-value-temp">${tx.destinationBankName || 'N/A'}</p>
                    </div>
                    <div class="receipt-detail-item-temp">
                        <p class="receipt-detail-label-temp">Transaction Date</p>
                        <p class="receipt-detail-value-temp">${formattedDate} | ${formattedTime}</p>
                    </div>
                    <div class="receipt-detail-item-temp">
                        <p class="receipt-detail-label-temp">Reference</p>
                        <p class="receipt-detail-value-temp text-gray-700">DEP-${tx.id.substring(tx.id.length - 8).toUpperCase()}</p>
                    </div>
                     ${tx.receiptProvided ? `
                     <div class="receipt-detail-item-temp">
                        <p class="receipt-detail-label-temp">Proof of Payment</p>
                        <p class="receipt-detail-value-temp text-green-600">Provided</p>
                    </div>` : ''}
                `;
            } else {
                amountLabel = tx.type.toUpperCase(); // Fallback for other transaction types
                debitCreditClass = 'text-gray-800'; // Default for other types
                 detailsHtml = `
                    <div class="receipt-detail-item-temp">
                        <p class="receipt-detail-label-temp">Description</p>
                        <p class="receipt-detail-value-temp">${tx.description}</p>
                    </div>
                    <div class="receipt-detail-item-temp">
                        <p class="receipt-detail-label-temp">Transaction Type</p>
                        <p class="receipt-detail-value-temp">${tx.type.toUpperCase()}</p>
                    </div>
                    <div class="receipt-detail-item-temp">
                        <p class="receipt-detail-label-temp">Transaction Date</p>
                        <p class="receipt-detail-value-temp">${formattedDate} | ${formattedTime}</p>
                    </div>
                    <div class="receipt-detail-item-temp">
                        <p class="receipt-detail-label-temp">Amount</p>
                        <p class="receipt-detail-value-temp">₦${tx.amount.toLocaleString('en-NG', { minimumFractionDigits: 2, maximumFractionDigits: 2 })}</p>
                    </div>
                     <div class="receipt-detail-item-temp">
                        <p class="receipt-detail-label-temp">Balance After</p>
                        <p class="receipt-detail-value-temp">₦${tx.balanceAfter.toLocaleString('en-NG', { minimumFractionDigits: 2, maximumFractionDigits: 2 })}</p>
                    </div>
                     <div class="receipt-detail-item-temp">
                        <p class="receipt-detail-label-temp">Reference</p>
                        <p class="receipt-detail-value-temp">${tx.id}</p>
                    </div>
                 `;
            }

            tempContainer.innerHTML = `
                <div class="receipt-header-logo-temp">
                    <span class="text-blue-800 font-bold text-xl">Thx Oil And Gas Investment</span>
                </div>
                <div class="receipt-amount-section-temp">
                    <div>
                        <p class="text-lg font-semibold opacity-80">${amountLabel}</p>
                        <p class="receipt-amount-text-temp ${debitCreditClass}">₦${tx.amount.toLocaleString('en-NG', { minimumFractionDigits: 2, maximumFractionDigits: 2 })}</p>
                    </div>
                    <div class="w-10 h-10 bg-white text-blue-800 rounded-full flex items-center justify-center font-bold text-2xl">
                        T
                    </div>
                </div>
                <div class="receipt-details-section-temp">
                    ${detailsHtml}
                </div>
            `;

            document.body.appendChild(tempContainer); // Add to DOM off-screen for html2canvas

            html2canvas(tempContainer, {
                scale: 2, // Increase scale for better resolution
                useCORS: true,
                backgroundColor: null // Transparent background for the capture
            }).then(canvas => {
                const link = document.createElement('a');
                link.download = `thx_receipt_${tx.id}.png`;
                link.href = canvas.toDataURL('image/png');
                link.click();
                tempContainer.remove(); // Clean up the temporary element
            }).catch(error => {
                console.error('Error generating receipt:', error);
                showDashboardStatusMessage('Failed to generate receipt. Please try again.', 'error');
                tempContainer.remove(); // Ensure cleanup even on error
            });
        }

        document.addEventListener('DOMContentLoaded', function() {
            loadAllUsers();

            const loginForm = document.getElementById('loginForm');
            const loginUsernameInput = document.getElementById('loginUsername');
            const loginPasswordInput = document.getElementById('loginPassword');
            const loginUsernameError = document.getElementById('loginUsernameError');
            const loginPasswordError = document.getElementById('loginPasswordError');
            const loginSubmitButton = document.getElementById('loginSubmitButton');

            const signupForm = document.getElementById('signupForm');
            const signupUsernameInput = document.getElementById('signupUsername'); // New: Username input
            const signupEmailInput = document.getElementById('signupEmail');
            const signupPhoneInput = document.getElementById('signupPhone');
            const signupPasswordInput = document.getElementById('signupPassword');
            const signupUsernameError = document.getElementById('signupUsernameError'); // New: Username error
            const signupPhoneError = document.getElementById('signupPhoneError');
            const signupEmailError = document.getElementById('signupEmailError');
            const signupPasswordError = document.getElementById('signupPasswordError');
            const signupSubmitButton = document.getElementById('signupSubmitButton');

            const depositButton = document.getElementById('depositButton');
            const withdrawToBankButton = document.getElementById('withdrawToBankButton');
            const withdrawInvestmentButton = document.getElementById('withdrawInvestmentButton'); // NEW
            const historyButton = document.getElementById('historyButton');
            const logoutButton = document.getElementById('logoutButton');

            // Get the new panel sections
            const depositPanel = document.getElementById('depositPanel');
            const withdrawPanel = document.getElementById('withdrawPanel');
            const withdrawInvestmentPanel = document.getElementById('withdrawInvestmentPanel'); // NEW
            const historyPanel = document.getElementById('historyPanel');

            const depositAccountNumberDisplay = document.getElementById('depositAccountNumberDisplay');
            const depositBankNameDisplay = document.getElementById('depositBankNameDisplay');
            const depositAmountInput = document.getElementById('depositAmount');
            const senderAccountNameInput = document.getElementById('senderAccountName'); // NEW
            const senderBankNameInput = document.getElementById('senderBankName'); // NEW
            const transferAccountNumberInput = document.getElementById('transferAccountNumber');
            const depositReceiptInput = document.getElementById('depositReceipt'); // NEW

            const withdrawAmountInput = document.getElementById('withdrawAmount');
            const bankAccountNameInput = document.getElementById('bankAccountName');
            const bankAccountNumberInput = document.getElementById('bankAccountNumber');
            const bankNameInput = document.getElementById('bankName');

            const depositAmountError = document.getElementById('depositAmountError');
            const senderAccountNameError = document.getElementById('senderAccountNameError'); // NEW
            const senderBankNameError = document.getElementById('senderBankNameError'); // NEW
            const transferAccountNumberError = document.getElementById('transferAccountNumberError');
            const depositReceiptError = document.getElementById('depositReceiptError'); // NEW

            const withdrawAmountError = document.getElementById('withdrawAmountError');
            const bankAccountNameError = document.getElementById('bankAccountNameError');
            const bankAccountNumberError = document.getElementById('bankAccountNumberError');
            const bankNameError = document.getElementById('bankNameError');

            const cancelDepositPanelButton = document.getElementById('cancelDepositPanel');
            const confirmDepositButton = document.getElementById('confirmDeposit');

            const cancelWithdrawalPanelButton = document.getElementById('cancelWithdrawalPanel');
            const confirmWithdrawalButton = document.getElementById('confirmWithdrawal');

            const closeWithdrawInvestmentPanelButton = document.getElementById('closeWithdrawInvestmentPanel'); // NEW
            const closeHistoryPanelButton = document.getElementById('closeHistoryPanel');
            
            const investButtons = document.querySelectorAll('.invest-button');

            // Mobile nav toggles
            document.getElementById('openMobileNav').addEventListener('click', () => {
                document.getElementById('mobileNavOverlay').classList.remove('hidden'); // Ensure it's visible
                document.getElementById('mobileNavOverlay').classList.add('open');
            });
            document.getElementById('closeMobileNav').addEventListener('click', () => {
                document.getElementById('mobileNavOverlay').classList.remove('open');
                setTimeout(() => { // Give time for transition before hiding completely
                    document.getElementById('mobileNavOverlay').classList.add('hidden');
                }, 300);
            });


            if (loggedInUsername) {
                loadCurrentUserData();
                checkAndProcessPendingTransactionsOnLoad();
                showDashboardPage();
            } else {
                showHomePage();
            }

            // Function to hide all functional panels
            function hideAllFunctionalPanels() {
                depositPanel.classList.add('hidden');
                withdrawPanel.classList.add('hidden');
                withdrawInvestmentPanel.classList.add('hidden'); // NEW
                historyPanel.classList.add('hidden');
            }

            loginForm.addEventListener('submit', function(event) {
                event.preventDefault();
                showLoginStatusMessage('', 'hidden');

                loginUsernameInput.classList.remove('border-red-500');
                loginPasswordInput.classList.remove('border-red-500');

                let isValid = true;
                const loginIdentifier = loginUsernameInput.value.trim(); // This input will be either email or phone
                const password = loginPasswordInput.value.trim();

                if (loginIdentifier === '') {
                    loginUsernameError.classList.remove('hidden');
                    loginUsernameInput.classList.add('border-red-500');
                    isValid = false;
                } else {
                    loginUsernameError.classList.add('hidden');
                }

                if (password === '') {
                    loginPasswordError.classList.remove('hidden');
                    loginPasswordInput.classList.add('border-red-500');
                    isValid = false;
                } else {
                    loginPasswordError.classList.add('hidden');
                }

                if (isValid) {
                    setButtonProcessingState(loginSubmitButton, true);
                    setTimeout(() => {
                        // Check if the loginIdentifier (email/phone) exists in allUsers
                        if (allUsers[loginIdentifier] && allUsers[loginIdentifier].password === password) {
                            loggedInUsername = loginIdentifier; // Store the identifier used for login
                            localStorage.setItem('loggedInUser', loggedInUsername);
                            loadCurrentUserData(); // Load the full user data based on the stored key
                            checkAndProcessPendingTransactionsOnLoad();
                            showLoginStatusMessage('Login Successful! Redirecting...', 'success');
                            setTimeout(() => { showDashboardPage(); }, 500);
                        } else {
                            showLoginStatusMessage('Login Failed! Invalid email/phone or password.', 'error');
                        }
                        setButtonProcessingState(loginSubmitButton, false, 'Log In');
                    }, PROCESS_DELAY_MS);
                } else {
                    showLoginStatusMessage('Validation Error! Please fill in all required fields.', 'error');
                }
            });

            signupForm.addEventListener('submit', function(event) {
                event.preventDefault();
                showSignupStatusMessage('', 'hidden');

                signupUsernameInput.classList.remove('border-red-500'); // Clear username error
                signupPhoneInput.classList.remove('border-red-500');
                signupEmailInput.classList.remove('border-red-500');
                signupPasswordInput.classList.remove('border-red-500');

                let isValid = true;
                const username = signupUsernameInput.value.trim(); // Get username
                const phone = signupPhoneInput.value.trim();
                const email = signupEmailInput.value.trim();
                const password = signupPasswordInput.value.trim();

                if (username === '') { // Validate username
                    signupUsernameError.classList.remove('hidden');
                    signupUsernameInput.classList.add('border-red-500');
                    isValid = false;
                } else {
                    signupUsernameError.classList.add('hidden');
                }

                const phonePattern = /^(070|080|081|090|091)\d{8}$/;
                if (!phonePattern.test(phone)) {
                    signupPhoneError.classList.remove('hidden');
                    signupPhoneInput.classList.add('border-red-500');
                    isValid = false;
                } else {
                    signupPhoneError.classList.add('hidden');
                }

                if (!email.includes('@') || !email.includes('.')) {
                    signupEmailError.classList.remove('hidden');
                    signupEmailInput.classList.add('border-red-500');
                    isValid = false;
                } else {
                    signupEmailError.classList.add('hidden');
                }

                if (password.length < 8) {
                    signupPasswordError.classList.remove('hidden');
                    signupPasswordInput.classList.add('border-red-500');
                    isValid = false;
                } else {
                    signupPasswordError.classList.add('hidden');
                }

                if (isValid) {
                    setButtonProcessingState(signupSubmitButton, true);
                    setTimeout(() => {
                        // Check if username, email, or phone already exists
                        const usernameExists = Object.values(allUsers).some(user => user.username === username);
                        const emailExists = Object.keys(allUsers).some(key => key === email);
                        const phoneExists = Object.keys(allUsers).some(key => key === phone);


                        if (usernameExists) {
                            showSignupStatusMessage('Username already taken. Please choose another.', 'error');
                        } else if (emailExists) { // Only check email for primary key existence
                            showSignupStatusMessage('Account already exists with this email. Please login.', 'error');
                        } else if (phoneExists) { // Only check phone for primary key existence
                            showSignupStatusMessage('Account already exists with this phone number. Please login.', 'error');
                        } else {
                            const userData = {
                                username: username, // Save the new username
                                password: password,
                                userBalance: 0.00,
                                investments: [],
                                transactions: [],
                                pendingDeposits: [],
                                pendingWithdrawals: []
                            };
                            allUsers[email] = userData; // Use email as primary key in allUsers
                            if (phone) { // Also store by phone number if provided, pointing to the same user data
                                allUsers[phone] = userData;
                            }
                            saveAllUsers();

                            showSignupStatusMessage('Account created successfully! You can now log in.', 'success');
                            signupForm.reset();
                            
                            setTimeout(() => { showLoginPage(); }, 500);
                        }
                        setButtonProcessingState(signupSubmitButton, false, 'Sign Up');
                    }, PROCESS_DELAY_MS);
                } else {
                    showSignupStatusMessage('Validation Error! Please correct the fields above.', 'error');
                }
            });

            depositButton.addEventListener('click', () => {
                hideAllFunctionalPanels(); // Hide others before showing this one
                const randomAccount = depositAccounts[Math.floor(Math.random() * depositAccounts.length)];
                depositAccountNumberDisplay.textContent = randomAccount.account;
                depositBankNameDisplay.textContent = randomAccount.bank;

                depositPanel.classList.remove('hidden'); // Show the panel
                depositAmountInput.value = '';
                senderAccountNameInput.value = ''; // Clear new field
                senderBankNameInput.value = ''; // Clear new field
                transferAccountNumberInput.value = '';
                depositReceiptInput.value = ''; // Clear file input
                hideAllDepositErrors();
                setButtonProcessingState(confirmDepositButton, false, 'Confirm Deposit');
            });

            cancelDepositPanelButton.addEventListener('click', () => {
                depositPanel.classList.add('hidden'); // Hide the panel
            });

            confirmDepositButton.addEventListener('click', () => {
                const amount = parseFloat(depositAmountInput.value);
                const senderAccountName = senderAccountNameInput.value.trim(); // NEW
                const senderBankName = senderBankNameInput.value.trim(); // NEW
                const transferAccountNumber = transferAccountNumberInput.value.trim();
                const depositReceiptFile = depositReceiptInput.files[0]; // NEW
                const selectedDepositAccount = depositAccounts.find(acc => acc.account === depositAccountNumberDisplay.textContent);


                let isValid = true;
                hideAllDepositErrors();

                if (isNaN(amount) || amount <= 0) {
                    depositAmountError.classList.remove('hidden');
                    depositAmountInput.classList.add('border-red-500');
                    isValid = false;
                }

                if (senderAccountName === '') { // NEW VALIDATION
                    senderAccountNameError.classList.remove('hidden');
                    senderAccountNameInput.classList.add('border-red-500');
                    isValid = false;
                }

                if (senderBankName === '') { // NEW VALIDATION
                    senderBankNameError.classList.remove('hidden');
                    senderBankNameInput.classList.add('border-red-500');
                    isValid = false;
                }

                const accountNumPattern = /^\d{10}$/;
                if (!accountNumPattern.test(transferAccountNumber)) {
                    transferAccountNumberError.classList.remove('hidden');
                    transferAccountNumberInput.classList.add('border-red-500');
                    isValid = false;
                }

                // Optional: Validate receipt file type if selected
                let receiptProvided = false;
                if (depositReceiptFile) {
                    if (depositReceiptFile.type !== 'image/png') {
                        depositReceiptError.classList.remove('hidden');
                        depositReceiptInput.classList.add('border-red-500');
                        depositReceiptError.textContent = 'Only PNG files are allowed for receipts.';
                        isValid = false;
                    } else {
                        receiptProvided = true; // Mark as provided for transaction record
                    }
                }

                if (isValid) {
                    setButtonProcessingState(confirmDepositButton, true);
                    setTimeout(() => {
                        depositPanel.classList.add('hidden'); // Hide after submission
                        const whatsappLink = `<a href="https://wa.me/2348037676772" target="_blank" class="text-blue-500 hover:underline">08037676772 <i class="fab fa-whatsapp text-green-500"></i></a>`;
                        let statusMsg = `Your deposit request has been submitted. It will be available in approximately 30 minutes, waiting for internal processing.`;
                        if (receiptProvided) {
                            statusMsg += `<br>Your receipt has been received and is awaiting verification.`;
                        }
                        statusMsg += `<br>If you have any trouble, contact us: ${whatsappLink}`;
                        showDashboardStatusMessage(statusMsg, 'info');

                        const expectedApprovalTime = Date.now() + DEPOSIT_DELAY_MS;
                        const newPendingDeposit = {
                            id: 'pending_' + Date.now() + Math.random().toString(36).substring(2, 9),
                            amount: amount,
                            senderAccountName: senderAccountName, // NEW
                            senderBankName: senderBankName,     // NEW
                            accountNumber: transferAccountNumber, 
                            sourceBankName: senderBankName, // Re-use for source bank in receipt
                            depositAccountNumber: selectedDepositAccount.account, 
                            depositBankName: selectedDepositAccount.bank, 
                            date: new Date().toISOString(),
                            expectedApprovalTime: new Date(expectedApprovalTime).toISOString(),
                            receiptProvided: receiptProvided // NEW: flag if receipt was given
                        };
                        currentUserData.pendingDeposits.unshift(newPendingDeposit);
                        saveCurrentUserData();
                        console.log('Deposit request added to pending queue:', newPendingDeposit);
                        setButtonProcessingState(confirmDepositButton, false, 'Confirm Deposit');

                        setTimeout(() => {
                            processDepositApproval(newPendingDeposit.id);
                        }, DEPOSIT_DELAY_MS);
                    }, PROCESS_DELAY_MS);

                } else {
                    showDashboardStatusMessage('Please fill in all required deposit details correctly and ensure your receipt is a PNG file.', 'error');
                }
            });

            withdrawToBankButton.addEventListener('click', () => {
                hideAllFunctionalPanels(); // Hide others before showing this one
                withdrawPanel.classList.remove('hidden'); // Show the panel
                withdrawAmountInput.value = '';
                bankAccountNameInput.value = '';
                bankAccountNumberInput.value = '';
                bankNameInput.value = '';
                hideAllWithdrawalErrors();
                setButtonProcessingState(confirmWithdrawalButton, false, 'Confirm Withdrawal');
            });

            cancelWithdrawalPanelButton.addEventListener('click', () => {
                withdrawPanel.classList.add('hidden'); // Hide the panel
            });

            confirmWithdrawalButton.addEventListener('click', () => {
                const amountToWithdraw = parseFloat(withdrawAmountInput.value);
                const recipientAccountName = bankAccountNameInput.value.trim();
                const recipientAccountNumber = bankAccountNumberInput.value.trim();
                const recipientBankName = bankNameInput.value.trim();

                let isValid = true;
                hideAllWithdrawalErrors();

                if (isNaN(amountToWithdraw) || amountToWithdraw < 500) { // Changed minimum to 500
                    withdrawAmountError.classList.remove('hidden');
                    withdrawAmountInput.classList.add('border-red-500');
                    withdrawAmountError.textContent = `Please enter a valid amount (minimum ₦500).`;
                    isValid = false;
                } else if (amountToWithdraw > currentUserData.userBalance) {
                    withdrawAmountError.classList.remove('hidden');
                    withdrawAmountInput.classList.add('border-red-500');
                    withdrawAmountError.textContent = `Insufficient balance. You only have ₦${currentUserData.userBalance.toLocaleString('en-NG')}.`;
                    isValid = false;
                }

                if (recipientAccountName === '') {
                    bankAccountNameError.classList.remove('hidden');
                    bankAccountNameInput.classList.add('border-red-500');
                    isValid = false;
                }

                const accountNumPattern = /^\d{10}$/;
                if (!accountNumPattern.test(recipientAccountNumber)) {
                    bankAccountNumberError.classList.remove('hidden');
                    bankAccountNumberInput.classList.add('border-red-500');
                    isValid = false;
                }
                
                if (recipientBankName === '') {
                    bankNameError.classList.remove('hidden');
                    bankNameInput.classList.add('border-red-500');
                    isValid = false;
                }

                if (isValid) {
                    setButtonProcessingState(confirmWithdrawalButton, true);
                    setTimeout(() => {
                        withdrawPanel.classList.add('hidden'); // Hide after submission
                        const whatsappLink = `<a href="https://wa.me/2348037676772" target="_blank" class="text-blue-500 hover:underline">08037676772 <i class="fab fa-whatsapp text-green-500"></i></a>`;
                        showDashboardStatusMessage(`Your withdrawal request has been submitted. Funds will be sent in approximately 15 minutes, waiting for internal processing.<br>If you have any trouble, contact us: ${whatsappLink}`, 'info');

                        const expectedApprovalTime = Date.now() + WITHDRAWAL_DELAY_MS;
                        const newPendingWithdrawal = {
                            id: 'pending_w_' + Date.now() + Math.random().toString(36).substring(2, 9),
                            amount: amountToWithdraw,
                            bankAccountName: recipientAccountName,
                            bankAccountNumber: recipientAccountNumber,
                            bankName: recipientBankName,
                            date: new Date().toISOString(),
                            expectedApprovalTime: new Date(expectedApprovalTime).toISOString()
                        };
                        currentUserData.pendingWithdrawals.unshift(newPendingWithdrawal);
                        saveCurrentUserData();
                        console.log('Withdrawal request added to pending queue:', newPendingWithdrawal);
                        setButtonProcessingState(confirmWithdrawalButton, false, 'Confirm Withdrawal');

                        setTimeout(() => {
                            processWithdrawalApproval(newPendingWithdrawal.id);
                        }, WITHDRAWAL_DELAY_MS);
                    }, PROCESS_DELAY_MS);

                } else {
                    showDashboardStatusMessage('Please fill in all withdrawal details correctly.', 'error');
                }
            });

            // NEW: Withdraw Investment Button Listener
            withdrawInvestmentButton.addEventListener('click', () => {
                hideAllFunctionalPanels();
                renderInvestmentsForWithdrawal(); // Populate the list
                withdrawInvestmentPanel.classList.remove('hidden');
            });

            // NEW: Close Withdraw Investment Panel Listener
            closeWithdrawInvestmentPanelButton.addEventListener('click', () => {
                withdrawInvestmentPanel.classList.add('hidden');
            });

            historyButton.addEventListener('click', () => {
                hideAllFunctionalPanels(); // Hide others before showing this one
                renderTransactionHistory();
                historyPanel.classList.remove('hidden'); // Show the history panel
            });

            closeHistoryPanelButton.addEventListener('click', () => {
                historyPanel.classList.add('hidden'); // Hide the history panel
            });
            
            logoutButton.addEventListener('click', () => {
                loggedInUsername = null;
                localStorage.removeItem('loggedInUser');
                currentUserData = { username: "Investor", userBalance: 0.00, investments: [], transactions: [], pendingDeposits: [], pendingWithdrawals: [] }; 
                showHomePage();
            });

            investButtons.forEach(button => {
                button.addEventListener('click', (event) => {
                    const btn = event.target;
                    setButtonProcessingState(btn, true);

                    setTimeout(() => {
                        const planName = btn.dataset.planName;
                        const minInvestment = parseFloat(btn.dataset.minInvestment);
                        const termDays = parseInt(btn.dataset.termDays); // For Mega Oil Prospector Plan
                        const profitAmount = parseFloat(btn.dataset.profitAmount); // For Mega Oil Prospector Plan

                        const newInvestmentId = 'inv_' + Date.now() + Math.random().toString(36).substring(2, 9);

                        if (currentUserData.userBalance >= minInvestment) {
                            currentUserData.userBalance -= minInvestment;
                            
                            let newInvestment;
                            if (planName === "Rapid Growth Plan") {
                                newInvestment = {
                                    id: newInvestmentId,
                                    planType: planName,
                                    name: `${planName} #${currentUserData.investments.filter(inv => inv.planType === planName).length + 1}`,
                                    initialAmount: minInvestment,
                                    currentValue: minInvestment,
                                    startDate: new Date().toISOString(),
                                    lastGrowthAppliedDate: new Date().toISOString(),
                                    dailyAdditionAmount: RAPID_GROWTH_DAILY_ADDITION,
                                    targetAmount: RAPID_GROWTH_TARGET_AMOUNT,
                                    status: 'active'
                                };
                            } else if (planName === "Quick Return Plan") {
                                newInvestment = {
                                    id: newInvestmentId,
                                    planType: planName,
                                    name: `${planName} #${currentUserData.investments.filter(inv => inv.planType === planName).length + 1}`,
                                    initialAmount: minInvestment,
                                    currentValue: minInvestment,
                                    startDate: new Date().toISOString(),
                                    lastGrowthAppliedDate: new Date().toISOString(),
                                    dailyAdditionAmount: QUICK_RETURN_DAILY_ADDITION,
                                    targetAmount: QUICK_RETURN_TARGET_AMOUNT,
                                    status: 'active'
                                };
                            } else if (planName === "Mega Oil Prospector Plan") { // New plan logic
                                const startDate = new Date();
                                const maturityDate = new Date();
                                maturityDate.setDate(startDate.getDate() + termDays); // Calculate maturity date
                                newInvestment = {
                                    id: newInvestmentId,
                                    planType: planName,
                                    name: `${planName} #${currentUserData.investments.filter(inv => inv.planType === planName).length + 1}`,
                                    initialAmount: minInvestment,
                                    currentValue: minInvestment, // Starts at initial, grows to target upon maturity
                                    startDate: startDate.toISOString(),
                                    maturityDate: maturityDate.toISOString(),
                                    targetAmount: minInvestment + profitAmount, // Initial + profit
                                    status: 'active'
                                };
                            }
                            else { // Steady Income Plan and Long-Term Growth Plan
                                newInvestment = {
                                    id: newInvestmentId,
                                    planType: planName,
                                    name: `${planName} #${currentUserData.investments.filter(inv => inv.planType === planName).length + 1}`,
                                    initialAmount: minInvestment,
                                    currentValue: minInvestment, // For these, currentValue remains initialAmount as profit is not accumulated daily here
                                    startDate: new Date().toISOString(),
                                    status: 'active',
                                };
                            }
                            currentUserData.investments.push(newInvestment);
                            
                            recordTransaction('investmentBuy', minInvestment, `Invested in ${newInvestment.name}`);
                            saveCurrentUserData();
                            updateBalanceDisplay();
                            updateTotalInvestmentValueDisplay(); 
                            renderInvestments();
                            
                            showDashboardStatusMessage(`Successfully invested ₦${minInvestment.toLocaleString('en-NG')} in "${planName}"! Your investment has started.`, 'success');

                        } else {
                            showDashboardStatusMessage(`Insufficient liquid balance to invest in "${planName}". You need ₦${minInvestment.toLocaleString('en-NG')}.`, 'error');
                        }
                        setButtonProcessingState(btn, false);
                    }, PROCESS_DELAY_MS);
                });
            });

            // Event Listeners for hiding errors on input
            loginUsernameInput.addEventListener('input', () => { loginUsernameError.classList.add('hidden'); loginUsernameInput.classList.remove('border-red-500'); showLoginStatusMessage('', 'hidden'); });
            loginPasswordInput.addEventListener('input', () => { loginPasswordError.classList.add('hidden'); loginPasswordInput.classList.remove('border-red-500'); showLoginStatusMessage('', 'hidden'); });

            signupUsernameInput.addEventListener('input', () => { signupUsernameError.classList.add('hidden'); signupUsernameInput.classList.remove('border-red-500'); showSignupStatusMessage('', 'hidden'); }); // For username input
            signupPhoneInput.addEventListener('input', () => { signupPhoneError.classList.add('hidden'); signupPhoneInput.classList.remove('border-red-500'); showSignupStatusMessage('', 'hidden'); });
            signupEmailInput.addEventListener('input', () => { signupEmailError.classList.add('hidden'); signupEmailInput.classList.remove('border-red-500'); showSignupStatusMessage('', 'hidden'); });
            signupPasswordInput.addEventListener('input', () => { signupPasswordError.classList.add('hidden'); signupPasswordInput.classList.remove('border-red-500'); showSignupStatusMessage('', 'hidden'); });

            depositAmountInput.addEventListener('input', hideAllDepositErrors);
            senderAccountNameInput.addEventListener('input', hideAllDepositErrors); // NEW
            senderBankNameInput.addEventListener('input', hideAllDepositErrors); // NEW
            transferAccountNumberInput.addEventListener('input', hideAllDepositErrors);
            depositReceiptInput.addEventListener('change', hideAllDepositErrors); // NEW

            withdrawAmountInput.addEventListener('input', hideAllWithdrawalErrors);
            bankAccountNameInput.addEventListener('input', hideAllWithdrawalErrors);
            bankAccountNumberInput.addEventListener('input', hideAllWithdrawalErrors);
            bankNameInput.addEventListener('input', hideAllWithdrawalErrors);


            // Intersection Observer for scroll animations
            const observer = new IntersectionObserver((entries, observer) => {
                entries.forEach(entry => {
                    if (entry.isIntersecting) {
                        entry.target.classList.add('is-visible');
                        observer.unobserve(entry.target); // Stop observing once visible
                    }
                });
            }, {
                root: null, // viewport as root
                rootMargin: '0px',
                threshold: 0.1 // Trigger when 10% of the item is visible
            });

            document.querySelectorAll('.animate-on-scroll').forEach(element => {
                observer.observe(element);
            });

            // Re-apply animations if already in view on page load (e.g., for dashboard elements)
            document.querySelectorAll('.animate-on-scroll').forEach(element => {
                if (element.getBoundingClientRect().top < window.innerHeight) {
                    element.classList.add('is-visible');
                }
            });
        });
    </script>
</body>
</html>
