<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Earn Passive Income in Nigeria - PassiveNaira</title>
    <!-- Tailwind CSS CDN -->
    <script src="https://cdn.tailwindcss.com"></script>
    <!-- Google Fonts - Inter -->
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700&display=swap" rel="stylesheet">
    <style>
        body {
            font-family: 'Inter', sans-serif;
            background-color: #f8f9fa; /* Light background */
            color: #343a40; /* Dark text */
        }
        /* Custom scrollbar for better aesthetics */
        ::-webkit-scrollbar {
            width: 8px;
            height: 8px;
        }
        ::-webkit-scrollbar-track {
            background: #e2e8f0;
            border-radius: 10px;
        }
        ::-webkit-scrollbar-thumb {
            background: #3b82f6;
            border-radius: 10px;
        }
        ::-webkit-scrollbar-thumb:hover {
            background: #2563eb;
        }
        /* Styling for the modal/message box */
        .modal-overlay {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background-color: rgba(0, 0, 0, 0.6); /* Semi-transparent black overlay */
            display: flex;
            justify-content: center;
            align-items: center;
            z-index: 1000; /* Ensure it's on top of other content */
            opacity: 0; /* Initially hidden */
            visibility: hidden; /* Initially hidden */
            transition: opacity 0.3s ease-in-out, visibility 0.3s ease-in-out;
        }
        .modal-overlay.active {
            opacity: 1;
            visibility: visible;
        }
        .modal-content {
            background-color: white;
            padding: 2.5rem; /* Increased padding */
            border-radius: 1rem; /* More rounded corners */
            box-shadow: 0 10px 25px rgba(0, 0, 0, 0.2); /* Stronger shadow */
            max-width: 90%;
            width: 450px; /* Fixed width for larger screens */
            text-align: center;
            position: relative;
            transform: translateY(-20px); /* Slightly move up for animation */
            transition: transform 0.3s ease-in-out;
        }
        .modal-overlay.active .modal-content {
            transform: translateY(0); /* Animate into place */
        }
        .close-button {
            position: absolute;
            top: 1rem;
            right: 1rem;
            background: none;
            border: none;
            font-size: 1.8rem; /* Larger close button */
            font-weight: bold;
            color: #6b7280; /* Gray color */
            cursor: pointer;
            line-height: 1;
            padding: 0.5rem; /* Add padding for easier clicking */
            border-radius: 50%; /* Make it circular */
            transition: background-color 0.2s, color 0.2s;
        }
        .close-button:hover {
            background-color: #f3f4f6;
            color: #1f2937;
        }
        .video-container {
            position: relative;
            width: 100%;
            padding-bottom: 56.25%; /* 16:9 aspect ratio */
            height: 0;
            overflow: hidden;
            border-radius: 0.75rem;
            box-shadow: 0 4px 10px rgba(0, 0, 0, 0.1);
        }
        .video-container iframe {
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
        }
    </style>
</head>
<body class="antialiased">
    <div id="main-content" class="min-h-screen flex flex-col items-center">
        <!-- Original Landing Page Content (will be replaced by dashboard on login) -->
        <header class="w-full bg-white shadow-sm py-4 px-6 md:px-12 flex justify-between items-center rounded-b-xl">
            <div class="text-2xl font-bold text-blue-600">
                PassiveNaira
            </div>
            <nav class="hidden md:flex space-x-6">
                <a href="#how-it-works" class="text-gray-700 hover:text-blue-600 font-medium transition-colors duration-200">How It Works</a>
                <a href="#passive-income" class="text-gray-700 hover:text-blue-600 font-medium transition-colors duration-200">Passive Income</a>
                <a href="#benefits" class="text-gray-700 hover:text-blue-600 font-medium transition-colors duration-200">Why Us</a>
                <a href="#" id="signup-nav-link" class="text-gray-700 hover:text-blue-600 font-medium transition-colors duration-200">Sign Up / Login</a>
            </nav>
            <button class="md:hidden bg-blue-500 text-white py-2 px-4 rounded-lg shadow hover:bg-blue-600 transition-colors duration-200">Menu</button>
        </header>

        <section class="w-full bg-gradient-to-r from-blue-600 to-indigo-700 text-white py-20 px-6 md:px-12 text-center rounded-b-xl shadow-lg mt-4">
            <h1 class="text-4xl md:text-5xl lg:text-6xl font-extrabold leading-tight mb-6">
                Unlock Your Earning Potential in Nigeria
            </h1>
            <p class="text-lg md:text-xl mb-8 max-w-3xl mx-auto">
                Start making passive income today by simply sharing links and watching videos from the comfort of your home. We make it easy and rewarding!
            </p>
            <a href="#" id="hero-signup-button" class="inline-block bg-white text-blue-700 font-bold py-3 px-8 rounded-full shadow-lg hover:bg-blue-100 hover:scale-105 transition-all duration-300 transform">
                Get Started Now
            </a>
        </section>

        <section id="how-it-works" class="w-full py-16 px-6 md:px-12 bg-white text-center rounded-xl shadow-md mt-8 max-w-7xl mx-auto">
            <h2 class="text-3xl md:text-4xl font-bold text-gray-800 mb-12">How It Works: Simple Steps to Earn</h2>
            <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-10">
                <div class="bg-gray-50 p-8 rounded-xl shadow-lg hover:shadow-xl transition-shadow duration-300 transform hover:-translate-y-2">
                    <div class="text-blue-500 text-5xl mb-4">üîó</div>
                    <h3 class="text-2xl font-semibold text-gray-700 mb-4">1. Share Links</h3>
                    <p class="text-gray-600 leading-relaxed">
                        Get unique referral links for products, services, or articles. Share them with your network on social media, WhatsApp, or any platform. Earn for every click or conversion!
                    </p>
                </div>
                <div class="bg-gray-50 p-8 rounded-xl shadow-lg hover:shadow-xl transition-shadow duration-300 transform hover:-translate-y-2">
                    <div class="text-green-500 text-5xl mb-4">üì∫</div>
                    <h3 class="text-2xl font-semibold text-gray-700 mb-4">2. Watch Videos</h3>
                    <p class="text-gray-600 leading-relaxed">
                        Access a curated list of short videos. Watch them at your convenience and accumulate earnings. It's an effortless way to make money during your free time.
                    </p>
                </div>
                <div class="bg-gray-50 p-8 rounded-xl shadow-lg hover:shadow-xl transition-shadow duration-300 transform hover:-translate-y-2">
                    <div class="text-yellow-500 text-5xl mb-4">üí∞</div>
                    <h3 class="text-2xl font-semibold text-gray-700 mb-4">3. Get Paid</h3>
                    <p class="text-gray-600 leading-relaxed">
                        Track your earnings in real-time on your dashboard. Withdraw your money directly to your Nigerian bank account or other supported payment methods.
                    </p>
                </div>
            </div>
        </section>

        <section id="passive-income" class="w-full py-16 px-6 md:px-12 bg-blue-50 text-center rounded-xl shadow-md mt-8 max-w-7xl mx-auto">
            <h2 class="text-3xl md:text-4xl font-bold text-gray-800 mb-12">How We Help You Build Passive Income in Nigeria</h2>
            <div class="grid grid-cols-1 lg:grid-cols-2 gap-10 text-left">
                <div class="bg-white p-8 rounded-xl shadow-lg hover:shadow-xl transition-shadow duration-300">
                    <h3 class="text-2xl font-semibold text-blue-600 mb-4 flex items-center"><span class="mr-3 text-3xl">üí°</span>Smart Link Monetization</h3>
                    <p class="text-gray-700 leading-relaxed">
                        We provide cutting-edge tools to maximize your earnings from link sharing. Our system identifies high-converting offers tailored for the Nigerian market, ensuring you get the best returns without constant effort. Once a link is shared, it continues to generate income as long as it's active.
                    </p>
                </div>
                <div class="bg-white p-8 rounded-xl shadow-lg hover:shadow-xl transition-shadow duration-300">
                    <h3 class="text-2xl font-semibold text-blue-600 mb-4 flex items-center"><span class="mr-3 text-3xl">üîÑ</span>Automated Video Earnings</h3>
                    <p class="text-gray-700 leading-relaxed">
                        Our platform features an intelligent system that streams videos relevant to your profile and interests. You can set it up to auto-play videos in the background, making it truly passive. Earn while you work, sleep, or do other activities.
                    </p>
                </div>
                <div class="bg-white p-8 rounded-xl shadow-lg hover:shadow-xl transition-shadow duration-300">
                    <h3 class="text-2xl font-semibold text-blue-600 mb-4 flex items-center"><span class="mr-3 text-3xl">üá≥üá¨</span>Tailored for Nigeria</h3>
                    <p class="text-gray-700 leading-relaxed">
                        We understand the Nigerian market. Our platform offers local payment options, relevant content, and support designed specifically for users in Nigeria, ensuring a seamless earning experience.
                    </p>
                </div>
                <div class="bg-white p-8 rounded-xl shadow-lg hover:shadow-xl transition-shadow duration-300">
                    <h3 class="text-2xl font-semibold text-blue-600 mb-4 flex items-center"><span class="mr-3 text-3xl">üìà</span>Referral Programs & Tiers</h3>
                    <p class="text-gray-700 leading-relaxed">
                        Beyond direct earnings, our multi-level referral program allows you to build a team and earn a percentage of their activities, creating a true passive income stream that grows with your network. The more people you invite, the more you earn passively.
                    </p>
                </div>
            </div>
        </section>

        <section id="benefits" class="w-full py-16 px-6 md:px-12 bg-white text-center rounded-xl shadow-md mt-8 max-w-7xl mx-auto">
            <h2 class="text-3xl md:text-4xl font-bold text-gray-800 mb-12">Why Choose PassiveNaira?</h2>
            <div class="grid grid-cols-1 md:grid-cols-2 gap-10">
                <div class="bg-blue-50 p-8 rounded-xl shadow-lg hover:shadow-xl transition-shadow duration-300 flex items-start text-left">
                    <div class="text-blue-500 text-4xl mr-6">‚úÖ</div>
                    <div>
                        <h3 class="text-2xl font-semibold text-gray-700 mb-3">Guaranteed Payouts</h3>
                        <p class="text-gray-600">
                            We ensure timely and secure payments directly to your Nigerian bank account. Your earnings are safe with us.
                        </p>
                    </div>
                </div>
                <div class="bg-blue-50 p-8 rounded-xl shadow-lg hover:shadow-xl transition-shadow duration-300 flex items-start text-left">
                    <div class="text-blue-500 text-4xl mr-6">üöÄ</div>
                    <div>
                        <h3 class="text-2xl font-semibold text-gray-700 mb-3">Easy to Start</h3>
                        <p class="text-gray-600">
                            No prior experience needed. Our user-friendly platform makes it simple for anyone to begin earning immediately.
                        </p>
                    </p>
                </div>
                <div class="bg-blue-50 p-8 rounded-xl shadow-lg hover:shadow-xl transition-shadow duration-300 flex items-start text-left">
                    <div class="text-blue-500 text-4xl mr-6">üåê</div>
                    <div>
                        <h3 class="text-2xl font-semibold text-gray-700 mb-3">Flexible & Remote</h3>
                        <p class="text-gray-600">
                            Work from anywhere, anytime. All you need is an internet connection and a device to start earning.
                        </p>
                    </div>
                </div>
                <div class="bg-blue-50 p-8 rounded-xl shadow-lg hover:shadow-xl transition-shadow duration-300 flex items-start text-left">
                    <div class="text-blue-500 text-4xl mr-6">ü§ù</div>
                    <div>
                        <h3 class="text-2xl font-semibold text-gray-700 mb-3">Dedicated Support</h3>
                        <p class="text-gray-600">
                            Our support team is always ready to assist you with any questions or issues you might encounter.
                        </p>
                    </div>
                </div>
            </div>
        </section>

        <section id="join-us" class="w-full bg-gradient-to-r from-green-500 to-teal-600 text-white py-20 px-6 md:px-12 text-center rounded-xl shadow-lg mt-8 mb-8 max-w-7xl mx-auto">
            <h2 class="text-3xl md:text-4xl lg:text-5xl font-extrabold leading-tight mb-6">
                Ready to Boost Your Income?
            </h2>
            <p class="text-lg md:text-xl mb-8 max-w-3xl mx-auto">
                Join thousands of Nigerians already earning passive income. Sign up today and transform your free time into profit!
            </p>
            <a href="#" id="footer-signup-button" class="inline-block bg-white text-green-700 font-bold py-3 px-8 rounded-full shadow-lg hover:bg-green-100 hover:scale-105 transition-all duration-300 transform">
                Sign Up for Free!
            </a>
            <p class="text-sm mt-4 opacity-80">No hidden fees, no complex requirements.</p>
        </section>

        <footer class="w-full bg-gray-800 text-white py-8 px-6 md:px-12 text-center rounded-t-xl">
            <p>&copy; 2025 PassiveNaira. All rights reserved.</p>
            <div class="flex justify-center space-x-6 mt-4">
                <a href="#" class="text-gray-400 hover:text-white transition-colors duration-200">Privacy Policy</a>
                <a href="#" class="text-gray-400 hover:text-white transition-colors duration-200">Terms of Service</a>
                <a href="#" id="contact-us-link" class="text-gray-400 hover:text-white transition-colors duration-200">Contact Us</a>
            </div>
        </footer>
    </div>

    <!-- Generic Modal for Contact/Signup/Login/Withdrawal -->
    <div id="app-modal" class="modal-overlay">
        <div class="modal-content">
            <button class="close-button" id="close-app-modal-button">&times;</button>
            <div id="modal-body">
                <!-- Content will be injected here by JavaScript -->
            </div>
        </div>
    </div>

    <script>
        // --- Global Variables & Constants ---
        const mainContentDiv = document.getElementById('main-content');
        const appModal = document.getElementById('app-modal');
        const closeModalButton = document.getElementById('close-app-modal-button');
        const modalBody = document.getElementById('modal-body');

        const contactLink = document.getElementById('contact-us-link');
        const signupNavLink = document.getElementById('signup-nav-link');
        const heroSignupButton = document.getElementById('hero-signup-button');
        const footerSignupButton = document.getElementById('footer-signup-button');

        // Video list with only IDs (titles will not be displayed as requested)
        const videoList = [
            { id: 'Hcs3Ogbs2Po' },
            { id: 'QUA2qooo4uU' },
            { id: 'SrRhFdyBWEc' },
            { id: 'TTxTS8RWKIs' }
        ];

        // TikTokers list with ID, name, and link
        const tiktokersList = [
            { id: 'godswillelvis', name: 'Godswill Elvis', link: 'https://www.tiktok.com/@godswillelvis?_t=ZM-8xSBrtqpXCH&_r=1' }
        ];

        // YouTube Channels list
        const youtubeChannelsList = [
            { id: 'PungyStudio', name: 'Pungy Studio', link: 'https://www.youtube.com/@PungyStudio' }
        ];

        const MIN_WITHDRAWAL_AMOUNT = 30000; // NGN 30,000

        let playerIntervals = {}; // To store interval IDs for each video player
        let youtubePlayers = {}; // To store YT.Player objects

        // --- YouTube Iframe Player API Loading ---
        let youtubeAPIReady = false;

        // This function will be called when the API is ready
        window.onYouTubeIframeAPIReady = function() {
            youtubeAPIReady = true;
            console.log('YouTube Iframe API is ready.');
            // If dashboard is already shown, initialize players
            if (localStorage.getItem('userEmail')) {
                const earnedVideosStatus = JSON.parse(localStorage.getItem('earnedVideosStatus') || '{}');
                const availableVideos = videoList.filter(video => !earnedVideosStatus[video.id]);
                initializeVideoPlayers(availableVideos);
            }
        };

        // Load the IFrame Player API code asynchronously.
        const tag = document.createElement('script');
        tag.src = "https://www.youtube.com/iframe_api";
        const firstScriptTag = document.getElementsByTagName('script')[0];
        firstScriptTag.parentNode.insertBefore(tag, firstScriptTag);


        // --- Modal Control Functions ---
        function showModal() {
            appModal.classList.add('active');
        }

        function hideModal() {
            appModal.classList.remove('active');
            modalBody.innerHTML = ''; // Clear content
        }

        // --- Custom Alert/Message Box Function (replaces native alert) ---
        function alertUser(message) {
            modalBody.innerHTML = `
                <h3 class="text-2xl font-bold text-gray-800 mb-4">Notification</h3>
                <p class="text-gray-700 text-lg mb-6">${message}</p>
                <button onclick="hideModal()" class="bg-blue-600 text-white font-bold py-2 px-6 rounded-lg hover:bg-blue-700 transition-colors duration-200">
                    OK
                </button>
            `;
            showModal();
        }

        // --- Signup Form Content ---
        function showSignupForm(message = '') {
            modalBody.innerHTML = `
                <h3 class="text-2xl font-bold text-gray-800 mb-6">Create Your Account</h3>
                ${message ? `<p class="text-red-500 mb-4">${message}</p>` : ''}
                <form id="signup-form" class="space-y-4">
                    <div>
                        <input type="email" id="signup-email" placeholder="Email Address"
                               class="w-full px-4 py-3 rounded-lg border border-gray-300 focus:outline-none focus:ring-2 focus:ring-blue-500" required>
                    </div>
                    <div>
                        <input type="password" id="signup-password" placeholder="Password"
                               class="w-full px-4 py-3 rounded-lg border border-gray-300 focus:outline-none focus:ring-2 focus:ring-blue-500" required>
                    </div>
                    <button type="submit"
                            class="w-full bg-blue-600 text-white font-bold py-3 px-4 rounded-lg shadow-md hover:bg-blue-700 transition-colors duration-200">
                        Create Account
                    </button>
                </form>
                <p class="mt-6 text-gray-600">Already have an account? <a href="#" id="show-login-link" class="text-blue-600 hover:underline font-semibold">Login here</a></p>
            `;
            showModal();

            document.getElementById('signup-form').addEventListener('submit', handleSignup);
            document.getElementById('show-login-link').addEventListener('click', (event) => {
                event.preventDefault();
                showLoginForm();
            });
        }

        // --- Login Form Content ---
        function showLoginForm(message = '') {
            modalBody.innerHTML = `
                <h3 class="text-2xl font-bold text-gray-800 mb-6">Login to Your Account</h3>
                ${message ? `<p class="text-red-500 mb-4">${message}</p>` : ''}
                <form id="login-form" class="space-y-4">
                    <div>
                        <input type="email" id="login-email" placeholder="Email Address"
                               class="w-full px-4 py-3 rounded-lg border border-gray-300 focus:outline-none focus:ring-2 focus:ring-blue-500" required>
                    </div>
                    <div>
                        <input type="password" id="login-password" placeholder="Password"
                               class="w-full px-4 py-3 rounded-lg border border-gray-300 focus:outline-none focus:ring-2 focus:ring-blue-500" required>
                    </div>
                    <button type="submit"
                            class="w-full bg-green-600 text-white font-bold py-3 px-4 rounded-lg shadow-md hover:bg-green-700 transition-colors duration-200">
                        Login
                    </button>
                </form>
                <p class="mt-6 text-gray-600">Don't have an account? <a href="#" id="show-signup-link" class="text-blue-600 hover:underline font-semibold">Sign Up here</a></p>
            `;
            showModal();

            document.getElementById('login-form').addEventListener('submit', handleLogin);
            document.getElementById('show-signup-link').addEventListener('click', (event) => {
                event.preventDefault();
                showSignupForm();
            });
        }

        // --- Withdrawal Modal Content ---
        function showWithdrawModal(message = '') {
            modalBody.innerHTML = `
                <h3 class="text-2xl font-bold text-gray-800 mb-6">Withdraw Your Earnings</h3>
                ${message ? `<p class="text-red-500 mb-4">${message}</p>` : ''}
                <form id="withdraw-form" class="space-y-4">
                    <div>
                        <input type="number" id="withdraw-amount" placeholder="Amount to Withdraw (‚Ç¶)"
                               class="w-full px-4 py-3 rounded-lg border border-gray-300 focus:outline-none focus:ring-2 focus:ring-blue-500" min="100" required>
                    </div>
                    <div>
                        <input type="text" id="account-number" placeholder="Account Number"
                               class="w-full px-4 py-3 rounded-lg border border-gray-300 focus:outline-none focus:ring-2 focus:ring-blue-500" required>
                    </div>
                    <div>
                        <input type="text" id="account-name" placeholder="Account Name"
                               class="w-full px-4 py-3 rounded-lg border border-gray-300 focus:outline-none focus:ring-2 focus:ring-blue-500" required>
                    </div>
                    <div>
                        <input type="text" id="bank-name" placeholder="Bank Name"
                               class="w-full px-4 py-3 rounded-lg border border-gray-300 focus:outline-none focus:ring-2 focus:ring-blue-500" required>
                    </div>
                    <button type="submit"
                            class="w-full bg-purple-600 text-white font-bold py-3 px-4 rounded-lg shadow-md hover:bg-purple-700 transition-colors duration-200">
                        Submit Withdrawal Request
                    </button>
                </form>
            `;
            showModal();

            document.getElementById('withdraw-form').addEventListener('submit', handleWithdrawalRequest);
        }

        // --- Invest Modal Content ---
        function showInvestModal(message = '') {
            let currentBalance = parseFloat(localStorage.getItem('currentBalance') || '0.00');
            modalBody.innerHTML = `
                <h3 class="text-2xl font-bold text-gray-800 mb-6">Invest Your Funds</h3>
                ${message ? `<p class="text-red-500 mb-4">${message}</p>` : ''}
                <p class="text-gray-700 mb-4">Current Liquid Balance: ‚Ç¶${currentBalance.toFixed(2)}</p>
                <form id="invest-form" class="space-y-4">
                    <div>
                        <input type="number" id="invest-amount" placeholder="Amount to Invest (‚Ç¶)"
                               class="w-full px-4 py-3 rounded-lg border border-gray-300 focus:outline-none focus:ring-2 focus:ring-blue-500" min="100" required>
                    </div>
                    <button type="submit"
                            class="w-full bg-blue-600 text-white font-bold py-3 px-4 rounded-lg shadow-md hover:bg-blue-700 transition-colors duration-200">
                        Invest Now
                    </button>
                </form>
            `;
            showModal();
            document.getElementById('invest-form').addEventListener('submit', handleInvest);
        }

        // --- Withdraw Investment Modal Content ---
        function showWithdrawInvestmentModal(message = '') {
            let investedBalance = parseFloat(localStorage.getItem('investedBalance') || '0.00');
            modalBody.innerHTML = `
                <h3 class="text-2xl font-bold text-gray-800 mb-6">Withdraw Investment</h3>
                ${message ? `<p class="text-red-500 mb-4">${message}</p>` : ''}
                <p class="text-gray-700 mb-4">Current Invested Balance: ‚Ç¶${investedBalance.toFixed(2)}</p>
                <form id="withdraw-investment-form" class="space-y-4">
                    <div>
                        <input type="number" id="withdraw-invest-amount" placeholder="Amount to Withdraw (‚Ç¶)"
                               class="w-full px-4 py-3 rounded-lg border border-gray-300 focus:outline-none focus:ring-2 focus:ring-blue-500" min="100" required>
                    </div>
                    <button type="submit"
                            class="w-full bg-red-600 text-white font-bold py-3 px-4 rounded-lg shadow-md hover:bg-red-700 transition-colors duration-200">
                        Withdraw from Investment
                    </button>
                </form>
            `;
            showModal();
            document.getElementById('withdraw-investment-form').addEventListener('submit', handleWithdrawInvestment);
        }

        // --- Handle Signup Logic ---
        function handleSignup(event) {
            event.preventDefault();

            const email = document.getElementById('signup-email').value;
            const password = document.getElementById('signup-password').value;

            if (!email || !password) {
                showSignupForm('Please fill in both email and password.');
                return;
            }

            localStorage.setItem('userEmail', email);
            localStorage.setItem('userPassword', password);
            localStorage.setItem('currentBalance', '0.00');
            localStorage.setItem('investedBalance', '0.00'); // Initialize invested balance
            localStorage.setItem('videosEarnedCount', '0');
            localStorage.setItem('linkFollowsEarnedCount', '0');
            localStorage.setItem('earnedVideosStatus', JSON.stringify({}));
            localStorage.setItem('earnedTikTokersStatus', JSON.stringify({}));
            localStorage.setItem('earnedYouTubeChannelsStatus', JSON.stringify({}));
            localStorage.setItem('withdrawalHistory', JSON.stringify([]));

            hideModal();
            setTimeout(() => {
                showLoginForm('Account created successfully! Please login.');
            }, 300);
        }

        // --- Handle Login Logic ---
        function handleLogin(event) {
            event.preventDefault();

            const email = document.getElementById('login-email').value;
            const password = document.getElementById('login-password').value;

            const storedEmail = localStorage.getItem('userEmail');
            const storedPassword = localStorage.getItem('userPassword');

            if (email === storedEmail && password === storedPassword && storedEmail && storedPassword) {
                hideModal();
                showDashboard(email);
            } else {
                showLoginForm('Invalid email or password. Please try again.');
            }
        }

        // --- Handle Withdrawal Request Logic ---
        function handleWithdrawalRequest(event) {
            event.preventDefault();

            const amount = parseFloat(document.getElementById('withdraw-amount').value);
            const accountNumber = document.getElementById('account-number').value;
            const accountName = document.getElementById('account-name').value;
            const bankName = document.getElementById('bank-name').value;

            if (isNaN(amount) || amount <= 0 || !accountNumber || !accountName || !bankName) {
                showWithdrawModal('Please fill in all fields correctly. Amount must be a positive number.');
                return;
            }

            if (amount < MIN_WITHDRAWAL_AMOUNT) {
                showWithdrawModal(`Minimum withdrawal amount is ‚Ç¶${MIN_WITHDRAWAL_AMOUNT.toLocaleString()}. You tried to withdraw ‚Ç¶${amount.toLocaleString()}.`);
                return;
            }

            let currentBalance = parseFloat(localStorage.getItem('currentBalance') || '0.00');

            if (amount > currentBalance) {
                showWithdrawModal(`Insufficient liquid balance. Your current liquid balance is ‚Ç¶${currentBalance.toFixed(2)}.`);
                return;
            }

            // Deduct amount from balance
            currentBalance -= amount;
            localStorage.setItem('currentBalance', currentBalance.toFixed(2));

            const storedHistory = JSON.parse(localStorage.getItem('withdrawalHistory')) || [];

            const newRequest = {
                id: Date.now(),
                date: new Date().toLocaleDateString('en-NG'),
                amount: amount.toFixed(2),
                accountNumber: accountNumber,
                accountName: accountName,
                bankName: bankName,
                status: 'Pending'
            };

            storedHistory.unshift(newRequest);

            localStorage.setItem('withdrawalHistory', JSON.stringify(storedHistory));

            hideModal();
            updateBalanceDisplay();
            renderWithdrawalHistory();
            setTimeout(() => {
                alertUser('Withdrawal request submitted successfully!');
            }, 300);
        }

        // --- Handle Invest Logic ---
        function handleInvest(event) {
            event.preventDefault();
            const investAmount = parseFloat(document.getElementById('invest-amount').value);

            if (isNaN(investAmount) || investAmount <= 0) {
                showInvestModal('Please enter a positive amount to invest.');
                return;
            }

            let currentBalance = parseFloat(localStorage.getItem('currentBalance') || '0.00');
            let investedBalance = parseFloat(localStorage.getItem('investedBalance') || '0.00');

            if (investAmount > currentBalance) {
                showInvestModal(`Insufficient liquid balance. You only have ‚Ç¶${currentBalance.toFixed(2)} available.`);
                return;
            }

            currentBalance -= investAmount;
            investedBalance += investAmount;

            localStorage.setItem('currentBalance', currentBalance.toFixed(2));
            localStorage.setItem('investedBalance', investedBalance.toFixed(2));

            hideModal();
            updateBalanceDisplay();
            updateInvestedBalanceDisplay();
            alertUser(`Successfully invested ‚Ç¶${investAmount.toFixed(2)}. Your invested balance is now ‚Ç¶${investedBalance.toFixed(2)}.`);
        }

        // --- Handle Withdraw Investment Logic ---
        function handleWithdrawInvestment(event) {
            event.preventDefault();
            const withdrawInvestAmount = parseFloat(document.getElementById('withdraw-invest-amount').value);

            if (isNaN(withdrawInvestAmount) || withdrawInvestAmount <= 0) {
                showWithdrawInvestmentModal('Please enter a positive amount to withdraw.');
                return;
            }

            let currentBalance = parseFloat(localStorage.getItem('currentBalance') || '0.00');
            let investedBalance = parseFloat(localStorage.getItem('investedBalance') || '0.00');

            if (withdrawInvestAmount > investedBalance) {
                showWithdrawInvestmentModal(`Insufficient invested balance. You only have ‚Ç¶${investedBalance.toFixed(2)} invested.`);
                return;
            }

            currentBalance += withdrawInvestAmount;
            investedBalance -= withdrawInvestAmount;

            localStorage.setItem('currentBalance', currentBalance.toFixed(2));
            localStorage.setItem('investedBalance', investedBalance.toFixed(2));

            hideModal();
            updateBalanceDisplay();
            updateInvestedBalanceDisplay();
            alertUser(`Successfully withdrew ‚Ç¶${withdrawInvestAmount.toFixed(2)} from investment. Your liquid balance is now ‚Ç¶${currentBalance.toFixed(2)}.`);
        }


        // --- Dashboard Content ---
        function showDashboard(email) {
            let currentBalance = parseFloat(localStorage.getItem('currentBalance') || '0.00');
            let investedBalance = parseFloat(localStorage.getItem('investedBalance') || '0.00'); // Get invested balance
            let videosEarnedCount = parseInt(localStorage.getItem('videosEarnedCount') || '0', 10);
            let linkFollowsEarnedCount = parseInt(localStorage.getItem('linkFollowsEarnedCount') || '0', 10);

            // Filter out videos that have already been earned from
            const earnedVideosStatus = JSON.parse(localStorage.getItem('earnedVideosStatus') || '{}');
            const availableVideos = videoList.filter(video => !earnedVideosStatus[video.id]);

            mainContentDiv.innerHTML = `
                <div class="min-h-screen flex flex-col items-center w-full">
                    <!-- Dashboard Header -->
                    <header class="w-full bg-blue-700 text-white shadow-lg py-4 px-6 md:px-12 flex justify-between items-center rounded-b-xl">
                        <div class="text-2xl font-bold">
                            PassiveNaira Dashboard
                        </div>
                        <nav class="flex space-x-4">
                            <span class="text-lg font-medium hidden md:block">Welcome, ${email}!</span>
                            <button id="logout-button" class="bg-red-500 hover:bg-red-600 text-white font-semibold py-2 px-4 rounded-lg shadow transition-colors duration-200">
                                Logout
                            </button>
                        </nav>
                    </header>

                    <div class="w-full max-w-6xl mx-auto p-6 md:p-8 lg:p-10 flex flex-col items-center">
                        <h1 class="text-4xl md:text-5xl font-extrabold text-gray-800 my-8 text-center">Your Earning Overview</h1>

                        <!-- Earning Cards -->
                        <div class="grid grid-cols-1 md:grid-cols-3 gap-6 w-full mb-12">
                            <div class="bg-white p-6 rounded-xl shadow-lg flex flex-col items-center justify-center transition-transform hover:scale-105 transform">
                                <span class="text-5xl mb-3 text-blue-600">üí∞</span>
                                <p class="text-xl font-semibold text-gray-700">Current Balance</p>
                                <p class="text-3xl font-bold text-green-700">‚Ç¶<span id="current-balance">${currentBalance.toFixed(2)}</span></p>
                            </div>
                            <div class="bg-white p-6 rounded-xl shadow-lg flex flex-col items-center justify-center transition-transform hover:scale-105 transform">
                                <span class="text-5xl mb-3 text-yellow-600">üìà</span>
                                <p class="text-xl font-semibold text-gray-700">Invested Balance</p>
                                <p class="text-3xl font-bold text-yellow-700">‚Ç¶<span id="invested-balance">${investedBalance.toFixed(2)}</span></p>
                            </div>
                            <div class="bg-white p-6 rounded-xl shadow-lg flex flex-col items-center justify-center transition-transform hover:scale-105 transform">
                                <span class="text-5xl mb-3 text-purple-600">üîó</span>
                                <p class="text-xl font-semibold text-gray-700">Link Follows Earned</p>
                                <p class="text-3xl font-bold text-gray-800" id="link-follows-earned-count">${linkFollowsEarnedCount}</p>
                            </div>
                            <div class="bg-white p-6 rounded-xl shadow-lg flex flex-col items-center justify-center transition-transform hover:scale-105 transform">
                                <span class="text-5xl mb-3 text-orange-600">üì∫</span>
                                <p class="text-xl font-semibold text-gray-700">Videos Earned</p>
                                <p class="text-3xl font-bold text-gray-800" id="videos-earned-count">${videosEarnedCount}</p>
                            </div>
                        </div>

                        <!-- Main Action Buttons -->
                        <div class="flex flex-col sm:flex-row gap-4 mb-12">
                            <button id="withdraw-button" class="bg-green-600 text-white font-bold py-3 px-10 rounded-full shadow-lg hover:bg-green-700 hover:scale-105 transition-all duration-300 transform text-xl">
                                Withdraw Earnings
                            </button>
                            <button id="invest-button" class="bg-blue-600 text-white font-bold py-3 px-10 rounded-full shadow-lg hover:bg-blue-700 hover:scale-105 transition-all duration-300 transform text-xl">
                                Invest Funds
                            </button>
                            <button id="withdraw-invest-button" class="bg-orange-600 text-white font-bold py-3 px-10 rounded-full shadow-lg hover:bg-orange-700 hover:scale-105 transition-all duration-300 transform text-xl">
                                Withdraw Investment
                            </button>
                        </div>

                        <!-- Watch & Earn Videos Section -->
                        <div class="w-full bg-white p-6 md:p-8 rounded-xl shadow-lg mb-12">
                            <h3 class="text-2xl font-bold text-gray-800 mb-6 text-center">Watch & Earn Videos</h3>
                            <p class="text-gray-600 text-center mb-6">Watch any video for at least 30 seconds to earn ‚Ç¶1000!</p>
                            ${availableVideos.length > 0 ? `
                                <div class="grid grid-cols-1 md:grid-cols-2 gap-8">
                                    ${availableVideos.map(video => `
                                        <div class="flex flex-col items-center bg-gray-50 p-4 rounded-lg shadow-md">
                                            <div class="video-container w-full mb-3">
                                                <div id="player-${video.id}"></div>
                                            </div>
                                            <span id="status-${video.id}" class="text-sm font-medium text-gray-500">Not watched yet</span>
                                        </div>
                                    `).join('')}
                                </div>
                            ` : `
                                <p class="text-center text-gray-500 mt-4">No more videos available to earn from. Check back later!</p>
                            `}
                        </div>

                        <!-- Follow & Earn Platforms Section -->
                        <div class="w-full bg-white p-6 md:p-8 rounded-xl shadow-lg mb-12">
                            <h3 class="text-2xl font-bold text-gray-800 mb-6 text-center">Follow & Earn on Social Media</h3>
                            <p class="text-gray-600 text-center mb-6">Follow these profiles to earn ‚Ç¶1000 per follow!</p>
                            <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-8">
                                <!-- TikTok Section -->
                                <div class="flex flex-col items-center bg-gray-50 p-4 rounded-lg shadow-md">
                                    <img src="https://placehold.co/60x60/FFD9D9/FF0000?text=TikTok" alt="TikTok Icon" class="w-16 h-16 mb-3 rounded-full shadow">
                                    <h4 class="text-lg font-semibold text-gray-700 mb-2">TikTok</h4>
                                    <div class="flex flex-col items-center gap-2 w-full">
                                        ${tiktokersList.map(tiktoker => `
                                            <div class="w-full flex flex-col items-center p-2 rounded-md bg-white shadow-sm">
                                                <p class="text-md font-medium text-gray-800 mb-2">@${tiktoker.name}</p>
                                                <button data-platform="tiktok" data-id="${tiktoker.id}"
                                                        class="follow-button w-full bg-pink-500 text-white font-semibold py-2 px-4 rounded-lg shadow hover:bg-pink-600 transition-colors duration-200">
                                                    Follow & Earn
                                                </button>
                                                <span id="follow-status-tiktok-${tiktoker.id}" class="text-sm font-medium text-gray-500 mt-2">Not followed yet</span>
                                            </div>
                                        `).join('')}
                                    </div>
                                </div>

                                <!-- YouTube Channels Section -->
                                <div class="flex flex-col items-center bg-gray-50 p-4 rounded-lg shadow-md">
                                    <img src="https://placehold.co/60x60/FFD9D9/FF0000?text=YouTube" alt="YouTube Icon" class="w-16 h-16 mb-3 rounded-full shadow">
                                    <h4 class="text-lg font-semibold text-gray-700 mb-2">YouTube Channels</h4>
                                    <div class="flex flex-col items-center gap-2 w-full">
                                        ${youtubeChannelsList.map(channel => `
                                            <div class="w-full flex flex-col items-center p-2 rounded-md bg-white shadow-sm">
                                                <p class="text-md font-medium text-gray-800 mb-2">@${channel.name}</p>
                                                <button data-platform="youtube" data-id="${channel.id}"
                                                        class="follow-button w-full bg-red-600 text-white font-semibold py-2 px-4 rounded-lg shadow hover:bg-red-700 transition-colors duration-200">
                                                    Follow & Earn
                                                </button>
                                                <span id="follow-status-youtube-${channel.id}" class="text-sm font-medium text-gray-500 mt-2">Not followed yet</span>
                                            </div>
                                        `).join('')}
                                    </div>
                                </div>

                                <!-- Add more platforms here if needed -->
                            </div>
                        </div>

                        <!-- Withdrawal History Section -->
                        <div class="w-full bg-white p-6 md:p-8 rounded-xl shadow-lg">
                            <h3 class="text-2xl font-bold text-gray-800 mb-6 text-center">Withdrawal History</h3>
                            <div id="withdrawal-history-table-container" class="overflow-x-auto">
                                <table class="min-w-full bg-white border border-gray-200 rounded-lg overflow-hidden">
                                    <thead class="bg-gray-100">
                                        <tr>
                                            <th class="py-3 px-4 text-left text-sm font-semibold text-gray-600 uppercase tracking-wider border-b">Date</th>
                                            <th class="py-3 px-4 text-left text-sm font-semibold text-gray-600 uppercase tracking-wider border-b">Amount (‚Ç¶)</th>
                                            <th class="py-3 px-4 text-left text-sm font-semibold text-gray-600 uppercase tracking-wider border-b">Bank</th>
                                            <th class="py-3 px-4 text-left text-sm font-semibold text-gray-600 uppercase tracking-wider border-b">Account No.</th>
                                            <th class="py-3 px-4 text-left text-sm font-semibold text-gray-600 uppercase tracking-wider border-b">Status</th>
                                        </tr>
                                    </thead>
                                    <tbody id="withdrawal-history-body">
                                        <!-- History items will be injected here by JavaScript -->
                                    </tbody>
                                </table>
                            </div>
                            <p id="no-withdrawals-message" class="text-center text-gray-500 mt-4 hidden">No withdrawal requests yet.</p>
                        </div>
                    </div>
                </div>
            `;

            // Add event listeners for dashboard elements
            document.getElementById('logout-button').addEventListener('click', () => {
                localStorage.removeItem('userEmail');
                localStorage.removeItem('userPassword');
                localStorage.removeItem('currentBalance');
                localStorage.removeItem('investedBalance'); // Clear invested balance on logout
                localStorage.removeItem('videosEarnedCount');
                localStorage.removeItem('linkFollowsEarnedCount');
                localStorage.removeItem('earnedVideosStatus');
                localStorage.removeItem('earnedTikTokersStatus');
                localStorage.removeItem('earnedYouTubeChannelsStatus');
                localStorage.removeItem('withdrawalHistory');
                location.reload();
            });

            document.getElementById('withdraw-button').addEventListener('click', showWithdrawModal);
            document.getElementById('invest-button').addEventListener('click', showInvestModal);
            document.getElementById('withdraw-invest-button').addEventListener('click', showWithdrawInvestmentModal);


            // Add event listeners for all follow buttons (TikTok and YouTube)
            document.querySelectorAll('.follow-button').forEach(button => {
                button.addEventListener('click', (event) => {
                    const platform = event.target.dataset.platform;
                    const id = event.target.dataset.id;
                    if (platform === 'tiktok') {
                        handleFollowTikTok(id);
                    } else if (platform === 'youtube') {
                        handleFollowYouTubeChannel(id);
                    }
                });
            });

            // Initialize YouTube Players for *available* videos if API is ready
            if (youtubeAPIReady) {
                initializeVideoPlayers(availableVideos); // Pass only available videos
            }

            // Update all dashboard displays
            renderWithdrawalHistory();
            updateBalanceDisplay();
            updateInvestedBalanceDisplay(); // Call new display function
            updateVideosEarnedDisplay();
            updateLinkFollowsEarnedDisplay();
            updateAllFollowStatuses(); // Call this to update all follow button states
        }

        // --- YouTube Player Initialization and Earning Logic ---
        // Modified to take `videosToRender` as an argument
        function initializeVideoPlayers(videosToRender = videoList) {
            // Clear any existing players/intervals to prevent issues on re-render
            for (const videoId in youtubePlayers) {
                if (youtubePlayers[videoId] && typeof youtubePlayers[videoId].destroy === 'function') {
                    youtubePlayers[videoId].destroy();
                }
            }
            youtubePlayers = {};
            for (const videoId in playerIntervals) {
                clearInterval(playerIntervals[videoId]);
            }
            playerIntervals = {};

            const earnedVideosStatus = JSON.parse(localStorage.getItem('earnedVideosStatus') || '{}');

            videosToRender.forEach(video => {
                const statusSpan = document.getElementById(`status-${video.id}`);
                if (earnedVideosStatus[video.id]) {
                    // This block should ideally not be hit if videos are filtered out, but good for robustness
                    if (statusSpan) {
                        statusSpan.textContent = 'Earned! ‚úÖ';
                        statusSpan.classList.add('text-green-600');
                        statusSpan.classList.remove('text-gray-500');
                    }
                } else {
                    if (statusSpan) {
                        statusSpan.textContent = 'Not watched yet';
                        statusSpan.classList.remove('text-green-600');
                        statusSpan.classList.add('text-gray-500');
                    }
                }

                youtubePlayers[video.id] = new YT.Player(`player-${video.id}`, {
                    height: '100%',
                    width: '100%',
                    videoId: video.id,
                    playerVars: {
                        'autoplay': 0,
                        'controls': 1,
                        'enablejsapi': 1,
                        'origin': window.location.origin
                    },
                    events: {
                        'onReady': onPlayerReady,
                        'onStateChange': onPlayerStateChange
                    }
                });
            });
        }

        function onPlayerReady(event) {
            console.log(`Player for ${event.target.getVideoData().video_id} is ready.`);
        }

        function onPlayerStateChange(event) {
            const videoId = event.target.getVideoData().video_id;
            let earnedVideosStatus = JSON.parse(localStorage.getItem('earnedVideosStatus') || '{}');
            const currentUserEmail = localStorage.getItem('userEmail'); // Get current user's email

            if (event.data === YT.PlayerState.PLAYING) {
                if (!earnedVideosStatus[videoId]) {
                    console.log(`Started playing video ${videoId}`);
                    if (playerIntervals[videoId]) {
                        clearInterval(playerIntervals[videoId]);
                    }

                    playerIntervals[videoId] = setInterval(() => {
                        const currentTime = event.target.getCurrentTime();
                        console.log(`Video ${videoId}: ${currentTime.toFixed(1)} seconds`);

                        if (currentTime >= 30 && !earnedVideosStatus[videoId]) {
                            clearInterval(playerIntervals[videoId]);
                            earnedVideosStatus[videoId] = true;
                            localStorage.setItem('earnedVideosStatus', JSON.stringify(earnedVideosStatus));

                            let currentBalance = parseFloat(localStorage.getItem('currentBalance') || '0.00');
                            currentBalance += 1000; // Add ‚Ç¶1000
                            localStorage.setItem('currentBalance', currentBalance.toFixed(2));
                            updateBalanceDisplay();

                            let videosEarnedCount = parseInt(localStorage.getItem('videosEarnedCount') || '0', 10);
                            videosEarnedCount += 1;
                            localStorage.setItem('videosEarnedCount', videosEarnedCount.toString());
                            updateVideosEarnedDisplay();

                            // Re-render dashboard to remove the watched video
                            if (currentUserEmail) {
                                showDashboard(currentUserEmail);
                            }
                            alertUser(`You earned ‚Ç¶1000 for watching a video!`);
                            console.log(`Earned ‚Ç¶1000 from video ${videoId}`);
                        }
                    }, 1000);
                }
            } else {
                if (playerIntervals[videoId]) {
                    clearInterval(playerIntervals[videoId]);
                    console.log(`Stopped checking video ${videoId}`);
                }
            }
        }

        // --- Handle TikTok Follow & Earn Logic ---
        function handleFollowTikTok(tiktokId) {
            let earnedTikTokersStatus = JSON.parse(localStorage.getItem('earnedTikTokersStatus') || '{}');
            const statusSpan = document.getElementById(`follow-status-tiktok-${tiktokId}`);
            const followButton = document.querySelector(`button[data-platform="tiktok"][data-id="${tiktokId}"]`);
            const tiktoker = tiktokersList.find(t => t.id === tiktokId);

            if (!tiktoker) {
                alertUser('TikToker not found.');
                return;
            }

            if (earnedTikTokersStatus[tiktokId]) {
                alertUser(`You have already earned from following ${tiktoker.name}.`);
                return;
            }

            // Temporarily disable the button
            if (followButton) {
                followButton.disabled = true;
                followButton.textContent = 'Processing...';
                followButton.classList.remove('bg-pink-500', 'hover:bg-pink-600');
                followButton.classList.add('bg-gray-400', 'cursor-not-allowed');
            }

            // Open the TikTok link in a new tab
            window.open(tiktoker.link, '_blank');

            // Simulate a delay for the user to actually follow/engage
            setTimeout(() => {
                earnedTikTokersStatus[tiktokId] = true;
                localStorage.setItem('earnedTikTokersStatus', JSON.stringify(earnedTikTokersStatus));

                let currentBalance = parseFloat(localStorage.getItem('currentBalance') || '0.00');
                currentBalance += 1000; // Add ‚Ç¶1000 for following
                localStorage.setItem('currentBalance', currentBalance.toFixed(2));
                updateBalanceDisplay();

                let linkFollowsEarnedCount = parseInt(localStorage.getItem('linkFollowsEarnedCount') || '0', 10);
                linkFollowsEarnedCount += 1;
                localStorage.setItem('linkFollowsEarnedCount', linkFollowsEarnedCount.toString());
                updateLinkFollowsEarnedDisplay();

                if (statusSpan) {
                    statusSpan.textContent = 'Earned! ‚úÖ';
                    statusSpan.classList.add('text-green-600');
                    statusSpan.classList.remove('text-gray-500');
                }
                if (followButton) {
                    followButton.textContent = 'Earned! ‚úÖ';
                }
                alertUser(`You earned ‚Ç¶1000 for following ${tiktoker.name} on TikTok!`);
                console.log(`Earned ‚Ç¶1000 from TikToker ${tiktoker.name}`);
            }, 3000); // Simulate a 3-second engagement time
        }

        // --- Handle YouTube Channel Follow & Earn Logic ---
        function handleFollowYouTubeChannel(channelId) {
            let earnedYouTubeChannelsStatus = JSON.parse(localStorage.getItem('earnedYouTubeChannelsStatus') || '{}');
            const statusSpan = document.getElementById(`follow-status-youtube-${channelId}`);
            const followButton = document.querySelector(`button[data-platform="youtube"][data-id="${channelId}"]`);
            const channel = youtubeChannelsList.find(c => c.id === channelId);

            if (!channel) {
                alertUser('YouTube channel not found.');
                return;
            }

            if (earnedYouTubeChannelsStatus[channelId]) {
                alertUser(`You have already earned from following ${channel.name}.`);
                return;
            }

            // Temporarily disable the button
            if (followButton) {
                followButton.disabled = true;
                followButton.textContent = 'Processing...';
                followButton.classList.remove('bg-red-600', 'hover:bg-red-700');
                followButton.classList.add('bg-gray-400', 'cursor-not-allowed');
            }

            // Open the YouTube channel link in a new tab
            window.open(channel.link, '_blank');

            // Simulate a delay for the user to actually follow/engage
            setTimeout(() => {
                earnedYouTubeChannelsStatus[channelId] = true;
                localStorage.setItem('earnedYouTubeChannelsStatus', JSON.stringify(earnedYouTubeChannelsStatus));

                let currentBalance = parseFloat(localStorage.getItem('currentBalance') || '0.00');
                currentBalance += 1000; // Add ‚Ç¶1000 for following
                localStorage.setItem('currentBalance', currentBalance.toFixed(2));
                updateBalanceDisplay();

                let linkFollowsEarnedCount = parseInt(localStorage.getItem('linkFollowsEarnedCount') || '0', 10);
                linkFollowsEarnedCount += 1;
                localStorage.setItem('linkFollowsEarnedCount', linkFollowsEarnedCount.toString());
                updateLinkFollowsEarnedDisplay();

                if (statusSpan) {
                    statusSpan.textContent = 'Earned! ‚úÖ';
                    statusSpan.classList.add('text-green-600');
                    statusSpan.classList.remove('text-gray-500');
                }
                if (followButton) {
                    followButton.textContent = 'Earned! ‚úÖ';
                }
                alertUser(`You earned ‚Ç¶1000 for following ${channel.name} on YouTube!`);
                console.log(`Earned ‚Ç¶1000 from YouTube channel ${channel.name}`);
            }, 3000); // Simulate a 3-second engagement time
        }

        // --- Update Display Functions ---
        function updateBalanceDisplay() {
            const balanceSpan = document.getElementById('current-balance');
            if (balanceSpan) {
                const currentBalance = parseFloat(localStorage.getItem('currentBalance') || '0.00');
                balanceSpan.textContent = currentBalance.toFixed(2);
            }
        }

        function updateInvestedBalanceDisplay() {
            const investedBalanceSpan = document.getElementById('invested-balance');
            if (investedBalanceSpan) {
                const investedBalance = parseFloat(localStorage.getItem('investedBalance') || '0.00');
                investedBalanceSpan.textContent = investedBalance.toFixed(2);
            }
        }

        function updateVideosEarnedDisplay() {
            const videosEarnedSpan = document.getElementById('videos-earned-count');
            if (videosEarnedSpan) {
                const videosEarnedCount = parseInt(localStorage.getItem('videosEarnedCount') || '0', 10);
                videosEarnedSpan.textContent = videosEarnedCount;
            }
        }

        function updateLinkFollowsEarnedDisplay() {
            const linkFollowsEarnedSpan = document.getElementById('link-follows-earned-count');
            if (linkFollowsEarnedSpan) {
                const linkFollowsEarnedCount = parseInt(localStorage.getItem('linkFollowsEarnedCount') || '0', 10);
                linkFollowsEarnedSpan.textContent = linkFollowsEarnedCount;
            }
        }

        // Updates the status text and button state for ALL follow platforms on dashboard load
        function updateAllFollowStatuses() {
            const earnedTikTokersStatus = JSON.parse(localStorage.getItem('earnedTikTokersStatus') || '{}');
            tiktokersList.forEach(tiktoker => {
                const statusSpan = document.getElementById(`follow-status-tiktok-${tiktoker.id}`);
                const followButton = document.querySelector(`button[data-platform="tiktok"][data-id="${tiktoker.id}"]`);

                if (earnedTikTokersStatus[tiktoker.id]) {
                    if (statusSpan) {
                        statusSpan.textContent = 'Earned! ‚úÖ';
                        statusSpan.classList.add('text-green-600');
                        statusSpan.classList.remove('text-gray-500');
                    }
                    if (followButton) {
                        followButton.textContent = 'Already Earned';
                        followButton.disabled = true;
                        followButton.classList.remove('bg-pink-500', 'hover:bg-pink-600');
                        followButton.classList.add('bg-gray-400', 'cursor-not-allowed');
                    }
                } else {
                    if (statusSpan) {
                        statusSpan.textContent = 'Not followed yet';
                        statusSpan.classList.remove('text-green-600');
                        statusSpan.classList.add('text-gray-500');
                    }
                    if (followButton) {
                        followButton.textContent = 'Follow & Earn';
                        followButton.disabled = false;
                        followButton.classList.add('bg-pink-500', 'hover:bg-pink-600');
                        followButton.classList.remove('bg-gray-400', 'cursor-not-allowed');
                    }
                }
            });

            const earnedYouTubeChannelsStatus = JSON.parse(localStorage.getItem('earnedYouTubeChannelsStatus') || '{}');
            youtubeChannelsList.forEach(channel => {
                const statusSpan = document.getElementById(`follow-status-youtube-${channel.id}`);
                const followButton = document.querySelector(`button[data-platform="youtube"][data-id="${channel.id}"]`);

                if (earnedYouTubeChannelsStatus[channel.id]) {
                    if (statusSpan) {
                        statusSpan.textContent = 'Earned! ‚úÖ';
                        statusSpan.classList.add('text-green-600');
                        statusSpan.classList.remove('text-gray-500');
                    }
                    if (followButton) {
                        followButton.textContent = 'Already Earned';
                        followButton.disabled = true;
                        followButton.classList.remove('bg-red-600', 'hover:bg-red-700');
                        followButton.classList.add('bg-gray-400', 'cursor-not-allowed');
                    }
                } else {
                    if (statusSpan) {
                        statusSpan.textContent = 'Not followed yet';
                        statusSpan.classList.remove('text-green-600');
                        statusSpan.classList.add('text-gray-500');
                    }
                    if (followButton) {
                        followButton.textContent = 'Follow & Earn';
                        followButton.disabled = false;
                        followButton.classList.add('bg-red-600', 'hover:bg-red-700');
                        followButton.classList.remove('bg-gray-400', 'cursor-not-allowed');
                    }
                }
            });
        }


        // --- Render Withdrawal History on Dashboard ---
        function renderWithdrawalHistory() {
            const historyBody = document.getElementById('withdrawal-history-body');
            const noWithdrawalsMessage = document.getElementById('no-withdrawals-message');
            if (!historyBody || !noWithdrawalsMessage) return;

            const storedHistory = JSON.parse(localStorage.getItem('withdrawalHistory')) || [];

            if (storedHistory.length === 0) {
                historyBody.innerHTML = '';
                noWithdrawalsMessage.classList.remove('hidden');
                return;
            } else {
                noWithdrawalsMessage.classList.add('hidden');
            }

            historyBody.innerHTML = storedHistory.map(request => `
                <tr class="hover:bg-gray-50 transition-colors duration-150">
                    <td class="py-3 px-4 border-b text-sm text-gray-700">${request.date}</td>
                    <td class="py-3 px-4 border-b text-sm font-medium text-green-600">‚Ç¶${request.amount}</td>
                    <td class="py-3 px-4 border-b text-sm text-gray-700">${request.bankName}</td>
                    <td class="py-3 px-4 border-b text-sm text-gray-700">${request.accountNumber}</td>
                    <td class="py-3 px-4 border-b text-sm">
                        <span class="${request.status === 'Pending' ? 'bg-yellow-200 text-yellow-800' : 'bg-green-200 text-green-800'} px-3 py-1 rounded-full text-xs font-semibold">
                            ${request.status}
                        </span>
                    </td>
                </tr>
            `).join('');
        }

        // --- Event Listeners for main page elements ---
        contactLink.addEventListener('click', function(event) {
            event.preventDefault();
            showContactModal();
        });

        signupNavLink.addEventListener('click', function(event) {
            event.preventDefault();
            showSignupForm();
        });

        heroSignupButton.addEventListener('click', function(event) {
            event.preventDefault();
            showSignupForm();
        });

        footerSignupButton.addEventListener('click', function(event) {
            event.preventDefault();
            showSignupForm();
        });

        closeModalButton.addEventListener('click', hideModal);

        appModal.addEventListener('click', function(event) {
            if (event.target === appModal) {
                hideModal();
            }
        });

        document.addEventListener('keydown', function(event) {
            if (event.key === 'Escape' && appModal.classList.contains('active')) {
                hideModal();
            }
        });

        // Initial check if user is already logged in on page load
        document.addEventListener('DOMContentLoaded', () => {
            const storedEmail = localStorage.getItem('userEmail');
            const storedPassword = localStorage.getItem('userPassword');

            if (storedEmail && storedPassword) {
                showDashboard(storedEmail);
            } else {
                // Clear any lingering player objects and intervals if not logged in
                youtubePlayers = {};
                for (const videoId in playerIntervals) {
                    clearInterval(playerIntervals[videoId]);
                }
                playerIntervals = {};
            }
        });
    </script>
</body>
</html>
