<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>OilInvestPro</title>
    <!-- Tailwind CSS CDN -->
    <script src="https://cdn.tailwindcss.com"></script>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;600;700&display=swap" rel="stylesheet">
    <!-- html2canvas CDN for receipt generation -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/html2canvas/1.4.1/html2canvas.min.js"></script>
    <style>
        body {
            font-family: 'Inter', sans-serif;
            background-color: #f3f4f6; /* Light gray background */
        }
        .status-message {
            transition: all 0.3s ease-in-out;
        }
        .animate-pulse-slow {
            animation: pulse 4s cubic-bezier(0.4, 0, 0.6, 1) infinite;
        }
        @keyframes pulse {
            0%, 100% { opacity: 1; }
            50% { opacity: .5; }
        }
        /* Custom scrollbar for history modal */
        .overflow-y-scroll::-webkit-scrollbar {
            width: 8px;
        }
        .overflow-y-scroll::-webkit-scrollbar-track {
            background: #f1f1f1;
            border-radius: 10px;
        }
        .overflow-y-scroll::-webkit-scrollbar-thumb {
            background: #888;
            border-radius: 10px;
        }
        .overflow-y-scroll::-webkit-scrollbar-thumb:hover {
            background: #555;
        }
        /* Hidden by default, shown by JS */
        .page-section {
            display: none;
        }
    </style>
</head>
<body class="antialiased text-gray-800">

    <!-- Home Page Section -->
    <div id="homePage" class="page-section">
        <!-- Header -->
        <header class="bg-gray-900 text-white py-4 shadow-lg">
            <div class="container mx-auto px-4 flex justify-between items-center">
                <a href="#" class="text-3xl font-bold rounded-lg p-2 hover:bg-gray-700 transition-colors" onclick="showHomePage()">
                    OilInvestPro
                </a>
                <nav>
                    <ul class="flex space-x-6">
                        <li><a href="#" class="hover:text-amber-400 transition-colors text-lg" onclick="showHomePage()">Home</a></li>
                        <li><a href="#" class="hover:text-amber-400 transition-colors text-lg">About Us</a></li>
                        <li><a href="#" class="hover:text-amber-400 transition-colors text-lg">How It Works</a></li>
                        <li><a href="#" class="hover:text-amber-400 transition-colors text-lg">Contact</a></li>
                        <li><a href="#" class="bg-blue-600 hover:bg-blue-700 text-white font-bold py-2 px-4 rounded-lg shadow-md transition-transform duration-300 transform hover:scale-105 active:scale-95" onclick="showLoginPage()">Login</a></li>
                        <li><a href="#" class="bg-green-600 hover:bg-green-700 text-white font-bold py-2 px-4 rounded-lg shadow-md transition-transform duration-300 transform hover:scale-105 active:scale-95" onclick="showSignupPage()">Sign Up</a></li>
                    </ul>
                </nav>
            </div>
        </header>

        <!-- Hero Section -->
        <section class="bg-gradient-to-r from-gray-800 to-gray-900 text-white py-20 md:py-32">
            <div class="container mx-auto px-4 text-center">
                <h1 class="text-4xl md:text-6xl font-extrabold mb-6 leading-tight rounded-lg px-4 py-2">
                    Unlock Your Wealth with Oil & Gas Investments
                </h1>
                <p class="text-xl md:text-2xl mb-10 max-w-3xl mx-auto opacity-90">
                    Tap into a time-tested, resilient asset class. Your gateway to energy prosperity.
                </p>
                <a href="#" class="bg-amber-500 hover:bg-amber-600 text-gray-900 font-bold py-4 px-10 rounded-full text-xl md:text-2xl shadow-lg transform transition-all duration-300 hover:scale-105 active:scale-95" onclick="showSignupPage()">
                    Start Investing Today!
                </a>
            </div>
        </section>

        <!-- Why Invest in Oil Section -->
        <section class="py-16 md:py-24 bg-white">
            <div class="container mx-auto px-4">
                <h2 class="text-3xl md:text-4xl font-bold text-center mb-12">Why Oil & Gas Investment?</h2>
                <div class="grid md:grid-cols-3 gap-8 text-center">
                    <!-- Benefit 1 -->
                    <div class="bg-gray-100 p-8 rounded-xl shadow-md transition-transform duration-300 hover:scale-105">
                        <div class="text-5xl mb-4 text-amber-500">üí∞</div>
                        <h3 class="text-2xl font-semibold mb-4">High Growth Potential</h3>
                        <p class="text-gray-700">The global demand for energy continues to grow, ensuring a robust market for oil and gas. Position your portfolio for significant returns.</p>
                    </div>
                    <!-- Benefit 2 -->
                    <div class="bg-gray-100 p-8 rounded-xl shadow-md transition-transform duration-300 hover:scale-105">
                        <div class="text-5xl mb-4 text-amber-500">üõ°Ô∏è</div>
                        <h3 class="text-2xl font-semibold mb-4">Hedge Against Inflation</h3>
                        <p class="text-gray-700">Historically, oil and gas have served as effective hedges against inflation, preserving your purchasing power during economic shifts.</p>
                    </div>
                    <!-- Benefit 3 -->
                    <div class="bg-gray-100 p-8 rounded-xl shadow-md transition-transform duration-300 hover:scale-105">
                        <div class="text-5xl mb-4 text-amber-500">üåç</div>
                        <h3 class="text-2xl font-semibold mb-4">Essential Global Commodity</h3>
                        <p class="text-gray-700">Oil remains fundamental to global industry, transportation, and daily life, making it a perpetually valuable commodity.</p>
                    </div>
                </div>
            </div>
        </section>

        <!-- Investment Details Section -->
        <section class="py-16 md:py-24 bg-gray-900 text-white">
            <div class="container mx-auto px-4 text-center">
                <h2 class="text-3xl md:text-4xl font-bold mb-8">Accessible Investment for Everyone</h2>
                <p class="text-xl md:text-2xl mb-10 max-w-4xl mx-auto opacity-90">
                    We believe in making high-potential investments accessible. With our platform, you can begin your journey into the lucrative oil and gas sector with a minimal initial commitment.
                </p>
                <div class="bg-amber-500 text-gray-900 inline-block p-6 md:p-8 rounded-2xl shadow-xl">
                    <p class="text-3xl md:text-5xl font-extrabold">
                        Minimum Investment: <span class="text-white bg-gray-900 rounded-lg px-3 py-1 ml-2"> ‚Ç¶1,000</span>
                    </p>
                    <p class="mt-4 text-lg md:text-xl">
                        (Illustrative example. Actual minimums may vary based on specific offerings.)
                    </p>
                </div>
                <p class="mt-12 text-lg max-w-3xl mx-auto opacity-80">
                    Our expert team guides you through the process, ensuring a seamless and transparent investment experience. We provide detailed insights and support every step of the way.
                </p>
            </div>
        </section>

        <!-- Call to Action / Sign Up Section -->
        <section id="signup-home" class="py-16 md:py-24 bg-white">
            <div class="container mx-auto px-4 text-center">
                <h2 class="text-3xl md:text-4xl font-bold mb-8">Ready to Grow Your Portfolio?</h2>
                <p class="text-xl md:text-2xl mb-12 max-w-3xl mx-auto text-gray-700">
                    Join thousands of savvy investors who are leveraging the power of oil and gas. Sign up today and take the first step towards a prosperous future!
                </p>
                <a href="#" class="bg-blue-600 hover:bg-blue-700 text-white font-bold py-5 px-12 rounded-full text-2xl md:text-3xl shadow-xl transform transition-all duration-300 hover:scale-105 active:scale-95" onclick="showSignupPage()">
                    Sign Up Now
                </a>
                <p class="mt-8 text-gray-600">Secure, transparent, and built for your success.</p>
            </div>
        </section>

        <!-- Footer -->
        <footer class="bg-gray-900 text-gray-400 py-8">
            <div class="container mx-auto px-4 text-center md:flex md:justify-between md:items-center">
                <p>&copy; 2025 OilInvestPro. All rights reserved.</p>
                <div class="flex justify-center mt-4 md:mt-0 space-x-6">
                    <a href="#" class="hover:text-white transition-colors">Privacy Policy</a>
                    <a href="#" class="hover:text-white transition-colors">Terms of Service</a>
                </div>
            </div>
        </footer>
    </div>

    <!-- Login Page Section -->
    <div id="loginPage" class="page-section antialiased text-gray-800 flex items-center justify-center min-h-screen">
        <!-- Main Login Container -->
        <div class="bg-white p-8 md:p-12 rounded-xl shadow-lg w-full max-w-md">
            <h2 class="text-3xl font-bold text-center mb-8 text-gray-900">Log In to Your Account</h2>
            <form id="loginForm" class="space-y-6">
                <!-- Email or Phone Number Input -->
                <div>
                    <label for="loginUsername" class="block text-gray-700 text-sm font-semibold mb-2">Email or Phone Number</label>
                    <input type="text" id="loginUsername" name="username" placeholder="Enter your email or phone number"
                           class="w-full px-4 py-3 rounded-lg border-2 border-gray-300 focus:border-amber-500 focus:ring-1 focus:ring-amber-500 transition-colors duration-200"
                           required>
                    <p id="loginUsernameError" class="text-red-500 text-xs mt-1 hidden">Please enter your email or phone number.</p>
                </div>

                <!-- Password Input -->
                <div>
                    <label for="loginPassword" class="block text-gray-700 text-sm font-semibold mb-2">Password</label>
                    <input type="password" id="loginPassword" name="password" placeholder="Enter your password"
                           class="w-full px-4 py-3 rounded-lg border-2 border-gray-300 focus:border-amber-500 focus:ring-1 focus:ring-amber-500 transition-colors duration-200"
                           required>
                    <p id="loginPasswordError" class="text-red-500 text-xs mt-1 hidden">Please enter your password.</p>
                </div>

                <!-- Login Button -->
                <button type="submit"
                        class="w-full bg-blue-600 hover:bg-blue-700 text-white font-bold py-3 rounded-lg shadow-md transition-transform duration-300 transform hover:scale-105 active:scale-95">
                    Log In
                </button>
            </form>

            <!-- Status/Error Message (initially hidden) -->
            <div id="loginStatusMessage" class="hidden mt-6 px-4 py-3 rounded-lg relative" role="alert">
                <span class="block sm:inline" id="loginStatusText"></span>
                <span class="absolute top-0 bottom-0 right-0 px-4 py-3 cursor-pointer" onclick="this.parentNode.classList.add('hidden')">
                    <svg class="fill-current h-6 w-6" role="button" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 20 20"><title>Close</title><path d="M14.348 14.849a1.2 1.2 0 0 1-1.697 0L10 11.819l-2.651 3.029a1.2 1.2 0 1 1-1.697-1.697l2.758-3.15-2.759-3.15a1.2 1.2 0 1 1 1.697-1.697L10 8.183l2.651-3.031a1.2 1.2 0 1 1 1.697 1.697l-2.758 3.152 2.758 3.15a1.2 1.2 0 0 1 0 1.698z"/></svg>
                </span>
            </div>


            <p class="text-center text-gray-600 text-sm mt-8">
                Don't have an account? <a href="#" class="text-blue-600 hover:underline" onclick="showSignupPage()">Sign up</a>
            </p>
            <p class="text-center text-gray-600 text-sm mt-4">
                <a href="#" class="text-gray-500 hover:underline" onclick="showHomePage()">Back to Home</a>
            </p>
        </div>
    </div>

    <!-- Sign Up Page Section -->
    <div id="signupPage" class="page-section antialiased text-gray-800 flex items-center justify-center min-h-screen">
        <!-- Main Sign Up Container -->
        <div class="bg-white p-8 md:p-12 rounded-xl shadow-lg w-full max-w-md">
            <h2 class="text-3xl font-bold text-center mb-8 text-gray-900">Create Your Account</h2>
            <form id="signupForm" class="space-y-6">
                <!-- Phone Number Input -->
                <div>
                    <label for="signupPhone" class="block text-gray-700 text-sm font-semibold mb-2">Nigerian Phone Number</label>
                    <input type="tel" id="signupPhone" name="phone" placeholder="e.g., 08012345678"
                           class="w-full px-4 py-3 rounded-lg border-2 border-gray-300 focus:border-amber-500 focus:ring-1 focus:ring-amber-500 transition-colors duration-200"
                           pattern="^(070|080|081|090|091)\d{8}$"
                           title="Please enter a valid 11-digit Nigerian phone number (e.g., 08012345678)"
                           required>
                    <p id="signupPhoneError" class="text-red-500 text-xs mt-1 hidden">Please enter a valid 11-digit Nigerian phone number.</p>
                </div>

                <!-- Email Address Input -->
                <div>
                    <label for="signupEmail" class="block text-gray-700 text-sm font-semibold mb-2">Email Address</label>
                    <input type="email" id="signupEmail" name="email" placeholder="you@example.com"
                           class="w-full px-4 py-3 rounded-lg border-2 border-gray-300 focus:border-amber-500 focus:ring-1 focus:ring-amber-500 transition-colors duration-200"
                           required>
                    <p id="signupEmailError" class="text-red-500 text-xs mt-1 hidden">Please enter a valid email address.</p>
                </div>

                <!-- Password Input -->
                <div>
                    <label for="signupPassword" class="block text-gray-700 text-sm font-semibold mb-2">Password</label>
                    <input type="password" id="signupPassword" name="password" placeholder="Minimum 8 characters"
                           class="w-full px-4 py-3 rounded-lg border-2 border-gray-300 focus:border-amber-500 focus:ring-1 focus:ring-amber-500 transition-colors duration-200"
                           minlength="8"
                           required>
                    <p id="signupPasswordError" class="text-red-500 text-xs mt-1 hidden">Password must be at least 8 characters long.</p>
                </div>

                <!-- Sign Up Button -->
                <button type="submit"
                        class="w-full bg-blue-600 hover:bg-blue-700 text-white font-bold py-3 rounded-lg shadow-md transition-transform duration-300 transform hover:scale-105 active:scale-95">
                    Sign Up
                </button>
            </form>

            <!-- Success/Error Message (initially hidden) -->
            <div id="signupStatusMessage" class="hidden mt-6 px-4 py-3 rounded-lg relative" role="alert">
                <span class="block sm:inline" id="signupStatusText"></span>
                <span class="absolute top-0 bottom-0 right-0 px-4 py-3 cursor-pointer" onclick="this.parentNode.classList.add('hidden')">
                    <svg class="fill-current h-6 w-6" role="button" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 20 20"><title>Close</title><path d="M14.348 14.849a1.2 1.2 0 0 1-1.697 0L10 11.819l-2.651 3.029a1.2 1.2 0 1 1-1.697-1.697l2.758-3.15-2.759-3.15a1.2 1.2 0 1 1 1.697-1.697L10 8.183l2.651-3.031a1.2 1.2 0 1 1 1.697 1.697l-2.758 3.152 2.758 3.15a1.2 1.2 0 0 1 0 1.698z"/></svg>
                </span>
            </div>

            <p class="text-center text-gray-600 text-sm mt-8">
                Already have an account? <a href="#" class="text-blue-600 hover:underline" onclick="showLoginPage()">Log in</a>
            </p>
            <p class="text-center text-gray-600 text-sm mt-4">
                <a href="#" class="text-gray-500 hover:underline" onclick="showHomePage()">Back to Home</a>
            </p>
        </div>
    </div>

    <!-- Dashboard Page Section -->
    <div id="dashboardPage" class="page-section">
        <!-- Header (Duplicated for Dashboard, but Logout button is unique here) -->
        <header class="bg-gray-900 text-white py-4 shadow-lg">
            <div class="container mx-auto px-4 flex justify-between items-center">
                <a href="#" class="text-3xl font-bold rounded-lg p-2 hover:bg-gray-700 transition-colors" onclick="showDashboardPage()">
                    OilInvestPro
                </a>
                <nav class="flex items-center space-x-6">
                    <span id="accountName" class="text-lg font-semibold">Welcome, Investor!</span>
                    <button id="logoutButton" class="bg-red-600 hover:bg-red-700 text-white font-semibold py-2 px-4 rounded-lg shadow-md transition-colors duration-200">
                        Logout
                    </button>
                </nav>
            </div>
        </header>

        <!-- Dashboard Content -->
        <main class="container mx-auto px-4 py-8 md:py-12">
            <!-- Account Summary Section -->
            <section class="bg-white p-6 md:p-8 rounded-xl shadow-lg mb-8">
                <h2 class="text-2xl md:text-3xl font-bold mb-4 text-gray-900">Your Account Summary</h2>
                <div class="flex flex-col md:flex-row md:items-center md:justify-between space-y-4 md:space-y-0">
                    <div>
                        <p class="text-gray-600 text-lg">Current Liquid Balance:</p>
                        <p id="currentBalance" class="text-4xl md:text-5xl font-extrabold text-green-600">‚Ç¶0.00</p>
                    </div>
                    <div class="flex flex-col md:flex-row space-y-2 md:space-y-0 md:space-x-4 w-full md:w-auto">
                        <button id="depositButton" class="bg-blue-600 hover:bg-blue-700 text-white font-bold py-3 px-8 rounded-full shadow-md transition-transform duration-300 transform hover:scale-105 active:scale-95">
                            Deposit Money
                        </button>
                        <button id="withdrawToBankButton" class="bg-purple-600 hover:bg-purple-700 text-white font-bold py-3 px-8 rounded-full shadow-md transition-transform duration-300 transform hover:scale-105 active:scale-95">
                            Withdraw to Bank
                        </button>
                        <button id="historyButton" class="bg-gray-700 hover:bg-gray-800 text-white font-bold py-3 px-8 rounded-full shadow-md transition-transform duration-300 transform hover:scale-105 active:scale-95">
                            History
                        </button>
                    </div>
                </div>
                <!-- Deposit Modal -->
                <div id="depositModal" class="hidden fixed inset-0 bg-gray-900 bg-opacity-75 flex items-center justify-center z-50">
                    <div class="bg-white p-8 rounded-xl shadow-lg w-full max-w-md relative">
                        <h3 class="text-2xl font-bold mb-4 text-gray-900 text-center">Deposit Funds</h3>
                        <p class="text-gray-700 mb-6 text-center">Transfer money to the account details below:</p>

                        <div class="space-y-3 mb-6 p-4 bg-gray-100 rounded-lg text-center border border-gray-200">
                            <p class="text-lg font-semibold">Account Number: <span class="font-bold text-blue-600 text-2xl">9063804954</span></p>
                            <p class="text-lg font-semibold">Bank: <span class="font-bold text-gray-800 text-xl">Moniepoint</span></p>
                            <p class="text-lg font-semibold">Account Name: <span class="font-bold text-gray-800 text-xl">Onuzurike Somtochukwu Michael</span></p>
                        </div>

                        <p class="text-gray-700 mb-4 text-center">After transferring, please provide details below:</p>

                        <!-- Deposit Amount Input -->
                        <div class="mb-4">
                            <label for="depositAmount" class="block text-gray-700 text-sm font-semibold mb-2">Amount Deposited (‚Ç¶)</label>
                            <input type="number" id="depositAmount" placeholder="e.g., 5000"
                                   class="w-full px-4 py-3 rounded-lg border-2 border-gray-300 focus:border-amber-500 focus:ring-1 focus:ring-amber-500 transition-colors duration-200"
                                   min="1" required>
                            <p id="depositAmountError" class="text-red-500 text-xs mt-1 hidden">Please enter a valid amount (minimum ‚Ç¶1).</p>
                        </div>

                        <!-- Sender Account Name Input -->
                        <div class="mb-4">
                            <label for="senderAccountName" class="block text-gray-700 text-sm font-semibold mb-2">Your Account Name (used for transfer)</label>
                            <input type="text" id="senderAccountName" placeholder="e.g., John C. Doe"
                                   class="w-full px-4 py-3 rounded-lg border-2 border-gray-300 focus:border-amber-500 focus:ring-1 focus:ring-amber-500 transition-colors duration-200"
                                   required>
                            <p id="senderAccountNameError" class="text-red-500 text-xs mt-1 hidden">Please enter the name on the account you sent from.</p>
                        </div>

                        <!-- Account Number Used for Transfer Input -->
                        <div class="mb-6">
                            <label for="transferAccountNumber" class="block text-gray-700 text-sm font-semibold mb-2">Account Number Used for Transfer</label>
                            <input type="tel" id="transferAccountNumber" placeholder="Enter your 10-digit account number"
                                   class="w-full px-4 py-3 rounded-lg border-2 border-gray-300 focus:border-amber-500 focus:ring-1 focus:ring-amber-500 transition-colors duration-200"
                                   pattern="\d{10}"
                                   title="Please enter a 10-digit account number."
                                   required>
                            <p id="transferAccountNumberError" class="text-red-500 text-xs mt-1 hidden">Please enter a valid 10-digit account number.</p>
                        </div>

                        <div class="flex justify-end space-x-4 mt-6">
                            <button id="cancelDeposit" class="bg-gray-300 hover:bg-gray-400 text-gray-800 font-semibold py-2 px-5 rounded-lg transition-colors">
                                Cancel
                            </button>
                            <button id="confirmDeposit" class="bg-green-600 hover:bg-green-700 text-white font-semibold py-2 px-5 rounded-lg transition-colors">
                                Confirm Deposit
                            </button>
                        </div>
                    </div>
                </div>

                <!-- Withdraw to Bank Modal -->
                <div id="withdrawModal" class="hidden fixed inset-0 bg-gray-900 bg-opacity-75 flex items-center justify-center z-50">
                    <div class="bg-white p-8 rounded-xl shadow-lg w-full max-w-md relative">
                        <h3 class="text-2xl font-bold mb-4 text-gray-900 text-center">Withdraw Funds to Bank</h3>
                        <p class="text-gray-700 mb-6 text-center">Enter the amount you wish to withdraw and your bank details.</p>

                        <!-- Withdraw Amount Input -->
                        <div class="mb-4">
                            <label for="withdrawAmount" class="block text-gray-700 text-sm font-semibold mb-2">Amount to Withdraw (‚Ç¶)</label>
                            <input type="number" id="withdrawAmount" placeholder="e.g., 5000"
                                   class="w-full px-4 py-3 rounded-lg border-2 border-gray-300 focus:border-purple-500 focus:ring-1 focus:ring-purple-500 transition-colors duration-200"
                                   min="1" required>
                            <p id="withdrawAmountError" class="text-red-500 text-xs mt-1 hidden">Please enter a valid amount.</p>
                        </div>

                        <!-- Bank Account Name Input -->
                        <div class="mb-4">
                            <label for="bankAccountName" class="block text-gray-700 text-sm font-semibold mb-2">Bank Account Name</label>
                            <input type="text" id="bankAccountName" placeholder="e.g., Your Full Name"
                                   class="w-full px-4 py-3 rounded-lg border-2 border-gray-300 focus:border-purple-500 focus:ring-1 focus:ring-purple-500 transition-colors duration-200"
                                   required>
                            <p id="bankAccountNameError" class="text-red-500 text-xs mt-1 hidden">Please enter the bank account name.</p>
                        </div>

                        <!-- Bank Account Number Input -->
                        <div class="mb-6">
                            <label for="bankAccountNumber" class="block text-gray-700 text-sm font-semibold mb-2">Bank Account Number</label>
                            <input type="tel" id="bankAccountNumber" placeholder="Enter your 10-digit account number"
                                   class="w-full px-4 py-3 rounded-lg border-2 border-gray-300 focus:border-purple-500 focus:ring-1 focus:ring-purple-500 transition-colors duration-200"
                                   pattern="\d{10}"
                                   title="Please enter a 10-digit bank account number."
                                   required>
                            <p id="bankAccountNumberError" class="text-red-500 text-xs mt-1 hidden">Please enter a valid 10-digit account number.</p>
                        </div>
                        <div class="mb-6">
                            <label for="bankName" class="block text-gray-700 text-sm font-semibold mb-2">Bank Name</label>
                            <input type="text" id="bankName" placeholder="e.g., Access Bank"
                                   class="w-full px-4 py-3 rounded-lg border-2 border-gray-300 focus:border-purple-500 focus:ring-1 focus:ring-purple-500 transition-colors duration-200"
                                   required>
                            <p id="bankNameError" class="text-red-500 text-xs mt-1 hidden">Please enter the bank name.</p>
                        </div>

                        <div class="flex justify-end space-x-4 mt-6">
                            <button id="cancelWithdrawal" class="bg-gray-300 hover:bg-gray-400 text-gray-800 font-semibold py-2 px-5 rounded-lg transition-colors">
                                Cancel
                            </button>
                            <button id="confirmWithdrawal" class="bg-purple-600 hover:bg-purple-700 text-white font-semibold py-2 px-5 rounded-lg transition-colors">
                                Confirm Withdrawal
                            </button>
                        </div>
                    </div>
                </div>

                <!-- Transaction History Modal -->
                <div id="historyModal" class="hidden fixed inset-0 bg-gray-900 bg-opacity-75 flex items-center justify-center z-50">
                    <div class="bg-white p-8 rounded-xl shadow-lg w-full max-w-2xl relative">
                        <h3 class="text-2xl font-bold mb-4 text-gray-900 text-center">Transaction History</h3>
                        <div id="historyList" class="max-h-96 overflow-y-scroll border border-gray-200 p-4 rounded-lg bg-gray-50">
                            <!-- Transaction items will be rendered here -->
                        </div>
                        <div class="flex justify-end mt-6">
                            <button id="closeHistoryModal" class="bg-gray-700 hover:bg-gray-800 text-white font-bold py-2 px-5 rounded-lg transition-colors">
                                Close
                            </button>
                        </div>
                    </div>
                </div>

                <!-- Receipt Modal (New) -->
                <div id="receiptModal" class="hidden fixed inset-0 bg-gray-900 bg-opacity-75 flex items-center justify-center z-50">
                    <div class="bg-white p-8 rounded-xl shadow-lg w-full max-w-md relative">
                        <h3 class="text-2xl font-bold mb-6 text-gray-900 text-center">Withdrawal Receipt</h3>
                        <div id="receiptContent" class="border border-gray-200 p-6 rounded-lg bg-gray-50 text-gray-800">
                            <!-- Receipt content will be dynamically inserted here -->
                        </div>
                        <div class="flex justify-end space-x-4 mt-6">
                            <button id="downloadReceiptButton" class="bg-green-600 hover:bg-green-700 text-white font-bold py-2 px-5 rounded-lg transition-colors">
                                Download Receipt (PNG)
                            </button>
                            <button id="closeReceiptModalButton" class="bg-gray-700 hover:bg-gray-800 text-white font-bold py-2 px-5 rounded-lg transition-colors">
                                Close
                            </button>
                        </div>
                    </div>
                </div>

                <!-- Status Message (for all operations: deposit, withdraw, invest, redeem) -->
                <div id="dashboardStatusMessage" class="hidden mt-6 px-4 py-3 rounded-lg relative" role="alert">
                    <span class="block sm:inline" id="dashboardStatusText"></span>
                    <span class="absolute top-0 bottom-0 right-0 px-4 py-3 cursor-pointer" onclick="this.parentNode.classList.add('hidden')">
                        <svg class="fill-current h-6 w-6" role="button" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 20 20"><title>Close</title><path d="M14.348 14.849a1.2 1.2 0 0 1-1.697 0L10 11.819l-2.651 3.029a1.2 1.2 0 1 1-1.697-1.697l2.758-3.15-2.759-3.15a1.2 1.2 0 1 1 1.697-1.697L10 8.183l2.651-3.031a1.2 1.2 0 1 1 1.697 1.697l-2.758 3.152 2.758 3.15a1.2 1.2 0 0 1 0 1.698z"/></svg>
                </span>
                </div>
            </section>

            <!-- My Investments Section -->
            <section class="bg-white p-6 md:p-8 rounded-xl shadow-lg mt-8">
                <h2 class="text-2xl md:text-3xl font-bold mb-6 text-center text-gray-900">My Investments</h2>
                <div class="flex justify-center mb-6">
                    <p class="text-lg font-semibold">Total Investment Value: <span id="totalInvestmentValue" class="text-2xl font-extrabold text-purple-600 animate-pulse-slow">‚Ç¶0.00</span></p>
                </div>
                <div id="investmentsList" class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6">
                    <!-- Investment items will be rendered here by JavaScript -->
                    <p class="text-center text-gray-500 col-span-full" id="noInvestmentsMessage">You have no active investments yet.</p>
                </div>
            </section>

            <!-- Investment Plans Section -->
            <section class="bg-white p-6 md:p-8 rounded-xl shadow-lg mt-8">
                <h2 class="text-2xl md:text-3xl font-bold mb-6 text-center text-gray-900">Our Investment Plans</h2>
                <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-8">
                    <!-- Plan 1: Rapid Growth Plan -->
                    <div class="bg-gray-100 p-6 rounded-xl shadow-md border-t-4 border-amber-500 transition-transform duration-300 hover:scale-105">
                        <h3 class="text-xl md:text-2xl font-bold mb-3 text-amber-600">Rapid Growth Plan</h3>
                        <p class="text-gray-700 mb-2">
                            Invest <span class="font-bold text-lg">‚Ç¶1,000</span>
                        </p>
                        <p class="text-gray-700 mb-4">
                            Target Return: <span class="font-bold text-lg text-green-700">‚Ç¶365,000</span> by Year End
                        </p>
                        <p class="text-gray-600 text-sm mb-6">
                            An aggressive, short-term plan designed for significant daily growth, aiming for ‚Ç¶365,000 in one year.
                        </p>
                        <button class="invest-button w-full bg-amber-500 hover:bg-amber-600 text-gray-900 font-bold py-3 rounded-lg shadow-md transition-transform duration-300 transform hover:scale-105 active:scale-95"
                                data-plan-name="Rapid Growth Plan" data-min-investment="1000">
                            Invest Now
                        </button>
                    </div>

                    <!-- Plan 4: Quick Return Plan -->
                    <div class="bg-gray-100 p-6 rounded-xl shadow-md border-t-4 border-purple-500 transition-transform duration-300 hover:scale-105">
                        <h3 class="text-xl md:text-2xl font-bold mb-3 text-purple-600">Quick Return Plan</h3>
                        <p class="text-gray-700 mb-2">
                            Invest <span class="font-bold text-lg">‚Ç¶2,000</span>
                        </p>
                        <p class="text-gray-700 mb-4">
                            Target Return: <span class="font-bold text-lg text-green-700">‚Ç¶60,000</span> in 30 Days
                        </p>
                        <p class="text-gray-600 text-sm mb-6">
                            A fast-paced plan returning ‚Ç¶2,000 daily for 30 days, perfect for quick capital turnover.
                        </p>
                        <button class="invest-button w-full bg-purple-500 hover:bg-purple-600 text-white font-bold py-3 rounded-lg shadow-md transition-transform duration-300 transform hover:scale-105 active:scale-95"
                                data-plan-name="Quick Return Plan" data-min-investment="2000">
                            Invest Now
                        </button>
                    </div>


                    <!-- Plan 2: Steady Income Plan -->
                    <div class="bg-gray-100 p-6 rounded-xl shadow-md border-t-4 border-blue-500 transition-transform duration-300 hover:scale-105">
                        <h3 class="text-xl md:text-2xl font-bold mb-3 text-blue-600">Steady Income Plan</h3>
                        <p class="text-gray-700 mb-2">
                            Minimum Investment: <span class="font-bold text-lg">‚Ç¶50,000</span>
                        </p>
                        <p class="text-gray-700 mb-4">
                            Expected Annual Return: <span class="font-bold text-lg text-green-700">15-20%</span>
                        </p>
                        <p class="text-gray-600 text-sm mb-6">
                            A balanced medium-term plan focusing on consistent returns from stable, established oil and gas operations over 2-3 years.
                        </p>
                        <button class="invest-button w-full bg-blue-500 hover:bg-blue-600 text-white font-bold py-3 rounded-lg shadow-md transition-transform duration-300 transform hover:scale-105 active:scale-95"
                                data-plan-name="Steady Income Plan" data-min-investment="50000">
                            Invest Now
                        </button>
                    </div>

                    <!-- Plan 3: Long-Term Growth Plan -->
                    <div class="bg-gray-100 p-6 rounded-xl shadow-md border-t-4 border-green-500 transition-transform duration-300 hover:scale-105">
                        <h3 class="text-xl md:text-2xl font-bold mb-3 text-green-600">Long-Term Growth Plan</h3>
                        <p class="text-gray-700 mb-2">
                            Minimum Investment: <span class="font-bold text-lg">‚Ç¶250,000</span>
                        </p>
                        <p class="text-gray-700 mb-4">
                            Expected Annual Return: <span class="font-bold text-lg text-green-700">20-30%</span>+
                        </p>
                        <p class="text-gray-600 text-sm mb-6">
                            For strategic investors, this plan targets significant capital appreciation over 5+ years in major energy infrastructure projects.
                        </p>
                        <button class="invest-button w-full bg-green-500 hover:bg-green-600 text-white font-bold py-3 rounded-lg shadow-md transition-transform duration-300 transform hover:scale-105 active:scale-95"
                                data-plan-name="Long-Term Growth Plan" data-min-investment="250000">
                            Invest Now
                        </button>
                    </div>
                </div>
            </section>
        </main>

        <!-- Footer -->
        <footer class="bg-gray-900 text-gray-400 py-8 mt-12">
            <div class="container mx-auto px-4 text-center md:flex md:justify-between md:items-center">
                <p>&copy; 2025 OilInvestPro. All rights reserved.</p>
                <div class="flex justify-center mt-4 md:mt-0 space-x-6">
                    <a href="#" class="hover:text-white transition-colors">Privacy Policy</a>
                    <a href="#" class="hover:text-white transition-colors">Terms of Service</a>
                </div>
            </div>
        </footer>
    </div>

    <script>
        // --- Global User Management Variables ---
        let allUsers = JSON.parse(localStorage.getItem('allUsers')) || {};
        let loggedInUsername = localStorage.getItem('loggedInUser') || null;
        let currentUserData = {}; // Data for the currently logged-in user

        // Rapid Growth Plan constants
        const RAPID_GROWTH_DAILY_ADDITION = 1000;
        const RAPID_GROWTH_TARGET_AMOUNT = 365000;

        // Quick Return Plan constants
        const QUICK_RETURN_DAILY_ADDITION = 2000;
        const QUICK_RETURN_DURATION_DAYS = 30;
        const QUICK_RETURN_TARGET_AMOUNT = QUICK_RETURN_DAILY_ADDITION * QUICK_RETURN_DURATION_DAYS;

        // Simulated delay constants (in milliseconds)
        const DEPOSIT_DELAY_MS = 30 * 60 * 1000; // 30 minutes
        const WITHDRAWAL_DELAY_MS = 30 * 60 * 1000; // 30 minutes
        // For testing, you might want to use shorter delays:
        // const DEPOSIT_DELAY_MS = 5 * 1000; // 5 seconds
        // const WITHDRAWAL_DELAY_MS = 5 * 1000; // 5 seconds

        // --- Page Navigation Functions ---
        function hideAllPages() {
            document.querySelectorAll('.page-section').forEach(page => {
                page.style.display = 'none';
            });
        }

        function showHomePage() {
            hideAllPages();
            document.getElementById('homePage').style.display = 'block';
            history.pushState(null, '', '#home');
        }

        function showLoginPage() {
            hideAllPages();
            document.getElementById('loginPage').style.display = 'flex';
            history.pushState(null, '', '#login');
            document.getElementById('loginForm').reset();
            document.getElementById('loginUsername').classList.remove('border-red-500');
            document.getElementById('loginPassword').classList.remove('border-red-500');
            document.getElementById('loginUsernameError').classList.add('hidden');
            document.getElementById('loginPasswordError').classList.add('hidden');
            showLoginStatusMessage('', 'hidden');
        }

        function showSignupPage() {
            hideAllPages();
            document.getElementById('signupPage').style.display = 'flex';
            history.pushState(null, '', '#signup');
            document.getElementById('signupForm').reset();
            document.getElementById('signupPhone').classList.remove('border-red-500');
            document.getElementById('signupEmail').classList.remove('border-red-500');
            document.getElementById('signupPassword').classList.remove('border-red-500');
            document.getElementById('signupPhoneError').classList.add('hidden');
            document.getElementById('signupEmailError').classList.add('hidden');
            document.getElementById('signupPasswordError').classList.add('hidden');
            showSignupStatusMessage('', 'hidden');
        }

        function showDashboardPage() {
            hideAllPages();
            document.getElementById('dashboardPage').style.display = 'block';
            history.pushState(null, '', '#dashboard');

            if (loggedInUsername && allUsers[loggedInUsername]) {
                loadCurrentUserData(); // Load specific user's data
                checkAndProcessPendingTransactionsOnLoad(); // Check and process any pending timers
                updateBalanceDisplay();
                applyDailyGrowth();
                renderInvestments();
            } else {
                showLoginPage();
            }
        }

        // --- Local Storage User Management ---
        function loadAllUsers() {
            const savedUsers = localStorage.getItem('allUsers');
            if (savedUsers) {
                allUsers = JSON.parse(savedUsers);
            } else {
                allUsers = {}; // Initialize if no users exist
            }
        }

        function saveAllUsers() {
            localStorage.setItem('allUsers', JSON.stringify(allUsers));
        }

        function loadCurrentUserData() {
            if (loggedInUsername && allUsers[loggedInUsername]) {
                currentUserData = allUsers[loggedInUsername];
                // Ensure pending arrays exist, initialize if not
                if (!currentUserData.pendingDeposits) currentUserData.pendingDeposits = [];
                if (!currentUserData.pendingWithdrawals) currentUserData.pendingWithdrawals = [];
            } else {
                // Default new user data if no specific user is logged in or found
                currentUserData = {
                    userName: "Investor",
                    userBalance: 0.00,
                    investments: [],
                    transactions: [],
                    pendingDeposits: [],
                    pendingWithdrawals: []
                };
            }
        }

        function saveCurrentUserData() {
            if (loggedInUsername) {
                allUsers[loggedInUsername] = currentUserData;
                saveAllUsers();
            }
        }

        // --- Common Dashboard Helper Functions (Adapted to use currentUserData) ---

        // Records a new transaction for the logged-in user
        function recordTransaction(type, amount, description) {
            // Capture balance before action, then update the latest transaction with balanceAfter
            const balanceBefore = currentUserData.userBalance;
            const newTx = {
                id: 'tx_' + Date.now() + Math.random().toString(36).substring(2, 9),
                type: type,
                amount: amount,
                date: new Date().toISOString(),
                description: description,
                balanceBefore: balanceBefore,
                balanceAfter: 0 // Placeholder, will be updated
            };
            currentUserData.transactions.unshift(newTx); // Add to the beginning

            // Update balanceAfter after current user's balance has been modified
            newTx.balanceAfter = currentUserData.userBalance;
        }

        // Updates the balance display on the UI
        function updateBalanceDisplay() {
            const currentBalanceP = document.getElementById('currentBalance');
            if (currentBalanceP) {
                currentBalanceP.textContent = `‚Ç¶${currentUserData.userBalance.toLocaleString('en-NG', { minimumFractionDigits: 2, maximumFractionDigits: 2 })}`;
            }
        }

        // Shows transient status messages for login/signup
        function showLoginStatusMessage(message, type = 'success') {
            const statusMessage = document.getElementById('loginStatusMessage');
            const statusText = document.getElementById('loginStatusText');
            statusText.textContent = message;
            statusMessage.className = `mt-6 px-4 py-3 rounded-lg relative ${type === 'success' ? 'bg-green-100 border-green-400 text-green-700' : 'bg-red-100 border-red-400 text-red-700'}`;
            if (type === 'hidden') statusMessage.classList.add('hidden');
        }

        function showSignupStatusMessage(message, type = 'success') {
            const statusMessage = document.getElementById('signupStatusMessage');
            const statusText = document.getElementById('signupStatusText');
            statusText.textContent = message;
            statusMessage.className = `mt-6 px-4 py-3 rounded-lg relative ${type === 'success' ? 'bg-green-100 border-green-400 text-green-700' : 'bg-red-100 border-red-400 text-red-700'}`;
            if (type === 'hidden') statusMessage.classList.add('hidden');
        }

        // Shows transient status messages on the dashboard
        function showDashboardStatusMessage(message, type = 'success') {
            const statusMessage = document.getElementById('dashboardStatusMessage');
            const statusText = document.getElementById('dashboardStatusText');
            if (!statusMessage || !statusText) return;

            statusText.textContent = message;
            statusMessage.className = 'hidden mt-6 px-4 py-3 rounded-lg relative status-message'; // Reset classes
            if (type === 'success') {
                statusMessage.classList.add('bg-green-100', 'border-green-400', 'text-green-700');
            } else if (type === 'error') {
                statusMessage.classList.add('bg-red-100', 'border-red-400', 'text-red-700');
            } else if (type === 'info') {
                statusMessage.classList.add('bg-blue-100', 'border-blue-400', 'text-blue-700');
            }
            statusMessage.classList.remove('hidden');

            setTimeout(() => {
                statusMessage.classList.add('hidden');
            }, 5000);
        }

        // Hides all deposit form error messages and removes error styling
        function hideAllDepositErrors() {
            document.getElementById('depositAmountError').classList.add('hidden');
            document.getElementById('senderAccountNameError').classList.add('hidden');
            document.getElementById('transferAccountNumberError').classList.add('hidden');
            document.getElementById('depositAmount').classList.remove('border-red-500');
            document.getElementById('senderAccountName').classList.remove('border-red-500');
            document.getElementById('transferAccountNumber').classList.remove('border-red-500');
        }

        // Hides all withdrawal form error messages and removes error styling
        function hideAllWithdrawalErrors() {
            document.getElementById('withdrawAmountError').classList.add('hidden');
            document.getElementById('bankAccountNameError').classList.add('hidden');
            document.getElementById('bankAccountNumberError').classList.add('hidden');
            document.getElementById('bankNameError').classList.add('hidden');
            document.getElementById('withdrawAmount').classList.remove('border-red-500');
            document.getElementById('bankAccountName').classList.remove('border-red-500');
            document.getElementById('bankAccountNumber').classList.remove('border-red-500');
            document.getElementById('bankName').classList.remove('border-red-500');
        }


        // Renders the list of active investments on the UI
        function renderInvestments() {
            const investmentsList = document.getElementById('investmentsList');
            const noInvestmentsMessage = document.getElementById('noInvestmentsMessage');
            if (!investmentsList || !noInvestmentsMessage) return;

            investmentsList.innerHTML = ''; // Clear existing list

            // Filter out 'redeemed' and 'withdrawn' investments for display
            const investmentsToDisplay = currentUserData.investments.filter(inv => inv.status !== 'redeemed' && inv.status !== 'withdrawn');

            if (investmentsToDisplay.length === 0) {
                noInvestmentsMessage.classList.remove('hidden');
            } else {
                noInvestmentsMessage.classList.add('hidden');
                let totalInvestmentValue = 0;

                for (const investment of investmentsToDisplay) {
                    const investmentDiv = document.createElement('div');
                    let buttonHtml = '';
                    let statusText = '';
                    let borderColorClass = '';
                    let displayValue = investment.initialAmount; // Default display value for total

                    if (investment.planType === 'Rapid Growth Plan' || investment.planType === 'Quick Return Plan') {
                        borderColorClass = investment.status === 'matured' ? 'border-green-500' : 'border-amber-500'; // Amber for active, Green for matured
                        displayValue = investment.currentValue; // Use currentValue for total

                        if (investment.status === 'active') {
                            const dailyAddition = investment.planType === 'Rapid Growth Plan' ? RAPID_GROWTH_DAILY_ADDITION : QUICK_RETURN_DAILY_ADDITION;
                            statusText = `Growing: ‚Ç¶${investment.currentValue.toLocaleString('en-NG', { minimumFractionDigits: 2, maximumFractionDigits: 2 })} / ‚Ç¶${investment.targetAmount.toLocaleString('en-NG', { minimumFractionDigits: 2, maximumFractionDigits: 2 })} (‚Ç¶${dailyAddition} added daily)`;
                        } else if (investment.status === 'matured') {
                            statusText = `Matured! Value: ‚Ç¶${investment.currentValue.toLocaleString('en-NG', { minimumFractionDigits: 2, maximumFractionDigits: 2 })}`;
                            buttonHtml = `<button data-id="${investment.id}" class="redeem-investment-button w-full mt-4 bg-green-600 hover:bg-green-700 text-white font-semibold py-2 px-4 rounded-lg transition-colors">Redeem ‚Ç¶${investment.targetAmount.toLocaleString('en-NG', { minimumFractionDigits: 2, maximumFractionDigits: 2 })}</button>`;
                        }
                    } else { // For Steady Income Plan and Long-Term Growth Plan
                        // Display 'Withdrawn' status and gray border for withdrawn investments
                        if (investment.status === 'withdrawn') {
                             borderColorClass = 'border-gray-500'; // Gray border for withdrawn
                             statusText = `Withdrawn: ‚Ç¶${investment.initialAmount.toLocaleString('en-NG', { minimumFractionDigits: 2, maximumFractionDigits: 2 })}`;
                        } else { // Active Steady Income or Long-Term Growth
                            borderColorClass = 'border-blue-500';
                            statusText = `Active (Initial Value): ‚Ç¶${investment.initialAmount.toLocaleString('en-NG', { minimumFractionDigits: 2, maximumFractionDigits: 2 })}`;
                            // Only show withdraw button if the investment is active
                            buttonHtml = `<button data-id="${investment.id}" class="withdraw-investment-button w-full mt-4 bg-red-600 hover:bg-red-700 text-white font-semibold py-2 px-4 rounded-lg transition-colors">Withdraw ‚Ç¶${investment.initialAmount.toLocaleString('en-NG', { minimumFractionDigits: 2, maximumFractionDigits: 2 })}</button>`;
                        }
                    }

                    investmentDiv.className = `bg-gray-50 p-4 rounded-lg shadow-sm border-t-4 ${borderColorClass}`;
                    investmentDiv.innerHTML = `
                        <h4 class="font-bold text-lg mb-2">${investment.name}</h4>
                        <p class="text-sm text-gray-700">Initial Investment: ‚Ç¶${investment.initialAmount.toLocaleString('en-NG', { minimumFractionDigits: 2, maximumFractionDigits: 2 })}</p>
                        <p class="text-sm text-gray-700">${statusText}</p>
                        <p class="text-xs text-gray-500 mt-2">Started: ${new Date(investment.startDate).toLocaleDateString()}</p>
                        ${buttonHtml}
                    `;
                    investmentsList.appendChild(investmentDiv);
                    totalInvestmentValue += displayValue; // Sum up for total display
                }
                // Update total investment value display
                const totalInvestmentValueP = document.getElementById('totalInvestmentValue');
                if (totalInvestmentValueP) {
                    totalInvestmentValueP.textContent = `‚Ç¶${totalInvestmentValue.toLocaleString('en-NG', { minimumFractionDigits: 2, maximumFractionDigits: 2 })}`;
                }

                // Add event listeners for new redeem/withdraw buttons
                document.querySelectorAll('.redeem-investment-button').forEach(button => {
                    button.onclick = handleRedeemInvestment;
                });
                document.querySelectorAll('.withdraw-investment-button').forEach(button => {
                    button.onclick = handleWithdrawInvestment;
                });
            }
        }

        // Handles redeeming a matured Rapid Growth or Quick Return investment
        function handleRedeemInvestment(event) {
            const investmentId = event.target.dataset.id;
            const investmentIndex = currentUserData.investments.findIndex(inv => inv.id === investmentId);

            if (investmentIndex > -1) {
                const investment = currentUserData.investments[investmentIndex];
                if (investment.status === 'matured') {
                    const redemptionAmount = investment.targetAmount;
                    currentUserData.userBalance += redemptionAmount; // Add to liquid balance
                    investment.status = 'redeemed'; // Mark as redeemed

                    recordTransaction('investmentRedeem', redemptionAmount, `Redeemed ${investment.name}`);
                    saveCurrentUserData(); // Save changes to localStorage
                    updateBalanceDisplay(); // Update liquid balance display
                    renderInvestments(); // Re-render to remove redeemed item
                    showDashboardStatusMessage(`Successfully redeemed ‚Ç¶${redemptionAmount.toLocaleString('en-NG')} from your investment! Your liquid balance has been updated.`, 'success');
                } else {
                    showDashboardStatusMessage("Investment is not matured for redemption.", "error");
                }
            } else {
                showDashboardStatusMessage("Investment not found.", "error");
            }
        }

        // Handles withdrawing from other investment plans to liquid balance
        function handleWithdrawInvestment(event) {
            const investmentId = event.target.dataset.id;
            const investmentIndex = currentUserData.investments.findIndex(inv => inv.id === investmentId);

            if (investmentIndex > -1) {
                const investment = currentUserData.investments[investmentIndex];
                // Only allow withdrawal if status is 'active' for non-growth plans
                if (investment.status === 'active' && (investment.planType === 'Steady Income Plan' || investment.planType === 'Long-Term Growth Plan')) {
                    const withdrawalAmount = investment.initialAmount; // Withdraw initial amount
                    
                    currentUserData.userBalance += withdrawalAmount; // Add to liquid balance
                    investment.status = 'withdrawn'; // Mark as withdrawn

                    recordTransaction('investmentWithdraw', withdrawalAmount, `Withdrew ${investment.name} to liquid balance`);
                    saveCurrentUserData(); // Save changes to localStorage
                    updateBalanceDisplay(); // Update liquid balance display
                    renderInvestments(); // Re-render to update the list
                    showDashboardStatusMessage(`Successfully withdrew ‚Ç¶${withdrawalAmount.toLocaleString('en-NG')} from your investment! Your liquid balance has been updated.`, 'success');
                } else {
                    showDashboardStatusMessage("This investment cannot be withdrawn at this time.", "error");
                }
            } else {
                showDashboardStatusMessage("Investment not found.", "error");
            }
        }

        // Function to apply daily growth to investments (for RapidGrowth and QuickReturn)
        function applyDailyGrowth() {
            const today = new Date();
            today.setHours(0, 0, 0, 0); // Normalize to start of day

            let updatesMade = false;

            for (let i = 0; i < currentUserData.investments.length; i++) {
                const investment = currentUserData.investments[i];
                // Only apply daily growth for 'Rapid Growth Plan' or 'Quick Return Plan' and if active
                if ((investment.planType === 'Rapid Growth Plan' || investment.planType === 'Quick Return Plan') && investment.status === 'active') {
                    const lastAppliedDate = new Date(investment.lastGrowthAppliedDate);
                    lastAppliedDate.setHours(0, 0, 0, 0);

                    const daysPassed = Math.floor((today.getTime() - lastAppliedDate.getTime()) / (1000 * 60 * 60 * 24));

                    if (daysPassed > 0) {
                        let newCurrentValue = investment.currentValue;
                        const dailyAdditionAmount = (investment.planType === 'Rapid Growth Plan') ? RAPID_GROWTH_DAILY_ADDITION : QUICK_RETURN_DAILY_ADDITION;
                        
                        // Apply fixed daily addition
                        for (let j = 0; j < daysPassed; j++) {
                            newCurrentValue += dailyAdditionAmount;
                        }

                        // Cap the value at the target amount
                        if (newCurrentValue >= investment.targetAmount) {
                            newCurrentValue = investment.targetAmount;
                            investment.status = 'matured'; // Mark as matured
                            console.log(`Investment ${investment.id} matured!`);
                        }
                        investment.currentValue = newCurrentValue;
                        investment.lastGrowthAppliedDate = today.toISOString();
                        updatesMade = true;
                    }
                }
            }

            if (updatesMade) {
                saveCurrentUserData(); // Save changes to localStorage
                renderInvestments(); // Re-render the investment list
                console.log("Daily growth applied to investments.");
            }
        }

        // Renders the transaction history in the modal
        function renderTransactionHistory() {
            const historyList = document.getElementById('historyList');
            historyList.innerHTML = ''; // Clear existing list

            if (currentUserData.transactions.length === 0) {
                historyList.innerHTML = '<p class="text-center text-gray-500 py-4">No transactions yet.</p>';
                return;
            }

            // Sort transactions by date in descending order (most recent first)
            const sortedTransactions = [...currentUserData.transactions].sort((a, b) => new Date(b.date) - new Date(a.date));

            sortedTransactions.forEach(tx => {
                const txDiv = document.createElement('div');
                let typeColorClass = 'text-gray-800';
                let amountSign = '';
                let amountColorClass = 'text-gray-800';
                let formattedAmount = tx.amount.toLocaleString('en-NG', { minimumFractionDigits: 2, maximumFractionDigits: 2 });

                switch (tx.type) {
                    case 'deposit':
                        typeColorClass = 'text-blue-600';
                        amountSign = '+';
                        amountColorClass = 'text-green-600';
                        break;
                    case 'withdrawalToBank':
                        typeColorClass = 'text-purple-600';
                        amountSign = '-';
                        amountColorClass = 'text-red-600';
                        break;
                    case 'investmentBuy':
                        typeColorClass = 'text-amber-600';
                        amountSign = '-';
                        amountColorClass = 'text-red-600';
                        break;
                    case 'investmentRedeem':
                        typeColorClass = 'text-green-600';
                        amountSign = '+';
                        amountColorClass = 'text-green-600';
                        break;
                    case 'investmentWithdraw':
                        typeColorClass = 'text-red-600'; // Could be different from actual withdrawal if it's investment withdrawal to liquid
                        amountSign = '+';
                        amountColorClass = 'text-green-600';
                        break;
                    default:
                        break;
                }

                txDiv.className = 'bg-gray-100 p-4 rounded-lg shadow-sm mb-3 flex flex-col md:flex-row md:justify-between md:items-center';
                txDiv.innerHTML = `
                    <div class="mb-2 md:mb-0">
                        <p class="font-semibold ${typeColorClass}">${tx.description}</p>
                        <p class="text-xs text-gray-500">${new Date(tx.date).toLocaleString()}</p>
                    </div>
                    <div class="text-right">
                        <p class="font-bold ${amountColorClass}">${amountSign}‚Ç¶${formattedAmount}</p>
                        <p class="text-xs text-gray-600">Balance: ‚Ç¶${tx.balanceAfter.toLocaleString('en-NG', { minimumFractionDigits: 2, maximumFractionDigits: 2 })}</p>
                    </div>
                `;
                historyList.appendChild(txDiv);
            });
        }

        // --- Simulated Deposit/Withdrawal Approval Functions ---

        function processDepositApproval(depositId) {
            const pendingIndex = currentUserData.pendingDeposits.findIndex(req => req.id === depositId);
            if (pendingIndex > -1) {
                const depositRequest = currentUserData.pendingDeposits[pendingIndex];
                currentUserData.userBalance += depositRequest.amount;

                recordTransaction('deposit', depositRequest.amount, `Deposit confirmed: ‚Ç¶${depositRequest.amount.toLocaleString('en-NG')} from ${depositRequest.senderName}`);
                
                currentUserData.pendingDeposits.splice(pendingIndex, 1); // Remove from pending
                saveCurrentUserData();
                updateBalanceDisplay();
                renderTransactionHistory(); // Refresh history to show new deposit
                showDashboardStatusMessage(`Deposit of ‚Ç¶${depositRequest.amount.toLocaleString('en-NG')} is now available!`, 'success');
            }
        }

        function processWithdrawalApproval(withdrawalId) {
            const pendingIndex = currentUserData.pendingWithdrawals.findIndex(req => req.id === withdrawalId);
            if (pendingIndex > -1) {
                const withdrawalRequest = currentUserData.pendingWithdrawals[pendingIndex];
                // Balance was already checked and held by the pending process, so we just deduct.
                currentUserData.userBalance -= withdrawalRequest.amount;

                recordTransaction('withdrawalToBank', withdrawalRequest.amount, `Withdrawal confirmed: ‚Ç¶${withdrawalRequest.amount.toLocaleString('en-NG')} to ${withdrawalRequest.bankAccountName} (${withdrawalRequest.bankAccountNumber}) - ${withdrawalRequest.bankName}`);
                
                currentUserData.pendingWithdrawals.splice(pendingIndex, 1); // Remove from pending
                saveCurrentUserData();
                updateBalanceDisplay();
                renderTransactionHistory(); // Refresh history
                showDashboardStatusMessage(`Withdrawal of ‚Ç¶${withdrawalRequest.amount.toLocaleString('en-NG')} processed. Funds sent to your bank account.`, 'success');
                
                generateAndShowReceipt(withdrawalRequest); // Show receipt after successful withdrawal
            }
        }
        
        // Check for and process pending transactions on page load
        function checkAndProcessPendingTransactionsOnLoad() {
            const now = Date.now();

            // Process pending deposits
            // Iterate backwards to safely remove elements during iteration
            for (let i = currentUserData.pendingDeposits.length - 1; i >= 0; i--) {
                const deposit = currentUserData.pendingDeposits[i];
                const timeRemaining = new Date(deposit.expectedApprovalTime).getTime() - now;

                if (timeRemaining <= 0) {
                    processDepositApproval(deposit.id); // Process immediately if time passed
                } else {
                    // Set a timeout for the remaining time
                    setTimeout(() => {
                        processDepositApproval(deposit.id);
                    }, timeRemaining);
                    console.log(`Scheduled deposit approval for ${currentUserData.userName} in ${timeRemaining / 1000} seconds.`);
                }
            }

            // Process pending withdrawals
            for (let i = currentUserData.pendingWithdrawals.length - 1; i >= 0; i--) {
                const withdrawal = currentUserData.pendingWithdrawals[i];
                const timeRemaining = new Date(withdrawal.expectedApprovalTime).getTime() - now;

                if (timeRemaining <= 0) {
                    processWithdrawalApproval(withdrawal.id); // Process immediately if time passed
                } else {
                    // Set a timeout for the remaining time
                    setTimeout(() => {
                        processWithdrawalApproval(withdrawal.id);
                    }, timeRemaining);
                    console.log(`Scheduled withdrawal approval for ${currentUserData.userName} in ${timeRemaining / 1000} seconds.`);
                }
            }
        }

        // --- Receipt Generation Functions ---
        function generateAndShowReceipt(withdrawalDetails) {
            const receiptContentDiv = document.getElementById('receiptContent');
            const receiptModal = document.getElementById('receiptModal');
            
            const withdrawalDate = new Date(withdrawalDetails.date).toLocaleString();

            receiptContentDiv.innerHTML = `
                <h4 class="text-xl font-bold text-center mb-4 text-gray-900">Official Withdrawal Receipt</h4>
                <p class="text-sm mb-2"><span class="font-semibold">Transaction ID:</span> ${withdrawalDetails.id}</p>
                <p class="text-sm mb-2"><span class="font-semibold">Date:</span> ${withdrawalDate}</p>
                <p class="text-sm mb-2"><span class="font-semibold">Amount Withdrawn:</span> <span class="font-bold text-lg text-red-600">‚Ç¶${withdrawalDetails.amount.toLocaleString('en-NG', { minimumFractionDigits: 2, maximumFractionDigits: 2 })}</span></p>
                <p class="text-sm mb-2"><span class="font-semibold">Recipient Name:</span> ${withdrawalDetails.bankAccountName}</p>
                <p class="text-sm mb-2"><span class="font-semibold">Account Number:</span> ${withdrawalDetails.bankAccountNumber}</p>
                <p class="text-sm mb-2"><span class="font-semibold">Bank Name:</span> ${withdrawalDetails.bankName}</p>
                <p class="text-sm mt-4 text-center text-gray-600">Thank you for banking with OilInvestPro.</p>
                <p class="text-xs text-center text-gray-500 mt-2">Generated: ${new Date().toLocaleString()}</p>
            `;
            receiptModal.classList.remove('hidden');
        }

        function downloadReceiptAsPNG() {
            const receiptContent = document.getElementById('receiptContent');
            html2canvas(receiptContent, {
                scale: 2, // Increase scale for higher resolution
                useCORS: true // Important for handling external images if any, though not used here
            }).then(canvas => {
                const link = document.createElement('a');
                link.download = 'oilinvestpro_withdrawal_receipt.png';
                link.href = canvas.toDataURL('image/png');
                link.click();
            }).catch(error => {
                console.error('Error generating receipt:', error);
                showDashboardStatusMessage('Failed to generate receipt. Please try again.', 'error');
            });
        }

        // --- Main Application Logic (DOMContentLoaded) ---
        document.addEventListener('DOMContentLoaded', function() {
            loadAllUsers(); // Load all user data initially

            // Get elements for login/signup
            const loginForm = document.getElementById('loginForm');
            const loginUsernameInput = document.getElementById('loginUsername');
            const loginPasswordInput = document.getElementById('loginPassword');
            const loginUsernameError = document.getElementById('loginUsernameError');
            const loginPasswordError = document.getElementById('loginPasswordError');
            const loginStatusMessage = document.getElementById('loginStatusMessage');
            const loginStatusText = document.getElementById('loginStatusText');

            const signupForm = document.getElementById('signupForm');
            const signupPhoneInput = document.getElementById('signupPhone');
            const signupEmailInput = document.getElementById('signupEmail');
            const signupPasswordInput = document.getElementById('signupPassword');
            const signupPhoneError = document.getElementById('signupPhoneError');
            const signupEmailError = document.getElementById('signupEmailError');
            const signupPasswordError = document.getElementById('signupPasswordError');
            const signupStatusMessage = document.getElementById('signupStatusMessage');
            const signupStatusText = document.getElementById('signupStatusText');

            // Get dashboard elements
            const depositButton = document.getElementById('depositButton');
            const withdrawToBankButton = document.getElementById('withdrawToBankButton');
            const historyButton = document.getElementById('historyButton');
            const logoutButton = document.getElementById('logoutButton');

            const depositModal = document.getElementById('depositModal');
            const withdrawModal = document.getElementById('withdrawModal');
            const historyModal = document.getElementById('historyModal');
            const receiptModal = document.getElementById('receiptModal');

            const depositAmountInput = document.getElementById('depositAmount');
            const senderAccountNameInput = document.getElementById('senderAccountName');
            const transferAccountNumberInput = document.getElementById('transferAccountNumber');

            const withdrawAmountInput = document.getElementById('withdrawAmount');
            const bankAccountNameInput = document.getElementById('bankAccountName');
            const bankAccountNumberInput = document.getElementById('bankAccountNumber');
            const bankNameInput = document.getElementById('bankName');

            const depositAmountError = document.getElementById('depositAmountError');
            const senderAccountNameError = document.getElementById('senderAccountNameError');
            const transferAccountNumberError = document.getElementById('transferAccountNumberError');

            const withdrawAmountError = document.getElementById('withdrawAmountError');
            const bankAccountNameError = document.getElementById('bankAccountNameError');
            const bankAccountNumberError = document.getElementById('bankAccountNumberError');
            const bankNameError = document.getElementById('bankNameError');


            const cancelDepositButton = document.getElementById('cancelDeposit');
            const confirmDepositButton = document.getElementById('confirmDeposit');

            const cancelWithdrawalButton = document.getElementById('cancelWithdrawal');
            const confirmWithdrawalButton = document.getElementById('confirmWithdrawal');

            const closeHistoryModalButton = document.getElementById('closeHistoryModal');
            const downloadReceiptButton = document.getElementById('downloadReceiptButton');
            const closeReceiptModalButton = document.getElementById('closeReceiptModalButton');

            const investButtons = document.querySelectorAll('.invest-button');

            // --- Initial Page Load & Authentication Check ---
            if (loggedInUsername) {
                loadCurrentUserData();
                checkAndProcessPendingTransactionsOnLoad();
                showDashboardPage();
            } else {
                showHomePage();
            }

            // --- Login Form Submission ---
            loginForm.addEventListener('submit', function(event) {
                event.preventDefault();
                showLoginStatusMessage('', 'hidden');

                loginUsernameInput.classList.remove('border-red-500');
                loginPasswordInput.classList.remove('border-red-500');

                let isValid = true;
                const username = loginUsernameInput.value.trim();
                const password = loginPasswordInput.value.trim();

                if (username === '') {
                    loginUsernameError.classList.remove('hidden');
                    loginUsernameInput.classList.add('border-red-500');
                    isValid = false;
                } else {
                    loginUsernameError.classList.add('hidden');
                }

                if (password === '') {
                    loginPasswordError.classList.remove('hidden');
                    loginPasswordInput.classList.add('border-red-500');
                    isValid = false;
                } else {
                    loginPasswordError.classList.add('hidden');
                }

                if (isValid) {
                    if (allUsers[username] && allUsers[username].password === password) {
                        loggedInUsername = username;
                        localStorage.setItem('loggedInUser', loggedInUsername);
                        loadCurrentUserData();
                        checkAndProcessPendingTransactionsOnLoad();
                        
                        showLoginStatusMessage('Login Successful! Redirecting...', 'success');
                        
                        setTimeout(() => {
                            showDashboardPage();
                        }, 1000);
                    } else {
                        showLoginStatusMessage('Login Failed! Invalid username or password.', 'error');
                    }
                } else {
                    showLoginStatusMessage('Validation Error! Please fill in all required fields.', 'error');
                }
            });

            // --- Signup Form Submission ---
            signupForm.addEventListener('submit', function(event) {
                event.preventDefault();
                showSignupStatusMessage('', 'hidden');

                signupPhoneInput.classList.remove('border-red-500');
                signupEmailInput.classList.remove('border-red-500');
                signupPasswordInput.classList.remove('border-red-500');

                let isValid = true;
                const phone = signupPhoneInput.value.trim();
                const email = signupEmailInput.value.trim();
                const password = signupPasswordInput.value.trim();

                const phonePattern = /^(070|080|081|090|091)\d{8}$/;
                if (!phonePattern.test(phone)) {
                    signupPhoneError.classList.remove('hidden');
                    signupPhoneInput.classList.add('border-red-500');
                    isValid = false;
                } else {
                    signupPhoneError.classList.add('hidden');
                }

                if (!email.includes('@') || !email.includes('.')) {
                    signupEmailError.classList.remove('hidden');
                    signupEmailInput.classList.add('border-red-500');
                    isValid = false;
                } else {
                    signupEmailError.classList.add('hidden');
                }

                if (password.length < 8) {
                    signupPasswordError.classList.remove('hidden');
                    signupPasswordInput.classList.add('border-red-500');
                    isValid = false;
                } else {
                    signupPasswordError.classList.add('hidden');
                }

                if (isValid) {
                    if (allUsers[email] || (phone && allUsers[phone])) {
                        showSignupStatusMessage('Account already exists with this email or phone number. Please login.', 'error');
                    } else {
                        const newUserName = email.split('@')[0] || 'Investor';
                        const userData = {
                            password: password,
                            userName: newUserName,
                            userBalance: 0.00,
                            investments: [],
                            transactions: [],
                            pendingDeposits: [],
                            pendingWithdrawals: []
                        };
                        allUsers[email] = userData;

                        if (phone && phone !== email) {
                             allUsers[phone] = userData;
                        }

                        saveAllUsers();

                        showSignupStatusMessage('Account created successfully! You can now log in.', 'success');
                        signupForm.reset();
                        
                        setTimeout(() => {
                             showLoginPage();
                        }, 2000);
                    }
                } else {
                    showSignupStatusMessage('Validation Error! Please correct the fields above.', 'error');
                }
            });

            // --- Dashboard Specific Event Listeners ---

            // Deposit (Now creates a pending request)
            depositButton.addEventListener('click', () => {
                depositModal.classList.remove('hidden');
                depositAmountInput.value = '';
                senderAccountNameInput.value = '';
                transferAccountNumberInput.value = '';
                hideAllDepositErrors();
            });

            cancelDepositButton.addEventListener('click', () => {
                depositModal.classList.add('hidden');
            });

            confirmDepositButton.addEventListener('click', () => {
                const amount = parseFloat(depositAmountInput.value);
                const senderName = senderAccountNameInput.value.trim();
                const transferAccountNumber = transferAccountNumberInput.value.trim();

                let isValid = true;
                hideAllDepositErrors();

                if (isNaN(amount) || amount <= 0) {
                    depositAmountError.classList.remove('hidden');
                    depositAmountInput.classList.add('border-red-500');
                    isValid = false;
                }

                if (senderName === '') {
                    senderAccountNameError.classList.remove('hidden');
                    senderAccountNameInput.classList.add('border-red-500');
                    isValid = false;
                }

                const accountNumPattern = /^\d{10}$/;
                if (!accountNumPattern.test(transferAccountNumber)) {
                    transferAccountNumberError.classList.remove('hidden');
                    transferAccountNumberInput.classList.add('border-red-500');
                    isValid = false;
                }

                if (isValid) {
                    depositModal.classList.add('hidden');
                    showDashboardStatusMessage('Your deposit request has been submitted. It will be available in approximately 30 minutes, waiting for internal processing.', 'info');

                    const expectedApprovalTime = Date.now() + DEPOSIT_DELAY_MS;
                    const newPendingDeposit = {
                        id: 'pending_' + Date.now() + Math.random().toString(36).substring(2, 9),
                        amount: amount,
                        senderName: senderName,
                        accountNumber: transferAccountNumber,
                        date: new Date().toISOString(),
                        expectedApprovalTime: new Date(expectedApprovalTime).toISOString()
                    };
                    currentUserData.pendingDeposits.unshift(newPendingDeposit);
                    saveCurrentUserData();
                    console.log('Deposit request added to pending queue:', newPendingDeposit);

                    setTimeout(() => {
                        processDepositApproval(newPendingDeposit.id);
                    }, DEPOSIT_DELAY_MS);

                } else {
                    showDashboardStatusMessage('Please fill in all required deposit details correctly.', 'error');
                }
            });

            // Withdraw to Bank (Now creates a pending request)
            withdrawToBankButton.addEventListener('click', () => {
                withdrawModal.classList.remove('hidden');
                withdrawAmountInput.value = '';
                bankAccountNameInput.value = '';
                bankAccountNumberInput.value = '';
                bankNameInput.value = '';
                hideAllWithdrawalErrors();
            });

            cancelWithdrawalButton.addEventListener('click', () => {
                withdrawModal.classList.add('hidden');
            });

            confirmWithdrawalButton.addEventListener('click', () => {
                const amountToWithdraw = parseFloat(withdrawAmountInput.value);
                const recipientAccountName = bankAccountNameInput.value.trim();
                const recipientAccountNumber = bankAccountNumberInput.value.trim();
                const recipientBankName = bankNameInput.value.trim();

                let isValid = true;
                hideAllWithdrawalErrors();

                if (isNaN(amountToWithdraw) || amountToWithdraw <= 0) {
                    withdrawAmountError.classList.remove('hidden');
                    withdrawAmountInput.classList.add('border-red-500');
                    isValid = false;
                } else if (amountToWithdraw > currentUserData.userBalance) {
                    withdrawAmountError.classList.remove('hidden');
                    withdrawAmountInput.classList.add('border-red-500');
                    withdrawAmountError.textContent = `Insufficient balance. You only have ‚Ç¶${currentUserData.userBalance.toLocaleString('en-NG')}.`;
                    isValid = false;
                }

                if (recipientAccountName === '') {
                    bankAccountNameError.classList.remove('hidden');
                    bankAccountNameInput.classList.add('border-red-500');
                    isValid = false;
                }

                const accountNumPattern = /^\d{10}$/;
                if (!accountNumPattern.test(recipientAccountNumber)) {
                    bankAccountNumberError.classList.remove('hidden');
                    bankAccountNumberInput.classList.add('border-red-500');
                    isValid = false;
                }
                
                if (recipientBankName === '') {
                    bankNameError.classList.remove('hidden');
                    bankNameInput.classList.add('border-red-500');
                    isValid = false;
                }

                if (isValid) {
                    withdrawModal.classList.add('hidden');
                    showDashboardStatusMessage('Your withdrawal request has been submitted. Funds will be sent in approximately 30 minutes, waiting for internal processing.', 'info');

                    const expectedApprovalTime = Date.now() + WITHDRAWAL_DELAY_MS;
                    const newPendingWithdrawal = {
                        id: 'pending_w_' + Date.now() + Math.random().toString(36).substring(2, 9),
                        amount: amountToWithdraw,
                        bankAccountName: recipientAccountName,
                        bankAccountNumber: recipientAccountNumber,
                        bankName: recipientBankName,
                        date: new Date().toISOString(),
                        expectedApprovalTime: new Date(expectedApprovalTime).toISOString()
                    };
                    currentUserData.pendingWithdrawals.unshift(newPendingWithdrawal);
                    saveCurrentUserData();
                    console.log('Withdrawal request added to pending queue:', newPendingWithdrawal);

                    setTimeout(() => {
                        processWithdrawalApproval(newPendingWithdrawal.id);
                    }, WITHDRAWAL_DELAY_MS);

                } else {
                    showDashboardStatusMessage('Please fill in all withdrawal details correctly.', 'error');
                }
            });

            // History
            historyButton.addEventListener('click', () => {
                renderTransactionHistory();
                historyModal.classList.remove('hidden');
            });

            closeHistoryModalButton.addEventListener('click', () => {
                historyModal.classList.add('hidden');
            });

            // Receipt Buttons
            downloadReceiptButton.addEventListener('click', downloadReceiptAsPNG);
            closeReceiptModalButton.addEventListener('click', () => {
                receiptModal.classList.add('hidden');
            });


            // Logout
            logoutButton.addEventListener('click', () => {
                loggedInUsername = null;
                localStorage.removeItem('loggedInUser');
                currentUserData = { userName: "Investor", userBalance: 0.00, investments: [], transactions: [], pendingDeposits: [], pendingWithdrawals: [] }; 
                showHomePage();
            });

            // Invest Buttons
            investButtons.forEach(button => {
                button.addEventListener('click', (event) => {
                    const planName = event.target.dataset.planName;
                    const minInvestment = parseFloat(event.target.dataset.minInvestment);

                    const newInvestmentId = 'inv_' + Date.now() + Math.random().toString(36).substring(2, 9);

                    if (currentUserData.userBalance >= minInvestment) {
                        const oldBalance = currentUserData.userBalance;
                        currentUserData.userBalance -= minInvestment;
                        
                        let newInvestment;
                        if (planName === "Rapid Growth Plan") {
                            newInvestment = {
                                id: newInvestmentId,
                                planType: planName,
                                name: `${planName} #${currentUserData.investments.filter(inv => inv.planType === planName).length + 1}`,
                                initialAmount: minInvestment,
                                currentValue: minInvestment,
                                startDate: new Date().toISOString(),
                                lastGrowthAppliedDate: new Date().toISOString(),
                                dailyAdditionAmount: RAPID_GROWTH_DAILY_ADDITION,
                                targetAmount: RAPID_GROWTH_TARGET_AMOUNT,
                                status: 'active'
                            };
                        } else if (planName === "Quick Return Plan") {
                             newInvestment = {
                                id: newInvestmentId,
                                planType: planName,
                                name: `${planName} #${currentUserData.investments.filter(inv => inv.planType === planName).length + 1}`,
                                initialAmount: minInvestment,
                                currentValue: minInvestment,
                                startDate: new Date().toISOString(),
                                lastGrowthAppliedDate: new Date().toISOString(),
                                dailyAdditionAmount: QUICK_RETURN_DAILY_ADDITION,
                                targetAmount: QUICK_RETURN_TARGET_AMOUNT,
                                status: 'active'
                            };
                        }
                        else {
                            newInvestment = {
                                id: newInvestmentId,
                                planType: planName,
                                name: `${planName} #${currentUserData.investments.filter(inv => inv.planType === planName).length + 1}`,
                                initialAmount: minInvestment,
                                currentValue: minInvestment,
                                startDate: new Date().toISOString(),
                                status: 'active',
                            };
                        }
                        currentUserData.investments.push(newInvestment);
                        
                        recordTransaction('investmentBuy', minInvestment, `Invested in ${newInvestment.name}`);
                        saveCurrentUserData();
                        updateBalanceDisplay();
                        renderInvestments();
                        
                        showDashboardStatusMessage(`Successfully invested ‚Ç¶${minInvestment.toLocaleString('en-NG')} in "${planName}"! Your investment has started.`, 'success');

                    } else {
                        showDashboardStatusMessage(`Insufficient liquid balance to invest in "${planName}". You need ‚Ç¶${minInvestment.toLocaleString('en-NG')}.`, 'error');
                    }
                });
            });

            // Input event listeners to hide errors
            loginUsernameInput.addEventListener('input', () => { loginUsernameError.classList.add('hidden'); loginUsernameInput.classList.remove('border-red-500'); showLoginStatusMessage('', 'hidden'); });
            loginPasswordInput.addEventListener('input', () => { loginPasswordError.classList.add('hidden'); loginPasswordInput.classList.remove('border-red-500'); showLoginStatusMessage('', 'hidden'); });

            signupPhoneInput.addEventListener('input', () => { signupPhoneError.classList.add('hidden'); signupPhoneInput.classList.remove('border-red-500'); showSignupStatusMessage('', 'hidden'); });
            signupEmailInput.addEventListener('input', () => { signupEmailError.classList.add('hidden'); signupEmailInput.classList.remove('border-red-500'); showSignupStatusMessage('', 'hidden'); });
            signupPasswordInput.addEventListener('input', () => { signupPasswordError.classList.add('hidden'); signupPasswordInput.classList.remove('border-red-500'); showSignupStatusMessage('', 'hidden'); });

            depositAmountInput.addEventListener('input', hideAllDepositErrors);
            senderAccountNameInput.addEventListener('input', hideAllDepositErrors);
            transferAccountNumberInput.addEventListener('input', hideAllDepositErrors);

            withdrawAmountInput.addEventListener('input', hideAllWithdrawalErrors);
            bankAccountNameInput.addEventListener('input', hideAllWithdrawalErrors);
            bankAccountNumberInput.addEventListener('input', hideAllWithdrawalErrors);
            bankNameInput.addEventListener('input', hideAllWithdrawalErrors);
        });
    </script>
</body>
</html>
